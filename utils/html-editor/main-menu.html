


<main-menu style='position:relative'>

      <template shadowrootmode=open>
      
            <style>
            
                  #icon {padding:3px;width:20px;background:buttonface}
                  
                  .menu {position:absolute;left:0;top:60px;}
            
            </style>
            
            <img id=icon class=icon src='data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAt1BMVEVHcEwbmPYcgfMchvQbsfkay/wbtvkbnfccefMayfwbmfYch/QchvQbtfkbmfYa1P0ddfIcivQcl/Ycj/Ubp/gcmfYdbPEbrvkazPwcmfYbqfgayfwayPwbv/sbvvobsvkazPwbqvga0fwbvPobtvocjvUbofcbpvccfPMcgPMcgvMdafAdbfEckfUbtvka0PwcfPIaxvsbwfsbvPodb/EcnPYclvYckfUbpvccjPQdd/IbofcbrPiPy8D0AAAAMHRSTlMAA/79/v7+5ycVZ3Y3h0xhu9jp8kFeF9OkVfQOrZi+Mh1z/iUJQ+/dx4fOYq7hybzs5xU1AAABIklEQVQ4y+2Ux3aDMBBFpTR6M92AwYB7S6EG/v+7MsJJnBBKVsnGdwHozT1HQgxC6MrfEkiSM+Y4khSgUxhazLDHWGF4QveAO2gyLnGQ9QS4wcDaXGJYiPGegVnU50UzUvdgTsd7AfrMaEaqXvO+sfAAHP0uzz+SmhCfR7FwB5gdpm+SyoeHEJ5P67o2tbanmRBP5/iSgFkUxaplaisIv3kAu6yqihK/RiIF0ZJtT6NTaZpS9iWwm0D/uXB7kmXZ5LOgN0O7ayvEQ57nKtssCbMqDA5i9+YulLIsVQ5MzKnwqCz6Phev3AIcxhy5K3x/A/DbG2CzIdctP9RS9PrxnTU92KOYll8bZHqs7Wk5AcY9hIx9kuyN3/xuxm5nXA+df+cNJSAgjMbiFSoAAAAASUVORK5CYII='>
            
            <div class=menu style='display:none;width:150px;'>
      
                  <div id=new class=menu-opt>new</div>
                  <div id=fork class=menu-opt>fork</div>
                  <div class=menu-sep></div>
                  <div id=editor class=menu-opt>editor</div>
                  <div id=js-console class=menu-opt>js console</div>
                  <div class=menu-sep></div>
                  <div id=trim class=menu-opt>trim</div>
      
            </div>
            
      </template>



      <script>
        
            (()=>{
            
                  menu.main   = main();
            
                  function main(){
      
                    var obj   = {};
                    
                  
                        obj.initdom=function(){
                        
                              var root                      = document.querySelector('main-menu');
                              var shadow                    = root.shadowRoot;
                              
                              var style                     = $('#page-inline');
                              var rules                     = style.sheet.cssRules;
                              var n                         = rules.length;
                              for(var i=0;i<n;i++){
                              
                                    var rule    = rules[i];
                                    if(rule.selectorText==='.icon'){
                                          var css   = rule.cssText;
                                          break;
                                    }
                                    
                              }//for
                              style   = $(shadow,'style');
                              style.sheet.insertRule(css);
                              
                              menumod.add.style(shadow);
                              
                              
                              var node                      = $(shadow,'.menu');
                              $(shadow,'#icon').onclick     = menumod.click(node,false,false,menu);
            
            
                        }//initdom
                  
      
  //:
        
        
                        function menu(type,opt){
                  
                              if(type=='opt'){
                                    menu[opt.id]();
                              }
                  
                        }//one
            
                  
                        menu.new=function(){
                  
                              var url       = window.location.toString();
                              var search    = window.location.search;
                              if(search){
                                    url     = url.slice(0,-search.length);
                              }
                  
                              var win   = window.open(url);
                              return win;
                  
                        }//new
            
                  
                        menu.fork=function(){
                  
                              var win   = newwin();
                              var txt   = editor.getValue();
                              win.postMessage({txt},'*');
                  
                        }//fork
            
                  
                        menu.editor=function(){
                  
                              window.open('/utils/editor/editor.html');
                  
                        }//editor
            
                  
                        menu['js-console']=function(){
                  
                              window.open('/utils/js-console/js-console.html');
                  
                        }//js-console
      
            
                        menu.trim=function(){
                  
                              var pos     = editor.getCursorPosition();
                              var txt     = editor.getValue();
                              var lines   = txt.split('\n');
                              lines       = lines.map(line=>line.trimEnd());
                              txt         = lines.join('\n');
                              editor.setValue(txt,-1);
                              editor.gotoLine(pos.row,pos.column);
                  
                        }//trim
                        
                        
                    return obj;
                    
                  }//main
                  
            })();

        
      </script>


</main-menu>
        
        
        