


<!DOCTYPE html>


<html>

      <head>
            <meta charset=utf-8>
            
            <title>
                  Deploy Cloud Run Service
            </title>
            
            <base href='https://ext-code.com/utils/gcloud/deploy-cloud-run-service/'>
            <link rel=canonical href='https://ext-code.com/utils/gcloud/deploy-cloud-run-service/deploy-cloud-run-service.html'>
            
            <link rel=icon type='image/png' href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAAtFBMVEVHcEyfrsVHh/FKifBChvQ/fONHgOFGh/BXh9xEhvNMh+dajONLh+1DhvNOietFhvJSiepIh/BQhuJKiO9DhvM/fOJJguVCfd9Ih/BFhvNFh/JHh/FQiupEfd5Hft5CfeFBfOBChvU+fONBgu7///8/feRBhfWfvvE/hPXR4fjt8/xun+/0+P3E2PZFiPVRj/SkxPZPh+VdkOZ5qPOKsvGTtu9GgePe6fhdlvNqmedjleevye+zJ1q4AAAAIXRSTlMAAqdW+vpUjQfaJQk87CnKF3YTT+XlNpBuwbSfHnRAscYJXw9WAAABTElEQVQoz62T2WKCMBBFEbSgKO5btQsBCQkEEHHt//9XyQRI0Jc+9L6Fk8zMTS6a9kd1FL3AyVRXZDptau3clsb7Fp5329g1VTrbPlF3sVLwxn2RbjV00OcfghbuzhtLJl8naRCkidyznVV4OILDuEhOWRo2fCOo/Q6rsKDRjZJT06Q/AGwIU8GNYo/9MFkAzE3G1Sph5FJkR8zqAqNhiad1r/BMHw92z8/XLBVct+vOHEfx+cJiSmOf3IAvHK2zU3BxIX6pGB89GG5f2+KzZTS/xyUlEUIHzqf8scx6NMIO2PcpPiIEfDzhozt92ZrAUSS4Ie5FzB7ia/64iqOgL7tKCjhPTjm6R4eGLj/rNxH35pUFkdS6SZytQ3lPpcuBjENlTuG9DzXElTnJv2dq2EReJO+9tZNsLLogrwdaW0//gTM3QG9cK0v7D/0CM2JIZjtg+k4AAAAASUVORK5CYII='>
            <meta name=viewport content='width=device-width, initial-scale=1'>
            
            <script type='application/ld+json'>
                  {
                        "@context"              : "https://schema.org",
                        "@type"                 : "SoftwareApplication",
                        "name"                  : "Deploy Cloud Run Service",
                        "url"                   : "https://ext-code.com/utils/gcloud/deploy-cloud-run-service/deploy-cloud-run-service.html",
                        "author"                : {"@type":"Person","name":"Matthew Richards"},
                        "description"           : "Deploy a cloud run service.",
                        "applicationCategory"   : "DeveloperApplication",
                        "operatingSystem"       : "All",
                        "browserRequirements"   : "Requires JavaScript-enabled browser",
                        "softwareVersion"       : "1.0.0",
                        "offers"                : {"@type":"Offer","price":"0","priceCurrency":"GBP"}
                  }
            </script>
            
            
            <script src='https://libs.ext-code.com/js/dom/component/v3.0/component.js'></script>
            
            <script init>
                                                                                console.clear();
                                                                                console.log('deploy-cloud-run-service-v2.0.html');
                                                                                console.log();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
        var df=true,version='v1.0'
        ;
        
        
        var ext;
        var $;
        var datatype;
        var menumod;
        var keydown;
        var debug;
        
        var menu;
        
        var hdr;
        var log;
        
        
        
        
  //:
  
  
        async function init(){
                                                                                debug('init',version);
                                                                                
              menu        = menumod();
              
              
              hdr         = mod['gcloud-hdr'];
              log         = mod['log-mod'];
              
              hdr.initmod({ext,$,menu});
              log.initmod({ext,$});
              
              await Promise.all([
                    hdr.init(),
                    log.init(),
              ]);
              
              
              
              initdom(document.body);
              
              
              
        }//init
        
        
(async()=>{

        mod.stack.add;
        
        ({ext}    = await import('https://libs.ext-code.com/js/io/ext-loader/ext-loader.m.js'));
        
        var promise   = ext.load.libs(
              'js/dom/$.js',
              'js/core/datatype.js',
              'js/dom/menumod/menumod.js',
              'js/dom/keydown/keydown.js',
              'js/debug/debug.js',
        );
        [$,datatype,menumod,keydown,debug]   = await promise;
        
        
        //JSZip   = (await import('https://cdn.jsdelivr.net/npm/jszip/+esm')).default;
        
        mod.stack.complete;
        
})();

            </script init>
            
      </head>
      
      
      <body>
      
            <style>
            
  html
    {height:100%}
  body
    {height:calc(100% - 16px);display:flex;flex-direction:column;gap:10px;font-family:arial}
    
    
  .icon
    {border:1px solid gray;border-radius:3px;box-sizing:border-box;width:30px;height:30px;cursor:pointer}
    
  .paste
    {margin-right:5px;padding:2px;
      content:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAVlJREFUSEvtlj1ug0AQhcdIW6RLeiQy6XKElLRIlOlp6LmBlRsgtzTUOQAtcZMzpMpInAGlQSjRWl7LxrM/dlhZUbwtu/PNvH07zAIutBYX4oIzGBG/95MkIuezXHFOh6MoegqC4F0GEELAMAybWL+BG8GI+AwArypjRFTAgyLOSeAIHIbhjRDii5NHgcdxhK7rWHu4JnEEnt6ljK6AUxIRcfAPInq0mVYL/lwSrNa3UL7d2WKA3CvXw8vuKqzeMYKtxMmGK9ik2FVq+XQ2rVE5VSeXMpLNgLp3fZbUrlCVFAc/GaygbdvaioU4jrU9/W+CVUVc6U3TQJIkfio2geVV/C+pi6KAsiz9SN33PaRpyrrbu9R1XbPgLMv83bHJXHmeQ1VVp0tt6w6zN5DtqHMwynJJeAGbqkVEOefc2xTZ/+7Uq10CcgOh7pzz38kFPMce6zQ4B4SL8QNf7+YfCGbtNAAAAABJRU5ErkJggg==);
    }
  .copy
    {margin-left:5px;padding:2px;
      content:url(data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAABSlBMVEVHcEwnz/4C8P4g1P4L6P43wf5Mr/4a2v4Y3P4/uv5PrP4+vf5Auv4ozv5KsP4vyv45wP5Jsf5Auf49vP5Mrv4zxf44wf5Lr/46wP4h1P5Lr/46vv5Jsv4R5P5Hs/5Etv44wf5Hs/41w/4uyv47vv49vP5Ftf5GtP4c2f4rzP4tyv4m0f5Etv5Nrv4xxv4xxv4xx/4W3/5KsP5Mr/4/u/4uyv5Isv4K6f4l0f4qzv4W3/4V3/5Nrv5Mrv5Mrv5Mr/4W3v4e2P5BuP5Hsv4N5v4K6f4O5v42w/5Dt/4E7/4uyf4C8P4nz/4M5/4K6v4oz/4P5f4k0v4b2v5Gs/4E7v4I6/5Nrf4e1/4H7P4E7v5Auv5Dtv4sy/5Isv5GtP4wx/49vP4zxf47vv44wP42w/5LsP5Jsf4i1P4n0P4N5v4k0v4a2v4S4v4X3v6OfcqkAAAAVnRSTlMACo7CjQWN/VczjgIJMfIXJzHtjj5iVekR71Hvtz7CjelXjre2wiJj2PCFIWbR7+fEnXaodz3544/USfOC22Tm7CXOnqfUZ+/3VTV9bsTzqGDahpb2tyRB6bIAAAIDSURBVDjLrZVpV9pAFIYntdFiQkZsLCQECtJSlqAsFRBU3Kuta1sncYGuJEDt///aISkkkyHo6enzLTlP5s5758wNAC526pd3d1++/fzx/evNze1tp210wxURUMTWBz2v2EWtLc7jBTPmoJfNrqy8i0ajixgB00VISJIeW9JMKbcWDAYDNiFMQN1EqAAJcUfSBif0fsQWQjLxpjGnXUJa5CoIbTiP8KJ0OqfNMLQIZhGad/Ke3t///vWwGKv1+yPxfW55+TnmJWZW5ggxcqX3m6WSVTpSdPcxHCLExmf97AI8e1j8cK1f8X9Fq/Sotrf0k2v9KRiJ08L8mwhf2CQx8oK/yJyPw3Q67ULaV4Tr7tRCwFfkllLF4ushccwGPyUMzwzhMQz/X1Kz+QVMmh2LcjgsTxDZ3OpqIpFYfDu+KGwoxE5JvTtpF9NX9BEB792jn0gD4eNEsVAQHyXOO7fQFmNNLZOnPV5BqEyI+Yxm1qkluS0BCWRp8FEze6mTJQtVVd8MUfcEhBSGFOGMOWmaoc0AmRoXP5cmiHEReEXANOopzCsLRYlXjWolGXE2jK/r/ujEWAdOFIxWGrjO8ljXazG6MeynthEn2gAP9P7B4XCE2thzdG2v2jbK5LfHZ3hINbclSco6o/kIh1Einq4e1qxp5m2PkqZ/CPvbXvFot+xe7w/EpaiUrJ24NAAAAABJRU5ErkJggg==);
    }
  .storage
    {margin-right:5px;padding:2px;
      content:url(data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAACZFBMVEVHcEy9TEyD1eZpgIXXxLrhjWPyYyfxn3bljF/5jFrrpnnvNB/8ai/yh1bUmnLiaDbqLSDaiG/tOCL5dDT1ilrgXC4SabrEVkTwYSLqe0nxl3XsNx75cC74dTX7i1X2iVv+lVr3jlz0iFr4h1LtnWv7sHj5ZCPkazfVQirbeEX4UhvtaC7uUSXrQSD3KhbwSSz2Zij1ZyutZ1f2d0P3iFnAHhX6h1L4f0v6eT3zjlzumW3nnGzroHHeMiDYSin4Wx3sbTDkdj73ZST3QhrlJx32Sxr0OR3seDzvfj7zfz70OBv1aSzoYyfTSTb0Ziv3h1j2iVnxYCnyVSbtUC3wOSDlNiH2cTrWKSDWKyP3gEX6k2H0hlP1mWfypHXPq4vPo4D1soPZqIjis5LVrI3+Xxv/ejT/civ+Qxf/dzH+JBb+Nhb+byz+LRb/bSj/fTX/URb+aSX+YyH+WRf/ZSH+HBX/PxX/SBX/dTCsEhT/aya7EhP+Shb/NBb9fULoJhj/ZyX+JhT9cjP8YR/tKBv+fjj+g03+UBb/jVn/iFT+kl/+dzrmGxfrKxzuMBzIHBX8Sx76VCzUFxbEFBL+nGj/cSr8XB79Lxz8VyjZLhf7UR/9Yyj+hUX+gEP/l2PyaCr8OhnEIxf6XSbaGha7GBT3RCXhVif3ThnoQxn9Zie1EhL4IxrjJhj7YDDQJxbvPBv7Vhv9hVH/om7AIBX+Uxz0RB/dPhzzOiP2IRfsYiz2MR3zJh7RTSjjSx/lUx/LExXuOxz/jU7+iUn8PCnEKB3IOST4cS/jNBP6SBa9IRLWJxXTJhD2HBcZjAsKAAAAZHRSTlMACQICAyWlLzTrqMH+Tzg0pgrB5Ik+AQumHBrC89n2e/5oj+q1lPU9GhjzgZCQ+6XOqwW0v7/d5e1BdaSBSSf2kEPp5nrw2Xahv9iscRWgqtS/mb+4s47CwNGUYtzWEVqLW0Yax/uzPQAAArxJREFUOMvdlGdXGlEQhjfiGqIgarCLvbcYNfb03nvviRRFdLFEXFySRWx0UASxd7BrNDGxpdc/lbuQE3fB/AHfz8+ZufOcuQNBOzX+YXRmTBQ7NpYdFcOkh/pvT4Ux2bl5exyJi4vLzy/g5NxihrpjUVci21rb24vg3c4U5mFKnJGV5oLCufMA6+voKIGeeRMpjo/82MvFG8RZLAoY2+zgFha8PZ/7gtDpRdEfehRK4Uu5lyeJ87zsBDsWHj5++iQhIcEXigEgVg/Aq+SZPHIw0Lq1PbrvAfyoJD6+mA7dA50BJx66votc8TwDawaZb4tkM+kwDBfev6vEhUiN1WYOoID7SxEc68UwTKlUFnA4eyOEiM06ZNbr56Q+LqAYEQoUPT29QAouZFin9bpPXV3ldS1U0OMSAEWd9dxK8C5EXDqn45dXlNW+auS3SG+QQSi9ugYR8QAo6GyoKa2uelHnAMv5Vd/9aOSKfpnjNifIc4DSur8VJ34doLTe91ZlWVv5ylVweaJ/FX/Lfv6wG+9QQK/udyqD9vOX1dWxsfX1tYlly4x2RCKRoDOzAVRQbjWPalSGDSNqlzhjR42GqdluaTgVJPQIGdP60TcatVotkzU1Nb2frBgAU4cHu4IinqBSwcVFNrnptY4/0FVWW0boobSGrpnECHnqLT3Sm9kUPQOm7cBG/vg3Vz2yiSEh0ZoMTmosWuNt8htphJ5hy/LYSn9/v9w0N740q5ka3kDt6Mwm5Y20ELnYPKpWDRu02sHBwcXFkREUJfRsdlOXghZC6MGBniVCj2yK8AP0EMO4g+56HNtDEQ5dkIvJ29OypUeXEUQGg9OOba8nNf0i9WPTWEc4EYJK6j5mnssIzHa/KSlHT585C75LYuLh1JPHT/n4nTiYHPSfKxXknwKzkpICA1mHkoNpO/YYQ38AABZHleIztVMAAAAASUVORK5CYII=);
    }
    
  section
    {margin-bottom:10px;display:flex;gap:10px;align-items:center}
  section label
    {width:200px;display:inline-block;text-align:right;margin-right:20px}
  section .hldr
    {flex:1;display:flex;align-items:center}
  section .hldr input
    {flex:1}
    
  #output
    {flex:1;padding:10px;border:1px solid lightgray;overflow:auto;min-height:0}
    
    
    
  input
    {font-size:16px;padding:5px 10px}
  input[type=button]
    {cursor:pointer}
    
  .visually-hidden
    {position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;
      clip:rect(0 0 0 0) !important;white-space:nowrap !important;border:0 !important}
      
      
            </style>
            
            
            <gcloud-hdr component=grp>
                  <h1 class=visually-hidden>
                        Download Github Directory
                  </h1>
                  <img class=title src='images/deploy-cloud-run-service.png' style='top:-15px;height:80px' alt='deploy cloud run service'>
                  <time slot=date datetime=2025-10-31>
                        31 Oct 2025
                  </time>
            </gcloud-hdr>
            
            
            <div>
            
                  <section id=token-root>
                  
                        <label>
                              token
                        </label>
                        
                        <div class=hldr>
                            <img class='paste icon'>
                            <img class='storage icon'>
                            <input id=token autocomplete=off spellcheck=false>
                            <img class='copy icon'>
                        </div>
                        
                  </section>
                  
                  
                  <section id=email-root>
                  
                        <label>
                              service account email
                        </label>
                        
                        <div class=hldr>
                            <img class='paste icon'>
                            <img class='storage icon'>
                            <input id=email autocomplete=off spellcheck=false>
                            <img class='copy icon'>
                        </div>
                        
                  </section>
                  
                  
                  <section id=bucket-root>
                  
                        <label>
                              bucket name
                        </label>
                        
                        <div class=hldr>
                            <img class='paste icon'>
                            <input id=bucket autocomplete=off spellcheck=false>
                            <img class='copy icon'>
                        </div>
                        
                  </section>
                  
                  
                  <section id=zip-root>
                  
                        <label>
                              zip path
                        </label>
                        
                        <div class=hldr>
                            <img class='paste icon'>
                            <img class='storage icon'>
                            <input id=zip autocomplete=off spellcheck=false>
                            <img class='copy icon'>
                        </div>
                        
                  </section>
                  
                  
                  <section id=project-root>
                  
                        <label>
                              project
                        </label>
                        
                        <div class=hldr>
                            <img class='paste icon'>
                            <img class='storage icon'>
                            <input id=project autocomplete=off spellcheck=false>
                            <img class='copy icon'>
                        </div>
                        
                  </section>
                  
                  
                  <section id=service-root>
                  
                        <label>
                              service
                        </label>
                        
                        <div class=hldr>
                            <img class='paste icon'>
                            <img class='storage icon'>
                            <input id=service autocomplete=off spellcheck=false>
                            <img class='copy icon'>
                        </div>
                        
                  </section>
                  
                  
                  <section id=region-root>
                  
                        <label>
                              region
                        </label>
                        
                        <div class=hldr>
                            <img class='paste icon'>
                            <img class='storage icon'>
                            <input id=region autocomplete=off spellcheck=false>
                            <img class='copy icon'>
                        </div>
                        
                  </section>
                  
                  
                  <section>
                  
                        <input value=deploy type=button>
                        
                  </section>
                  
                  
            </div>
            
            
            
            <pre id=output>
            </pre>
            
            
            <log-mod component></log-mod>
            
            
      </body>
      
      
      <script>
      
      
        var ui    = {};
        
        
        
        
        var btn   = {};
        
        
  //:
  
  
        function initdom(rootnode){
        
        
              var root                                = rootnode;
              ui.root                                 = root;
              
              hdr.initdom();
              
              ui.token                                = $(root,'#token');
              ui.email                                = $(root,'#email');
              ui.bucket                               = $(root,'#bucket');
              ui.zip                                  = $(root,'#zip');
              ui.project                              = $(root,'#project');
              ui.service                              = $(root,'#service');
              ui.region                               = $(root,'#region');
              
              
              
              $(root,'[value=deploy]').onclick        = btn.deploy;
              
              
              
              
              $.all(root,'.paste').forEach(icon=>{
              
                    var root        = icon.parentNode.parentNode
                    var input       = $(root,'input:not([type])');
                    icon.onclick    = async e=>{
                    
                                            var txt       = await navigator.clipboard.readText();
                                            input.value   = txt;
                                            input.focus();
                                            
                                      }//icon.onclick
                                      
              });//foreach
              
              
              $.all(root,'.copy').forEach(icon=>{
              
                    var root        = icon.parentNode.parentNode;
                    var input       = $(root,'input:not([type])');
                    icon.onclick    = async e=>{
                    
                                            var txt   = input.value;
                                            await navigator.clipboard.writeText(txt);
                                            input.focus();
                                            
                                      }//icon.onclick
                                      
              });//foreach
              
              
/*

              $.all(root,'.storage').forEach(icon=>{
              
                    var root    = icon.parentNode.parentNode;
                    var key     = root.id.slice(0,-5);
                    var input   = $(root,'input:not([type])');
                    var name    = localstorage+key;
                                                                                console.log(key,localStorage[name]);
                    var token;
                    
                    icon.onclick    = e=>{
                    
                                            if(e.shiftKey){
                                                  token   = localStorage[name];
                                                  if(!token){
                                                        $.mousetext(`no stored ${key}, localStorage[${name}]`);
                                                        return;
                                                  }
                                                  input.value   = token;
                                                  return;
                                            }
                                            
                                            token   = input.value;
                                            if(!token){
                                                  $.mousetext(`${key} empty`);
                                                  return;
                                            }
                                            localStorage[name]    = token;
                                            $.mousetext(`localStorage[${name}] saved`);
                                            
                                      }//icon.onclick
                                      
                    icon.title    = `${key} : click - store, shift - read`;
                    
              });//foreach
              
*/



              ui.output   = $(root,'#output');
              
              
              
              log.initdom();
              
              
              
              
        }//initdom
        
        
  //:
  
  
        btn.deploy    = async function(){
        
              var token     = ui.token.value;
              var email     = ui.email.value;
              var bucket    = ui.bucket.value;
              var zip       = ui.zip.value;
              var project   = ui.project.value;
              var service   = ui.service.value;
              var region    = ui.region.value;
              
              var params    = {token,email,bucket,zip,project,service,region};
              
              var {result,monitor,build,logurl}   = await gs.deploy(params);
              
              output('build_id',build);
              output('logurl',logurl);
              
              var a             = document.createElement('a');
              a.href            = logurl;
              a.textContent     = logurl;
              a.style.display   = 'block';
              ui.output.append(a);
              
              output.json(result);
              
              monitor(output);
              
        }//deploy
        
        
  //:
  
  
        output.clear    = function(){
        
              ui.output.textContent   = '';
              
        }//clear
        
        
        function output(){
        
              var str   = [...arguments].join(' ');
              
              var div   = document.createElement('div');
              div.textContent   = str;
              ui.output.append(div);
              
              ui.output.scrollTop     = Number.MAX_SAFE_INTEGER;
              
        }//output
        
        
        output.json   = function(v){
        
              var str   = JSON.stringify(v,null,4);
              output(str);
              
        }//json
        
        
        
        
        
      </script>
      
      
</html>



