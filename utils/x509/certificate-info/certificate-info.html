


<html>

    <head>

        <title>certificate info</title>
        
        <base href='https://javascript-2020.github.io/utils/x509/certificate-info/certificate-info.html'>
        <link rel='shortcut icon' type='image/x-icon' href='images/favicon.ico'>

        <style>
        
    html
                          {height:100%}
    body
                          {height:calc(100% - 42px);margin:20px;display:flex;flex-direction:column;font-family:arial}
    .hdr                  
                          {font-family:arial;position:relative;margin-top:0;margin-bottom:20px;background:white;
                            padding-bottom:10px;border-bottom:3px solid lightblue}
    .hdr-icon             
                          {display:inline-block;text-align:center;background:whitesmoke;border-radius:5px;
                            border:1px solid lightgray;padding:5px 3px 0px;cursor:pointer;margin-right:10px;
                            min-width:50px}
    .hdr-icon-img         
                          {width:25px;height:25px}
    .hdr-icon-label       
                          {margin:2px 0 0}
    .hdr-title            
                          {position:absolute;left:0;right:0;z-index:0;margin:0 auto}
    .hdr-date
                          {float:right}

    input
                          {padding:5px 10px;font-size:16px}
             
    #filename
                          {margin-bottom:20px}
    #view
                          {margin-bottom:20px}
    .category
                          {margin-top:20px}
    .field
                          {display:flex;margin-top:10px}
    .field-name
                          {display:inline-block;width:200px}
    .field-value
                          {flex:1}
    
    #pem-root
                          {display:none}
    #pem
                          {border:1px solid lightgray;padding:10px}
                          
        </style>
        
    </head>

    <body>
   
   
        <div class=hdr>
            <a class=hdr-icon href='https://javascript-2020.github.io/'>
                <img class=hdr-icon-img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAAqFBMVEVHcEwjmpckopg9f3YxpJM6r5kjq58Nmp0Nn6QRoKExrpshnpgtoJUdoZwYnZ02spwYpaEmrZ8djpINn6Qtrp4inpcjqZ8SoqM3s5w0sp01spwrr58vr50oqpwdnpo0sZwtrJwUpKMMoaUtq50op5ssqpopppseqaM1sJwgpJ0NoaUSoaI3kYobqaMSpKQrr58PoaMVpaIOoKMLpKcXpaEkqp8Rm58YrKUL0CR4AAAAOHRSTlMACBkBCyinK59CQhUOLyKjqbUGpZgSYn6rp5WsekcmgkyWmCkmNB7AYTiuVgKuuo91i2PLn2lJ7kISMf4AAAElSURBVCjPrdPXloIwEAbgBDFKCRo6SO8lYEHd93+zxV7Zm2WuSL6Tk/MPEwBGLFH8SzFCeFiDXNeJ+7GtGds1D+ghDzzPzXX6xlJbq75s5KVLiJsSB76xIhd22Mz0pkyRnqzW2htD/SeUjL0EQKY60nqRvTLXGl64PR/SfDVxVvETZ123w8vN9Ur5YKUF4R9cd/WxqiePgCs3IMF1QXcVt6vK59tSqyjN4hwQbhS8mUuvWTLbwYtTQGhEjLHVPprv+4ztQ8AeRVn50uipBcXg/IPgfPaFF+z1axyeMEkcJwwdYHHZINQ02gALS49lJcQMci/COGzdue8apRQwNz4tYvM207JSRVEUhvtW6KeBIFVVbds07xPncZfCfWSK+UtNJ/9+VL/nTBuX7xjDZwAAAABJRU5ErkJggg==' />
                <div class=icon-label>
                    home
                </div>
            </a>
            <a id=github class=hdr-icon href='https://github.com/javascript-2020/javascript-2020.github.io/tree/main/utils/x509/generate-certificate-chain/generate-certificate-chain.html'>
                <img class=hdr-icon-img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAbFJREFUOE/l1E2IT2EUx/HPIFI2lJfGwmYsxFZKEUWjKWM3pZSpKcqeBcpLZsNeUeNlZWdBSVFmkAXbmRWbWRCRjYW8jv+pc/V4utff3q3bvfc5z/k+557zO2dA97UHy7ERx3LbZbzEZzxscx3o4L3GWizusP/AO6yv7TXwAo5g9V8iL03vcRWnm8USeBHH/xFUb7uEE7HYAOMZeVmGm7iN61jVccBHjOMQxvAl870QoIDMZ87CfxR3E7QDTyroTjzOtf24k++R0w0BHMY9LEpDCeyXgRL4EyMBjEKcSs+o3r4uSbTQQ1r3CzVMBnCh2PimTQp9wgyJDZZV/g+Bz7E1c/AdezHdr7xp34UHvcIuye8XUZSy9A1nDT5UBSvPCL9oz9BeeY2GYR3msBIHsi834WlPTt9yrXQKIUdEIfoVhSG6Z3PTejdwGG+xDc9SPud7UZ6popjEyZaURMuOl8NhKvtzpKf4yGvMwk95l/5xwNkKeA0T5XCI96EcRbsLh5mWAtXARznyXtXA5tD4/YNYmuBzVTQN8Ctu5V/93tI1sbdjS463KxXwaFZ/NnP9h/kXPcNYElddRc0AAAAASUVORK5CYII='>
                <div class=hdr-icon-label>
                      github
                </div>
            </a>
            
            <img class=hdr-title src='images/certificate-info.png' style='height:60px;top:-15px'>
            
            <div class=hdr-date>
                  26 Mar 2025
            </div>
        </div hdr>


        <div id=btns>
              <input value=load type=button>
        </div>
        
        <div id=filename></div>
        
        <div id=view>
        
              <div class=category>
                    <div class=label></div>
              </div category>
              
              <div class=field>
                    <span class=field-name>commonName</span>
                    <span class=field-value></span>
              </div>
              
        </div>
        
        <div id=pem-root>
              <div id=btns2>
                    <input value=copy type=button>
              </div>
              <pre id=pem></pre>
        </div>
        
    </body>
    
<script>
                                                                                console.clear();
                                                                                console.log('certificate-info');
                                                                                console.log();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
                                                                                
        var ext;
        var $,datatype,menumod,keydown;
        
        var nodeforge;

        var file;
        var cert;
        var pem;

        var view;
        
        
        
        var props         = {};
        props.issuer      = [ 'commonName','OrganizationalUnit','Organization','Locality',
                              'StateOrProvinceName','CountryName'
                            ];
        props.subject     = [ 'commonName','OrganizationalUnit','Organization','Locality',
                              'StateOrProvinceName','CountryName'
                            ];
        
        props.ext         = {};                  
        props.ext.keyUsage      = ['keyCertSign','digitalSignature','nonRepudiation','keyEncipherment','dataEncipherment'];
        props.ext.extKeyUsage   = ['serverAuth','clientAuth','codeSigning','emailProtection','timeStamping'];
        props.ext.nsCertType    = ['client','server','email','objSign','sslCA','emailCA','objCA'];


        var history   = {};
        var btn       = {};
        

  //
  
  
        //window.onload   = init;
        setTimeout(init,50);
        
        async function init(){
          
          
              //history.delete();
              
              
              await load();
              
              
              initdom();              
              

              
        }//init


        function initdom(){
          
          
              var btns                              = $('#btns');
              
              $('[value=load]').onclick             = btn.load;
              $('[value=copy]').onclick             = btn.copy;
              
              view                                  = $('#view');
              
              category                              = $('.category');
              category.remove();
              
              field                                 = $('.field');
              field.remove();
              
              
              if(history.load()){
                    display();
              }
                          
              
        }//initdom


        btn.load    = async function(){
          
              await load.cert(true);
              display();
              
        }//load
        
        
        btn.copy    = async function(){
          
              await navigator.clipboard.writeText(pem);
                                                                                console.log('copied');
        }//copy
        
        
        function display(){
          

              
              //console.log(nodeforge.pki);
              //console.json(cert);
              
              
              
              $('#filename').textContent    = file;

              

              view.replaceChildren();
              
              
              var extensions    = cert.extensions;

          
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'version';
              $(nfield,'.field-value').textContent    = cert.version;
              view.append(nfield);

              
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'serialNumber';
              $(nfield,'.field-value').textContent    = cert.serialNumber;
              view.append(nfield);

              
              var ca    = extensions.find(ext=>('cA' in ext));
              var nfield    = field.cloneNode(true);
              nfield.style.cssText    = 'margin-top:20px';
              $(nfield,'.field-name').textContent   = 'CA';
              $(nfield,'.field-value').textContent    = ca.cA;
              view.append(nfield);
              
              
              var nfield    = field.cloneNode(true);
              nfield.style.cssText    = 'margin-top:20px';
              $(nfield,'.field-name').textContent   = 'not before';
              $(nfield,'.field-value').textContent    = cert.validity.notBefore;
              view.append(nfield);

              
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'not after';
              $(nfield,'.field-value').textContent    = cert.validity.notAfter;
              view.append(nfield);
              

              var ncategory   = category.cloneNode(true);
              $(ncategory,'.label').textContent   = 'Subject';
              
              props.subject.forEach(name=>{
                
                    var attr    = cert.subject.attributes.find(attr=>attr.name===name);
                    if(!attr){
                          return;
                    }
                    
                    var nfield    = field.cloneNode(true);
                    $(nfield,'.field-name').textContent   = name;
                    $(nfield,'.field-name').style.cssText    = 'padding-left:20px;box-sizing:border-box';
                    $(nfield,'.field-value').textContent    = attr.value;
                    ncategory.append(nfield);
                    
              });
              view.append(ncategory);
              
              
              var ncategory   = category.cloneNode(true);
              $(ncategory,'.label').textContent   = 'Issuer';
              props.issuer.forEach(name=>{
                
                    var attr    = cert.issuer.attributes.find(attr=>attr.name===name);
                    if(!attr){
                          return;
                    }
                    
                    var nfield    = field.cloneNode(true);
                    $(nfield,'.field-name').textContent   = name;
                    $(nfield,'.field-name').style.cssText    = 'padding-left:20px;box-sizing:border-box';
                    $(nfield,'.field-value').textContent    = attr.value;
                    ncategory.append(nfield);
                    
              });
              view.append(ncategory);
              
              
              var nfield    = field.cloneNode(true);
              nfield.style.cssText    = 'margin-top:20px';
              $(nfield,'.field-name').textContent   = 'subjectAltName';
              var attr    = extensions.find(attr=>attr.name==='subjectAltName');
              var str     = []
              attr.altNames.forEach(attr=>{
                
                    switch(attr.type){
                      
                      case 2    : str.push(attr.value);       break;
                      case 7    : str.push(attr.ip);          break;
                        
                    }//switch
                    
              });
              str   = str.join(', ');
              $(nfield,'.field-value').textContent    = str;
              view.append(nfield);
              
              var ext   = props.ext;
              for(var key in ext){
                
                    var attr    = extensions.find(attr=>attr.name===key);
                    
                    var nfield    = field.cloneNode(true);
                    nfield.style.cssText    = 'margin-top:20px';
                    $(nfield,'.field-name').textContent   = key;
                    
                    var str   = [];
                    var list    = ext[key];
                    list.forEach(name=>{

                          if(attr[name]){                      
                                str.push(name);
                                
                          }
                          
                    });
                    
                    str   = str.join(', ');
                    $(nfield,'.field-value').textContent    = str;
                    
                    view.append(nfield);
                    
              }//for
                    

              /*
              
              var b64   = window.btoa(cert.signature);
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'signature';
              $(nfield,'.field-value').textContent    = b64;
              $(nfield,'.field-value').style.flexWrap   = 'wrap';
              view.append(nfield);              
              
              */

              
              $('#pem-root').style.display    = 'block';
              
              pem   = nodeforge.pki.certificateToPem(cert);
              $('#pem').textContent    = pem;
              
        }//display






        async function load(){

              await Promise.all([load.ext(),load.nodeforge()]);
              
        }//load
        
        
        load.ext    = async function(){
          
              var res   = await fetch('https://raw.githubusercontent.com/javascript-2020/ext-code/main/ext-loader.js')
              var txt   = await res.text();
              ext   = eval(txt);
              [$,datatype,menumod,keydown]   = await ext.load.libs(
                    'js/dom/$.js',
                    'js/core/datatype.js',
                    'js/dom/menumod/menumod.js',
                    'js/dom/keydown/keydown.js'
              );
              
        }//ext
        
        
        load.nodeforge    = async function(){
          
              var txt         = localStorage['node-forge'];
              if(!txt){
                    var url   = 'https://cdn.jsdelivr.net/npm/node-forge/+esm';
                                                                                //console.log(url);
                    var res   = await fetch(url);
                    txt       = await res.text();
                    localStorage['node-forge']    = txt;
              }
              
              var blob        = new Blob([txt],{type:'text/javascript'});
              var url         = window.URL.createObjectURL(blob);
              nodeforge       = await import(url);
              nodeforge       = nodeforge.default;
              //pki             = nodeforge.pki;
              
        }//nodeforge

                
        load.cert   = function(import_cert){
        
              var resolve,promise=new Promise(res=>resolve=res);
              
              var input         = document.createElement('input');
              input.type        = 'file';
              input.onchange    = onchange;
              input.click();
              
              return promise;
              
              
              async function onchange(){
              
                    file    = input.files[0].name;
                    pem     = await input.files[0].text();
                    cert    = nodeforge.pki.certificateFromPem(pem);
                    history.save();
                    resolve();
                    
              }//onchange
              
        }//cert
        

  //:
  
  
        history.delete    = function(){
          
              delete localStorage['verify-certificate'];
              
        }//delete
        
        
        history.load    = function(){
          
              var txt   = localStorage['verify-certificate'];
              if(!txt){
                    return;
              }
              var json      = JSON.parse(txt);
              ({file,pem}   = json);
              cert          = nodeforge.pki.certificateFromPem(pem);
              return true;
              
        }//load
        
        
        history.save    = function(){
          
              var txt   = JSON.stringify({file,pem});
              localStorage['verify-certificate']    = txt;
              
        }//save
        

</script>

</html>







        
    