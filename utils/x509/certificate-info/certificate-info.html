


<html>

      <head>

            <title>x509 certificate info</title>
            <meta name=description content='view x509 certificate information'>
            
            <base href='https://javascript-2020.github.io/utils/x509/certificate-info/certificate-info.html'>
            <link rel=canonical href='https://ext-code.com/utils/x509/certificate-info/certificate-info.html'>
            
            <meta name=viewport content='width=device-width, initial-scale=1'>
            <link rel='shortcut icon' type='image/x-icon' href='utils/x509/images/x509-30.png'>
    
    
            <style>
        
  html
    {height:100%}
    
  body
    {height:calc(100% - 42px);margin:20px;display:flex;flex-direction:column;font-family:arial}

  html
    {--col1:200px}
    
  .hdr                  
    {font-family:arial;position:relative;margin-top:0;margin-bottom:20px;background:white;
      padding-bottom:10px;border-bottom:3px solid lightblue
    }
    
  .hdr-icon             
    {display:inline-block;text-align:center;background:whitesmoke;border-radius:5px;
      border:1px solid lightgray;padding:5px 3px 0px;cursor:pointer;margin-right:10px;
      min-width:50px
    }
    
  .hdr-icon-img         
    {width:25px;height:25px}
    
  .hdr-icon-label       
    {margin:2px 0 0}
    
  .hdr-title            
    {position:absolute;left:0;right:0;z-index:0;margin:0 auto}
    
  .hdr-date
    {float:right}


    
  #btns
    {margin-bottom:20px}


  #info
    {display:flex;flex-direction:column;gap:20px}
    
  #filename
    {border:1px solid lightgray;padding:10px 10px;border-radius:5px;text-align:center;font-weight:bold;background:lightyellow}
    

  #dn-root
    {display:flex;gap:50px}
    
  #subject
    {border-color:lightblue}
  #subject .dn-title
    {background:blue}
  #subject .dn-field:nth-child(even)
    {background:hsl(200,100%,98%)}
    
  #issuer
    {border=color:lightgreen}
  #issuer .dn-title
    {background:green}
  #issuer .dn-field:nth-child(even)
    {background:hsl(120,100%,98%)}
    
  .dn
    {flex:1;border:1px solid lightgray;border-radius:5px;padding:10px}
    
  .dn-title
    {font-weight:bold;color:white;text-align:center;padding:5px 10px;margin-bottom:10px}
    
  .dn-view
    {}
    
  .dn-field
    {display:flex;gap:40px;padding:10px 10px}

  .dn-field:nth-child(even)
    {background:whitesmoke}


  .dn-field-name
    {width:200px;text-align:right}
    
  .dn-field-value
    {flex:1;font-weight:bold}


  .category
    {}
  .category-title
    {background:lightgray;text-align:center;margin-bottom:10px;padding:5px}
  .category-view
    {}
  .category-field
    {display:flex;gap:40px;padding:10px}
  .category-field-name
    {width:var(--col1)}
  .category-field-value
    {flex:1;font-weight:bold}
    

  #thumbprint
    {}
  #thumbprint-title
    {}
  #thumbprint-view
    {}
  .thumbprint-field
    {}
  .thumbprint-field-name
    {}
  .thumbprint-field-value
    {}


  #dates
    {}
  #dates-title
    {}  
  .date-root
    {}
  .date-label
    {}
  .date-simple
    {}
  .date-full
    {}    
  #dates-valid
    {}





  #signature
    {}
  #signature-field
    {}
  #signature-field-name
    {}
  #signature-field-value
    {}
    
    
  #view
    {margin-bottom:20px}


  .view-category
    {margin-top:20px}
    
  .view-field
    {display:flex;margin-top:10px}
    
  .view-field-name
    {display:inline-block;width:200px}
    
  .view-field-value
    {flex:1}


    
  #pem
    {border:1px solid lightgray;padding:10px;display:none}
                          


  input
    {padding:5px 10px;font-size:16px}

                          
            </style>
        
      </head>
  
      <body>
   
   
            <div class=hdr>
            
                  <a class=hdr-icon href='/'>
                        <img class=hdr-icon-img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAAqFBMVEVHcEwjmpckopg9f3YxpJM6r5kjq58Nmp0Nn6QRoKExrpshnpgtoJUdoZwYnZ02spwYpaEmrZ8djpINn6Qtrp4inpcjqZ8SoqM3s5w0sp01spwrr58vr50oqpwdnpo0sZwtrJwUpKMMoaUtq50op5ssqpopppseqaM1sJwgpJ0NoaUSoaI3kYobqaMSpKQrr58PoaMVpaIOoKMLpKcXpaEkqp8Rm58YrKUL0CR4AAAAOHRSTlMACBkBCyinK59CQhUOLyKjqbUGpZgSYn6rp5WsekcmgkyWmCkmNB7AYTiuVgKuuo91i2PLn2lJ7kISMf4AAAElSURBVCjPrdPXloIwEAbgBDFKCRo6SO8lYEHd93+zxV7Zm2WuSL6Tk/MPEwBGLFH8SzFCeFiDXNeJ+7GtGds1D+ghDzzPzXX6xlJbq75s5KVLiJsSB76xIhd22Mz0pkyRnqzW2htD/SeUjL0EQKY60nqRvTLXGl64PR/SfDVxVvETZ123w8vN9Ur5YKUF4R9cd/WxqiePgCs3IMF1QXcVt6vK59tSqyjN4hwQbhS8mUuvWTLbwYtTQGhEjLHVPprv+4ztQ8AeRVn50uipBcXg/IPgfPaFF+z1axyeMEkcJwwdYHHZINQ02gALS49lJcQMci/COGzdue8apRQwNz4tYvM207JSRVEUhvtW6KeBIFVVbds07xPncZfCfWSK+UtNJ/9+VL/nTBuX7xjDZwAAAABJRU5ErkJggg==' />
                        <div class=icon-label>
                              home
                        </div>
                  </a>
                  
                  <a id=github class=hdr-icon href='/#x509'>
                        <img class=hdr-icon-img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAABO1BMVEVHcEwAAABoQBqkcBqSXBGfaBGIUw52Sh6pchRxRBeveR2qbg+5p5FuQQ2baRFySB19SQyaaRjJtJFaMwt8Sg5mOxGZaBhxRh2TZhK4hiqucwrDkzy5hSyBWCqCVSX////8/f3s8PPf08X+/v/DomfLu53Nqmrdz7b79ujz9Pbn5+fx6NmhoaHHuKbNvaXu7u7Q0dH48uLd3d3069ysknLhzq+YmJjt0qHcyrD+y1r+vVDY2NjHxcPi4+Oxl3W+q5DFsJO1lmWmiWXAonG4nHHNzc3V1dWxsbH/2GT4r0u/v7/Wxa779uvr28Du5tmtj2W/nGLy47D733T7+O/8+/j48M6srKzo1LC3t7f43YTWx7PKpWLVuITe0bv51Wjo0K3syJ3ruXP4ymbhxpLzv2f37tjIrHqeflrQwKXcKNlbAAAAH3RSTlMAAaOYaW1hjXV+jV3+bh+YV6L+GGMipJUPm0Xe4+Lf7dZ8OwAAAWZJREFUKM+901lXgkAYgGErNcXSzKW9ocZSkATBrRB3zT0XJNdsr///CxplUczbei84nHnOB8MBDIb/aQO1ZvnQsjXP6fU6nfMzDLPYNT72ha5W+8Q0tu0n876VWqeYXeP8uDHx65uMLQv2D0fXK41OjuR5WyZf8zXq4XBAV/3NNGdjpvDd4gSeFQiw3KN8eWO6EGo1BbLK8DhahQQrymzSOMsRVJIVaJpMMlKfJugSS0x1XGXJ+z4Vi1ExSpLQgYnKbE6nQtkgJEmSF5hSVSoV+WKyyBA6BmB2YwBJWt1a1CjzTuTmIaisQRys8J7MuBoAYrgXgCCxxE14oUSAbrvTGfRUdiPONRfTsP1ULpcH3YRZno7kEC+mxfgt6vVDYZfjXDeNx+9Q7+GhW3ln1tSXPE3A2Za5l0qlEsdruwp7HGdNAFHKI3HT54YINEbzmctfpRbssW6jDhybS1ld679mtb/+c34AUBhYzLcT6lgAAAAASUVORK5CYII='>
                        <div class=hdr-icon-label>
                              x509
                        </div>
                  </a>
                  
                  <img class=hdr-title src='images/certificate-info.png' style='height:60px;top:-15px'>
                  
                  <div class=hdr-date>
                        27 Sep 2025
                  </div>
                
            </div hdr>


            <div id=btns>
                  <input value=load type=button>
                  <input value=paste type=button>
                  <input value=copy type=button>
            </div>

        
            <div id=info>
            
                  <div id=filename></div>
      
              
                  <div id=dn-root>
                  
                        <div id=subject class=dn>
                        
                              <div class=dn-title>
                                    Subject
                              </div>
                              
                              <div class=dn-view>
                                    <div class=dn-field>
                                          <div class=dn-field-name></div>
                                          <div class=dn-field-value></div>
                                    </div>
                              </div>
                              
                        </div>
            
            
                        <div id=issuer class=dn>
                        
                              <div class=dn-title>
                                    Issuer
                              </div>
                              
                              <div class=dn-view>
                              </div>
                              
                        </div>
                        
                  </div>
              
              
                  <div id=thumbprint class=category>
                  
                        <div id=thumbprint-title class=category-title>
                              thumbprint
                        </div>
                        <div id=thumbprint-view class=category-view>
                              <div class='thumbprint-field category-field'>
                                    <div class='thumbprint-field-name category-field-name'></div>
                                    <div class='thumbprint-field-value category-field-value'></div>
                              </div>
                        </div>
                        
                  </div>
      
      
                  <div id=dates class=category>
                  
                        <div id=dates-title class=category-title>
                              dates
                        </div>
                        
                        <div id=dates-view>
                              <div id=dates-list>
                                    <div class=date-root>
                                          <div class='date-label category-name'>
                                                not before
                                          </div>
                                          <div class=date-simple>
                                          </div>
                                          <div class=date-full>
                                          </div>
                                    </div>
                              </div>
                              
                              <div id=dates-valid>
                              </div>
                        </div>
                        
                  </div>
      
                  
                  <div id=view>
                  
                        <div class=view-category>
                              <div class=view-label></div>
                        </div category>
                        
                        <div class=view-field>
                              <span class=view-field-name>commonName</span>
                              <span class=view-field-value></span>
                        </div>
                        
                  </div view>
                  
      
      
                  <div>
                        <pre id=pem></pre>
                  </div>
                  
            </div>

        
      </body>
    
      <script>
                                                                                console.clear();
                                                                                console.log('certificate-info');
                                                                                console.log();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
                                                                                
        var ext;
        var $,datatype,menumod,keydown;
        
        var mod   = {};
        
        var nodeforge;

        var store   = 'certificate-info';
        
        var file;
        var cert;
        var pem;

        var view;
        
        
        
        var props         = {};
        props.issuer      = [ 'commonName','OrganizationalUnit','Organization','Locality',
                              'StateOrProvinceName','CountryName'
                            ];
        props.subject     = [ 'commonName','OrganizationalUnit','Organization','Locality',
                              'StateOrProvinceName','CountryName'
                            ];
        
        props.ext         = {};                  
        props.ext.keyUsage      = ['keyCertSign','digitalSignature','nonRepudiation','keyEncipherment','dataEncipherment'];
        props.ext.extKeyUsage   = ['serverAuth','clientAuth','codeSigning','emailProtection','timeStamping'];
        props.ext.nsCertType    = ['client','server','email','objSign','sslCA','emailCA','objCA'];


        var history   = {};
        var btn       = {};
        

  //:
  
  
        //window.onload   = init;
        setTimeout(init,50);
        
        async function init(){
          
          
              //history.delete();
              
              
              await load();
              
              
              initdom();              
              

              
        }//init


  //:
  
  
        var subject         = {};
        var issuer          = {};
        var dn              = {};
        var thumbprint      = {};
        var dates           = {};
        dates.notbefore     = {};
        dates.notafter      = {};
        
        
        
        var view            = {};
        
        
        
        var create    = {};
        
        
        
        function initdom(){
          
          
              var btns                              = $('#btns');
              
              $('[value=load]').onclick             = btn.load;
              $('[value=paste]').onclick            = btn.paste;
              $('[value=copy]').onclick             = btn.copy;

        
              subject.root                          = $('#subject');
              subject.view                          = $(subject.root,'.dn-view');
              dn.field                              = $(subject.view,'.dn-field');
              issuer.root                           = $('#issuer');
              issuer.view                           = $(issuer.root,'.dn-view');

              
              thumbprint.root                       = $('#thumbprint');
              thumbprint.view                       = $(thumbprint.root,'#thumbprint-view');
              thumbprint.field                      = $(thumbprint.root,'.thumbprint-field');
              

              dates.root                            = $('#dates');
              dates.list                            = $(dates.root,'#dates-list');
              dates.date                            = $(dates.root,'.date-root');
              dates.valid                           = $(dates.root,'#dates-valid');
              



              
              view.root                             = $('#view');
              
              view.category                              = $('.view-category');
              view.category.remove();
              
              view.field                                 = $('.view-field');
              view.field.remove();
              


              
              if(history.load()){
                    display();
              }
                          
              
        }//initdom


  //:
  
  
        btn.load    = async function(){
          
              await load.cert(true);
              display();
              
        }//load
        
        
        btn.paste   = async function(){
          
              pem     = await navigator.clipboard.readText();
              cert    = nodeforge.pki.certificateFromPem(pem);
              history.save();
              
        }//paste
        
        
        btn.copy    = async function(){
          
              await navigator.clipboard.writeText(pem);
                                                                                console.log('copied');
        }//copy

        
  //:
  
  
        function display(){
          

              
              //console.log(nodeforge.pki);
              //console.json(cert);
              
              
              
              $('#filename').textContent    = file;



              subject.view.replaceChildren();
              
              props.subject.forEach(name=>{
                
                    var value   = '';
                    var attr    = cert.subject.attributes.find(attr=>attr.name===name);
                    if(attr){
                          value   = attr.value;
                    }
                    
                    var nfield    = dn.field.cloneNode(true);
                    $(nfield,'.dn-field-name').textContent       = name;
                    $(nfield,'.dn-field-value').textContent      = value;
                    subject.view.append(nfield);
                    
              });


              issuer.view.replaceChildren();
              
              props.issuer.forEach(name=>{
                
                    var value   = '';
                    var attr    = cert.issuer.attributes.find(attr=>attr.name===name);
                    if(attr){
                          value   = attr.value;
                    }
                    
                    var nfield    = dn.field.cloneNode(true);
                    $(nfield,'.dn-field-name').textContent       = name;
                    $(nfield,'.dn-field-value').textContent      = value;
                    issuer.view.append(nfield);
                    
              });
              
              
              thumbprint.view.replaceChildren();
              
              var asn1      = nodeforge.pki.certificateToAsn1(cert);
              var der       = nodeforge.asn1.toDer(asn1).getBytes();
              var format    = hex=>hex.match(/.{2}/g).join(' : ').toUpperCase();

              var sha1      = nodeforge.md.sha1.create().update(der).digest().toHex();
              var nfield    = thumbprint.field.cloneNode(true);
              $(nfield,'.thumbprint-field-name').textContent     = 'sha-1';
              $(nfield,'.thumbprint-field-value').textContent    = format(sha1);
              thumbprint.view.append(nfield);
              
              var sha256    = nodeforge.md.sha256.create().update(der).digest().toHex();
              var nfield    = thumbprint.field.cloneNode(true);
              $(nfield,'.thumbprint-field-name').textContent     = 'sha-256';
              $(nfield,'.thumbprint-field-value').textContent    = format(sha256);
              thumbprint.view.append(nfield);

              
              dates.list.replaceChildren();
              
              var ndate   = dates.date.cloneNode(true);
              $(ndate,'.date-label').textContent    = 'not before';
              $(ndate,'.date-simple').textContent   = '';
              $(ndate,'.date-full').textContent     = cert.validity.notBefore;
              dates.list.append(ndate);

              var ndate   = dates.date.cloneNode(true);
              $(ndate,'.date-label').textContent   = 'not after';
              $(ndate,'.date-simple').textContent   = '';
              $(ndate,'.date-full').textContent    = cert.validity.notAfter;
              dates.list.append(ndate);


              return;
              
              


              

              view.replaceChildren();
              
              
              var extensions    = cert.extensions;

          
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'version';
              $(nfield,'.field-value').textContent    = cert.version;
              view.append(nfield);

              
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'serialNumber';
              $(nfield,'.field-value').textContent    = cert.serialNumber;
              view.append(nfield);

              
              var ca    = extensions.find(ext=>('cA' in ext));
              var nfield    = field.cloneNode(true);
              nfield.style.cssText    = 'margin-top:20px';
              $(nfield,'.field-name').textContent   = 'CA';
              $(nfield,'.field-value').textContent    = ca.cA;
              view.append(nfield);
              
              
              

              
              
              
              
              var nfield    = field.cloneNode(true);
              nfield.style.cssText    = 'margin-top:20px';
              $(nfield,'.field-name').textContent   = 'subjectAltName';
              var attr    = extensions.find(attr=>attr.name==='subjectAltName');
              var str     = []
              attr.altNames.forEach(attr=>{
                
                    switch(attr.type){
                      
                      case 2    : str.push(attr.value);       break;
                      case 7    : str.push(attr.ip);          break;
                        
                    }//switch
                    
              });
              str   = str.join(', ');
              $(nfield,'.field-value').textContent    = str;
              view.append(nfield);
              
              var ext   = props.ext;
              for(var key in ext){
                
                    var attr    = extensions.find(attr=>attr.name===key);
                    
                    var nfield    = field.cloneNode(true);
                    nfield.style.cssText    = 'margin-top:20px';
                    $(nfield,'.field-name').textContent   = key;
                    
                    var str   = [];
                    var list    = ext[key];
                    list.forEach(name=>{

                          if(attr[name]){                      
                                str.push(name);
                                
                          }
                          
                    });
                    
                    str   = str.join(', ');
                    $(nfield,'.field-value').textContent    = str;
                    
                    view.append(nfield);
                    
              }//for
                    

              /*
              
              var b64   = window.btoa(cert.signature);
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'signature';
              $(nfield,'.field-value').textContent    = b64;
              $(nfield,'.field-value').style.flexWrap   = 'wrap';
              view.append(nfield);              
              
              */


              
              $('#pem').style.display   = 'inline-block';
              $('#pem').textContent     = pem;

              
        }//display


        create.field    = function(name,value){
        }//field
        
        create.field.sub    = function(name,value){
        }//sub




        async function load(){

              await Promise.all([load.ext(),load.nodeforge()]);
              
        }//load
        
        
        load.ext    = async function(){
          
              var res   = await fetch('https://raw.githubusercontent.com/javascript-2020/ext-code/main/ext-loader.js')
              var txt   = await res.text();
              ext       = eval(txt);
              [$,datatype,menumod,keydown]   = await ext.load.libs(
                    'js/dom/$.js',
                    'js/core/datatype.js',
                    'js/dom/menumod/menumod.js',
                    'js/dom/keydown/keydown.js'
              );
              
        }//ext
        
        
        load.nodeforge    = async function(){
          
              var txt         = localStorage['node-forge'];
              if(!txt){
                    var url   = 'https://cdn.jsdelivr.net/npm/node-forge/+esm';
                                                                                //console.log(url);
                    var res   = await fetch(url);
                    txt       = await res.text();
                    localStorage['node-forge']    = txt;
              }
              
              var blob        = new Blob([txt],{type:'text/javascript'});
              var url         = window.URL.createObjectURL(blob);
              nodeforge       = await import(url);
              nodeforge       = nodeforge.default;
              //pki             = nodeforge.pki;
              
        }//nodeforge

                
        load.cert   = function(import_cert){
        
              var resolve,promise=new Promise(res=>resolve=res);
              
              var input         = document.createElement('input');
              input.type        = 'file';
              input.onchange    = onchange;
              input.click();
              
              return promise;
              
              
              async function onchange(){
              
                    file    = input.files[0].name;
                    pem     = await input.files[0].text();
                    
                    cert    = nodeforge.pki.certificateFromPem(pem);
                    
                    history.save();
                    resolve();
                    
              }//onchange
              
        }//cert
        

  //:
  
  
        history.delete    = function(){
          
              delete localStorage[store];
              
        }//delete
        
        
        history.load    = function(){
          
              var txt   = localStorage[store];
              if(!txt){
                    return;
              }
              var json      = JSON.parse(txt);
              ({file,pem}   = json);
              cert          = nodeforge.pki.certificateFromPem(pem);
              return true;
              
        }//load
        
        
        history.save    = function(){
          
              var txt               = JSON.stringify({file,pem});
              localStorage[store]   = txt;
              
        }//save
        

</script>

</html>







        
    