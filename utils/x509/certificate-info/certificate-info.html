

<!--


see bottom for name constraints

juicy question
https://stackoverflow.com/questions/52367234/generate-der-format-public-key-from-pem-format-certificate-and-pem-format-public

example certs for testing
https://fm4dd.com/openssl/certexamples.shtm



-->




<html>

      <head>
            <meta name=description content='display x509 certificate info'>
            
            <title>
                  x509 certificate info
            </title>
            
            <meta name=description content='view x509 certificate information'>
            
            <base href='https://ext-code.com/utils/x509/certificate-info/'>
            <link rel=canonical href='https://ext-code.com/utils/x509/certificate-info/certificate-info.html'>
            
            <link rel=icon type='image/x-icon' href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAABjFBMVEVHcEwHBwcDAwQAAAAcKjgxOU1BS2UmLTzOzvAUExEQERSoqMO3t9UrLDMtNEYzMzszND0GBgU8k7qkpL9ET2saJzN9fZFNPRA1PVPS0vUEBARtbX8bHiZvb4NXV2UbOEggIio1gaQFBQQoLz9DTmkhHRoiTmS8vdxTVGI+MyE5Q1pJs+QGBgWaWgREQkZZWWY+SGJcXGsnKzVzc4WCgpcNDhEHCAkEAwIGBwdGqtknXXYyeZoaHigJCQgGBQQhISQ7RV0/msRGRlNmZXA4KhJZaY0FBAMDAwSvhADrsgJ5RgJdXWtnZ3h0WAKiegACAgM0NDybnLRDpNHElAAFBAMHBwkkJCkCAgMqKjGTbwHAkQMwKihhSw30uAJcRgVeNgIPDw9sUgXnrgKRkq1Lue3Y2P2Ki6GQkKiEhJpQUFza2v6Xl6/b2//+vwDd3f9FRVBAQEr/wgCHiJ5MvPBMS1hMu+/V1fng4P+NjaSGhpxDQ0/Hx+iIiJ+yss+wsM3AwOAVEhPLy+xhYnNRX4Cv2ZNQAAAAenRSTlMAk5Uq/f3+/P4I1v7++/3q/kP9/vz8/vz8/oP97v7//P79Nfz9/v3+/P3+/kv9/Pz+/vz8/bykaZH+/f35HTPW/P7+/P3+XdH9/v38/fz9l+j+/f137uje6vz9/Pv+/P0S/f79/////////////////////////////khVmIEAAAHnSURBVCjPjdNnV9pQHIBxhATCSiOBEBkCskW2dVtxb4vdezIEEkhkSCCCtl+891KoNy962udVzvmd/01ukqtS/asF9RTayrSSn86WSiXpuiRfw2TqtdLV3Zuwu5L83qlzoHq6tTWtZGP0/OjCfkoUYcnFsgF1NZO4EEXx2C5zkM/MQvBwE+GI/SPP8+JRqwO5PxgY32geeGrnAw/5eWJmtHqVI/IIq3/Yv4mA3yYhwe4VLJ2eH4v8uyjNFcNdt1MyKbnbF/a+fgpKVSJr9rOsPzP7CuXSjftzPL4XJiI6K+vX4Vby5ZyST07iUZNTF7CFfL41Ww5f0qPsvNt5H6yZrTZfodlsW7CAawHh+lWaoFu7JL7WLoCa67r5FYS5GbBjIjmPWZqQC88w7WM9wqPXEclh26PpwqqSqx1Q8Yz1r4+mmxYstYQsLrVATC2T8qwCb8dCLLmM8G0ZZOwncqTHEotth3QBwybCi71GoyFk6UyKtXk8GG71GuYQNtVg9LBMkVoQ7vXubjme/GFG+F12yPQoSnAazWbqbrLAZBrMD26Nl5e0qf/o0LuvHfv43rBeD1z1KoO8w/Vzf2MZffKHasO85sC14dCPv7fcqqClTeB3OHihnxwD+UqRxLg0fz1EMMcX1X/1C/Sln2UE4CvfAAAAAElFTkSuQmCC'>
            <meta name=viewport content='width=device-width, initial-scale=1'>
            
            <script type='application/ld+json'>
                  {
                        "@context"              : "https://schema.org",
                        "@type"                 : "SoftwareApplication",
                        "name"                  : "x509 Certificate Info",
                        "url"                   : "https://ext-code.com/utils/x509/certificate-info/certificate-info.html",
                        "author"                : {"@type":"Person","name":"Matthew Richards"},
                        "description"           : "display information about x509 certificate and some utility functions",
                        "applicationCategory"   : "DeveloperApplication",
                        "operatingSystem"       : "All",
                        "browserRequirements"   : "Requires JavaScript-enabled browser",
                        "softwareVersion"       : "1.0.0",
                        "offers"                : {"@type":"Offer","price":"0","priceCurrency":"GBP"}
                  }
            </script>
            
            
            
            <script src='https://libs.ext-code.com/js/dom/component/v3.0/component.js'></script>
            
            <script init>
                                                                                console.clear();
                                                                                console.log('certificate-info-v2.0.html');
                                                                                console.log();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
        var df=true,did='cert-info';
        
        var ext;
        var $;
        var datatype;
        var menumod;
        var keydown;
        
        var menu;
        
        var log;
        var hdr;
        
        
  //:
  
  
        async function init(){
        
        
              menu                      = menumod();
              
              mod.base.add({ext,$,datatype,keydown,menu,menumod});
              
              
              hdr                       = mod['x509-hdr'];
              log                       = mod['log-mod']
              
              
              menu.initmod({});
              
              hdr.initmod({$,menu});
              log.initmod({ext,$});
              
              
              await hdr.init()
              await log.init();
              
              
              
              
              history.delete();
              
              
              await load();
              
              
              initdom(document.body);
              
              
              
        }//init
        
        
(async()=>{

        mod.stack.add;
        
        ({ext}    = await import('https://libs.ext-code.com/js/io/ext-loader/ext-loader.m.js'));
        
        var promise   = ext.load.libs(
              'js/dom/$.js',
              'js/core/datatype.js',
              'js/dom/menumod/menumod.js',
              'js/dom/keydown/keydown.js',
              'js/debug/debug.js.api',
        );
        [$,datatype,menumod,keydown,debug]   = await promise;
        
        mod.stack.complete;
        
})();


            </script init>
            
            <style>
            
  html
    {height:100%}
    
  body
    {height:calc(100% - 42px);margin:20px;display:flex;flex-direction:column;font-family:arial}
    
  html
    {--col1:200px}
    
/*
  #center-hldr
    {position:relative}
  #center
    {width:1200px;position:absolute;margin:auto;left:0;right:0}
*/

  #center-hldr
    {display:flex;justify-content:center}
  #center
    {width:1200px}
    
    
  .hdr
    {font-family:arial;position:relative;margin-top:0;margin-bottom:20px;background:white;
      padding-bottom:10px;border-bottom:3px solid lightblue
    }
    
  .hdr-icon
    {display:inline-block;text-align:center;background:whitesmoke;border-radius:5px;
      border:1px solid lightgray;padding:5px 3px 0px;cursor:pointer;margin-right:10px;
      min-width:50px
    }
    
  .hdr-icon-img
    {width:25px;height:25px}
    
  .hdr-icon-label
    {margin:2px 0 0}
    
  .hdr-title
    {position:absolute;left:0;right:0;z-index:0;margin:0 auto}
    
  .hdr-date
    {float:right}
    
    
    
  #btns
    {margin:20px 0}
    
    
  #info
    {display:flex;flex-direction:column;gap:20px}
    
  #filename-root
    {border:1px solid blue;padding:10px 10px;border-radius:5px;font-weight:bold;background:lightyellow}
  #filename
    {margin-left:20px}
    
  #dn-root
    {display:flex;gap:50px;align-items:start;width:100%}
    
  #subject
    {border-color:lightblue}
  #subject .dn-title
    {background:blue}
  #subject .dn-field:nth-child(even)
    {background:hsl(200,100%,98%)}
    
  #issuer
    {border-color:lightgreen}
  #issuer .dn-title
    {background:green}
  #issuer .dn-field:nth-child(even)
    {background:hsl(120,100%,98%)}
    
  .dn
    {flex:1;border:1px solid;border-radius:5px;padding:10px}
    
  .dn-title
    {font-weight:bold;color:white;text-align:center;padding:5px 10px;margin-bottom:10px}
    
  .dn-view
    {}
    
  .dn-field
    {display:flex;gap:40px;padding:10px 10px}
    
  .dn-field:nth-child(even)
    {background:whitesmoke}
    
    
  .dn-field-name
    {width:200px;text-align:right}
    
  .dn-field-value
    {flex:1;font-weight:bold}
    
    
  #keyUsage
    {border-color:orange}
  #keyUsage .extension-title
    {background:orange}
  #keyUsage .extension-field-value:nth-child(even)
    {background:hsl(30,100%,98%)}
    
  #extKeyUsage
    {border-color:purple}
  #extKeyUsage .extension-title
    {background:purple}
  #extKeyUsage .extension-field-value:nth-child(even)
    {background:hsl(270,100%,98%)}
    
  #extensions-root
    {display:flex;gap:50px;align-items:start;width:100%}
  .extension
    {flex:1;border:1px solid lightgray;border-radius:5px;padding:10px}
  .extension-title
    {font-weight:bold;color:white;text-align:center;padding:5px 10px;margin-bottom:10px}
  .extension-field-value
    {padding:10px 10px;text-align:center;font-weight:bold}
    
    
  #name-constraints-root
    {display:flex;gap:50px;width:100%}
  .name-constraint
    {flex:1;border:1px solid lightgray;border-radius:5px;padding:10px}
  .name-constraint-title
    {font-weight:bold;color:white;text-align:center;padding:5px 10px;margin-bottom:10px;background:lightgray}
  .name-constraint-field-value
    {padding:10px 10px;text-align:center;font-weight:bold}
    
    
    
    
  #dns
    {border-color:hsl(340,100%,85%)}
  #dns .san-title
    {background:hsl(340,100%,85%)}
  #dns .san-value:nth-child(even)
    {background:hsl(340,100%,98%)}
    
  #ip
    {border-color:hsl(210,100%,85%)}
  #ip .san-title
    {background:hsl(210,100%,85%)}
  #ip .san-value:nth-child(even)
    {background:hsl(210,100%,98%)}
    
  #email
    {border-color:hsl(150,100%,85%)}
  #email .san-title
    {background:hsl(150,100%,85%)}
  #email .san-value:nth-child(even)
    {background:hsl(150,100%,98%)}
    
  #url
    {border-color:hsl(270,100%,90%)}
  #url .san-title
    {background:hsl(270,100%,90%)}
  #url .san-value:nth-child(even)
    {background:hsl(270,100%,98%)}
    
  #dir
    {border-color:hsl(30,100%,85%)}
  #dir .san-title
    {background:hsl(30,100%,85%)}
  #dir .san-value:nth-child(even)
    {background:hsl(30,100%,98%)}
    
  #oid
    {border-color:hsl(50,100%,85%)}
  #oid .san-title
    {background:hsl(50,100%,85%)}
  #oid .san-value:nth-child(even)
    {background:hsl(50,100%,98%)}
    
    
  #san-root
    {display:flex;justify-content:space-between;gap:20px;align-items:start;width:100%}
  .san
    {flex:1;border:1px solid lightgray;border-radius:5px;padding:10px}
  .san-title
    {font-weight:bold;color:gray;text-align:center;padding:5px 10px;margin-bottom:10px}
  .san-value
    {padding:10px 10px;text-align:center;font-weight:bold}
    
    
    
  .category
    {margin-left:0}
  .category-title
    /*{background:lightgray;text-align:center;margin-bottom:10px;padding:5px}*/
    {margin-bottom:10px;color:blue;font-weight:bold}
  .category-view
    {}
  .category-field
    {display:flex;gap:40px;padding:10px;padding-left:50px}
  .category-field-name
    {width:var(--col1)}
  .category-field-value
    {flex:1;font-weight:bold;word-break:break-all;font-family:monospace;font-size:20px}
    
    
  #thumbprint
    {}
  #thumbprint-title
    {}
  #thumbprint-view
    {}
  .thumbprint-field
    {}
  .thumbprint-field-name
    {}
  .thumbprint-field-value
    {}
    
    
  #dates
    {}
  #dates-title
    {}
  #dates-view
    {display:flex;align-items:center}
  #dates-list
    {flex:1}
  .date-root
    {display:flex}
  .date-label
    {}
  .date-simple
    {}
  .date-full
    {flex:1}
  #dates-valid
    {margin-right:20px}
  .dates-valid
    {content:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAAXVBMVEVHcEwa13Mb1XQc1XQpynsd03Uwv3oa13Mnynce03UlzHYd1HYg0XYc1XQh0XYd03Qe1HUg0XYc1HQf0HUd1XUd0XMfz3UZ13Pn5ucp2Hxo3Z+O4LXa5uC85M9H243zMKCpAAAAF3RSTlMA+NPWD40F/Bx9IJ5d716ho1/tW/BcW3mRwfMAAADcSURBVCjPjZNXFoQgDEVDsPcyM7Gy/2UOCBZQj74fyoUkJwVgVVRU/BOGOVZ1Aq6SGBkZMYztB0HByRIvgp16PiNHzPc2mtKFUsMDny7la/s1u8asXmLmdCOu4o/pVrHMBp6vh16vGEFx8tyP06g5y6A6066bhN6XgFd0MAeE3OyENmhRyiE0n+Zu7l1K4YrF3CluU4k344o7lJo9NMUdKkMr6chtSilkW1p6MTuUtVZShU1VUh9K8lTQg3enHbI3zfTQik+NLO1nTl3xG7wfomUE2xIbNYLlL9ou/yNmPb9gPGs5AAAAAElFTkSuQmCC')}
  .dates-invalid
    {content:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAANlBMVEVHcEzvU1v1SlH2SVDMsrbqXGPlaW/rWl/0TFPzTVPyTlXrV1/zTlT0S1LvVVvuU1nxU1r3SE+VlM7ZAAAAEXRSTlMAbPP6AiEML9TKrEG55lp7jd7fFusAAAC6SURBVCjPhZPbFoQgCEVBSss7//+zoyZdZprFeWnl9gAqAJyyLpdaS3YWfrViTMRNlCKuX9Dixjdt+IiweuKHyN8CuJ1/tLvT+0Ibn37r+VX+yI/0jglHaKnZzG1kpP4eHuUn4Fg3GMTQ7DZOb4Clc4MLhOmPFlySTEvnZnxmmuQgS2EHODZJcRnKWWnnTRdlLlD5xsc5L8pVw0pwpTTlYMq1KJeqPYnyoFo7KM2ktaLWyNoYaEP0bwQ/OJUj5UwLjAIAAAAASUVORK5CYII=')}
    
    
    
    
    
    
    
    
    
  #signature
    {}
  #signature-field
    {}
  #signature-field-name
    {}
  #signature-field-value
    {}
    
    
  #view
    {margin-bottom:20px}
    
    
  .view-category
    {margin-top:20px}
    
  .view-field
    {display:flex;margin-top:10px}
    
  .view-field-name
    {display:inline-block;width:200px}
    
  .view-field-value
    {flex:1}
    
    
  #pem-root
    {display:flex;justify-content:center}
  #pem
    {border:1px solid lightgray;padding:10px;display:none}
    
    
  #ftr
    {position:relative}
  #ftr div
    {height:100px;position:absolute;left:0;right:0}
    
    
  input
    {padding:5px 10px;font-size:16px}
    
    
  .visually-hidden
    {position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;
      clip:rect(0 0 0 0) !important;white-space:nowrap !important;border:0 !important}
      
      
            </style>
            
      </head>
      
      <body>
      
            <div id=center-hldr>
            
                  <div id=center>
                  
                  
                        <x509-hdr component=grp>
                              <h1 class=visually-hidden>
                                    display x509 certificate info
                              </h1>
                              <img class=title src='images/certificate-info.png' style='top:5px;height:55px'>
                              <time slot=date datetime=2025-09-28>
                                    28 Sep 2025
                              </time>
                        </x509-hdr>
                        
                        <h3>
                              View and Decode X.509 Certificates Instantly
                        </h3>
                        
                        <div id=desc>
                              Easily inspect and analyze X.509 certificates with our free online tool. Decode certificate fields, extensions, key usages, and subject alternative names in a human-readable format. Perfect for developers, sysadmins, and security professionals working with SSL/TLS, PKI, and digital identity. No upload required - just paste your certificate and get instant results.
                        </div>
                        
                        
                        <div id=btns>
                              <input value=clear type=button>
                              <input value=load type=button>
                              <input value=paste type=button>
                              <input value=copy type=button>
                        </div>
                        
                        
                        <div id=info>
                        
                        
            <!--
                              <div id=category class=category>
                              
                                    <div class=category-title>
                                    </div>
                                    
                                    <div class=category-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                    
                              </div>
            -->
            
            
                              <div id=filename-root>
                                    <span>
                                          file :
                                    </span>
                                    <span id=filename>
                                    </span>
                              </div>
                              
                              
                              <div id=category class=category>
                              
                                    <div class=category-title>
                                          Distinguished Name
                                    </div>
                                    
                                    <div class=category-field>
                                    
                                          <div id=dn-root>
                                          
                                                <div id=subject class=dn>
                                                
                                                      <div class=dn-title>
                                                            Subject
                                                      </div>
                                                      
                                                      <div class=dn-view>
                                                            <div class=dn-field>
                                                                  <div class=dn-field-name></div>
                                                                  <div class=dn-field-value></div>
                                                            </div>
                                                      </div>
                                                      
                                                </div>
                                                
                                                
                                                <div id=issuer class=dn>
                                                
                                                      <div class=dn-title>
                                                            Issuer
                                                      </div>
                                                      
                                                      <div class=dn-view>
                                                      </div>
                                                      
                                                </div>
                                                
                                          </div>
                                          
                                    </div>
                                    
                              </div>
                              
                              
                              <div id=thumbprint class=category>
                              
                                    <div id=thumbprint-title class=category-title>
                                          Certificate Hash / ThumbPrint
                                    </div>
                                    <div id=thumbprint-view class=category-view>
                                          <div class='thumbprint-field category-field'>
                                                <div class='thumbprint-field-name category-field-name'></div>
                                                <div class='thumbprint-field-value category-field-value'></div>
                                          </div>
                                    </div>
                                    
                              </div>
                              
                              
                              <div id=dates class=category>
                              
                                    <div id=dates-title class=category-title>
                                          Dates
                                    </div>
                                    
                                    <div id=dates-view>
                                          <div id=dates-list>
                                                <div class='date-root category-field'>
                                                      <div class='date-label category-field-name'>
                                                            not before
                                                      </div>
                                                      <div class='date-full category-field-value'>
                                                      </div>
                                                </div>
                                          </div>
                                          
                                          <div>
                                                <img id=dates-valid>
                                          </div>
                                    </div>
                                    
                              </div>
                              
                              
                              <div id=category class=category>
                              
                                    <div class=category-title>
                                          Extensions
                                    </div>
                                    
                                    <div class=category-field>
                                    
                                          <div id=extensions-root>
                                          
                                                <div class=extension>
                                                
                                                      <div class=extension-title>
                                                      </div>
                                                      
                                                      <div class=extension-list>
                                                            <div class=extension-field-value></div>
                                                      </div>
                                                      
                                                </div>
                                                
                                          </div>
                                          
                                    </div>
                                    
                              </div>
                              
                              
                              <div class=category>
                              
                                    <div class=category-title>
                                          Subject Alternate Name
                                    </div>
                                    
                                    <div class=category-field>
                                    
                                          <div id=san-root>
                                          
                                                <div class=san>
                                                
                                                      <div class=san-title>
                                                      </div>
                                                      
                                                      <div class=san-list>
                                                            <div class=san-value></div>
                                                      </div>
                                                      
                                                </div>
                                                
                                          </div>
                                          
                                    </div>
                                    
                              </div>
                              
                              
                              <div id=constraints class=category>
                              
                                    <div class=category-title>
                                          Basic Constraints
                                    </div>
                                    
                                    <div id=constraints-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                    
                              </div>
                              
                              
                              <div class=category>
                              
                                    <div class=category-title>
                                          Name Constraints
                                    </div>
                                    
                                    <div class=category-field>
                                    
                                          <div id=name-constraints-root>
                                          
                                                <div class=name-constraint>
                                                
                                                      <div class=name-constraint-title>
                                                      </div>
                                                      
                                                      <div class=name-constraint-list>
                                                            <div class=name-constraint-field-value></div>
                                                      </div>
                                                      
                                                </div>
                                                
                                          </div>
                                          
                                    </div>
                                    
                              </div>
                              
                              
                              
                              <div id=meta class=category>
                              
                                    <div class=category-title>
                                          Certificate Meta Data
                                    </div>
                                    
                                    <div id=meta-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                    
                              </div>
                              
                              
                              <div id=public-key class=category>
                              
                                    <div class=category-title>
                                          Public Key
                                    </div>
                                    
                                    <div id=public-key-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                    
                              </div>
                              
                              
                              <div id=authority-key class=category>
                              
                                    <div class=category-title>
                                          Authority Key Identifier
                                    </div>
                                    
                                    <div id=authority-key-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                    
                              </div>
                              
                              
                              <div id=signature class=category>
                              
                                    <div class=category-title>
                                          Signature
                                    </div>
                                    
                                    <div id=signature-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                    
                              </div>
                              
                              
                              
                              
                              
                              <div id=view>
                              
                                    <div class=view-category>
                                          <div class=view-label></div>
                                    </div category>
                                    
                                    <div class=view-field>
                                          <span class=view-field-name>commonName</span>
                                          <span class=view-field-value></span>
                                    </div>
                                    
                              </div view>
                              
                              
                              
                              <div id=pem-root>
                                    <pre id=pem></pre>
                              </div>
                              
                        </div>
<!--
                        <div id=ftr>
                              <div></div>
                        </div>
-->

                  </div center>
                  
            </div center-hldr>
            
            <log-mod component></log-mod>
            
            
            <div id=ftr>
                  <div></div>
            </div>
            
            
            
      </body>
      
      <script>
      
      
      
      
        var nodeforge;
        
        var store   = 'certificate-info';
        
        
        var file;
        var cert;
        var pem;
        
        
        var view;
        
        
        
        var props               = {};
        props.issuer            = [ 'commonName','OrganizationalUnit','Organization','Locality','StateOrProvinceName','CountryName'];
        props.subject           = [ 'commonName','OrganizationalUnit','Organization','Locality','StateOrProvinceName','CountryName'];
        
        props.ext               = {};
        props.ext.keyUsage      = ['keyCertSign','digitalSignature','nonRepudiation','keyEncipherment','dataEncipherment','keyAgreement','cRLSign','encipherOnly','decipherOnly'];
        props.ext.extKeyUsage   = ['serverAuth','clientAuth','codeSigning','emailProtection','timeStamping','OCSPSigning','ipsecEndSystem','ipsecTunnel','ipsecUser','anyExtendedKeyUsage','msCodeInd',
                                    'msCodeCom','msCTLSign','msEFS','nsSGC','msSGC'];
                                    
        props.ext.nsCertType    = ['client','server','email','objSign','sslCA','emailCA','objCA'];
        
        
        var history             = {};
        var btn                 = {};
        
        
        
        
  //:
  
  
        var category        = {};
        
        
        var subject         = {};
        var issuer          = {};
        var dn              = {};
        var thumbprint      = {};
        var dates           = {};
        dates.notbefore     = {};
        dates.notafter      = {};
        var extensions      = {};
        var san             = {};
        var constraints     = {};
        var nameconstraints       = {};
        var meta            = {};
        var publickey       = {};
        var authoritykey    = {};
        var signature       = {};
        
        
        
        
        
        
        var view            = {};
        
        
        
        var create    = {};
        
        
  //:
  
  
        function initdom(rootnode){
        
        
              var root                              = rootnode;
              
              hdr.initdom(root);
              
              
              var btns                              = $('#btns');
              
              $('[value=clear]').onclick            = btn.clear;
              $('[value=load]').onclick             = btn.load;
              $('[value=paste]').onclick            = btn.paste;
              $('[value=copy]').onclick             = btn.copy;
              
              
              subject.root                          = $('#subject');
              subject.view                          = $(subject.root,'.dn-view');
              dn.field                              = $(subject.view,'.dn-field');
              issuer.root                           = $('#issuer');
              issuer.view                           = $(issuer.root,'.dn-view');
              
              
              thumbprint.root                       = $('#thumbprint');
              thumbprint.view                       = $(thumbprint.root,'#thumbprint-view');
              thumbprint.field                      = $(thumbprint.root,'.thumbprint-field');
              
              
              dates.root                            = $('#dates');
              dates.list                            = $(dates.root,'#dates-list');
              dates.date                            = $(dates.root,'.date-root');
              dates.valid                           = $(dates.root,'#dates-valid');
              
              
              extensions.root                       = $('#extensions-root');
              extensions.extension                  = $(extensions.root,'.extension');
              extensions.value                      = $(extensions.extension,'.extension-field-value');
              extensions.value.remove();
              
              
              san.root                              = $('#san-root');
              san.san                               = $(san.root,'.san');
              san.value                             = $(san.san,'.san-value');
              san.value.remove();
              
              
              constraints.root                      = $('#constraints');
              constraints.list                      = $(constraints.root,'#constraints-list');
              constraints.field                     = $(constraints.list,'.category-field');
              
              
              nameconstraints.root                  = $('#name-constraints-root');
              nameconstraints.node                  = $(nameconstraints.root,'.name-constraint');
              nameconstraints.list                  = $(nameconstraints.root,'.name-constraint-list');
              nameconstraints.value                 = $(nameconstraints.list,'.name-constraint-field-value');
              nameconstraints.value.remove();
              
              
              meta.root                             = $('#meta');
              meta.list                             = $(meta.root,'#meta-list');
              meta.field                            = $(meta.list,'.category-field');
              
              
              publickey.root                        = $('#public-key');
              publickey.list                        = $(publickey.root,'#public-key-list');
              publickey.field                       = $(publickey.root,'.category-field');
              
              
              authoritykey.root                     = $('#authority-key');
              authoritykey.list                     = $(authoritykey.root,'#authority-key-list');
              authoritykey.field                    = $(authoritykey.list,'.category-field');
              
              
              signature.root                        = $('#signature');
              signature.list                        = $(signature.root,'#signature-list');
              signature.field                       = $(signature.list,'.category-field');
              
              
              
              
              view.root                             = $('#view');
              
              view.category                         = $('.view-category');
              view.category.remove();
              
              view.field                            = $('.view-field');
              view.field.remove();
              
              
              
              display();
              
              if(history.load()){
                    display();
              }
              
              
              
              
              
              log.initdom(rootnode);
              
              
              
        }//initdom
        
        
  //:
  
  
        btn.clear   = function(){
        
              file    = null;
              cert    = null;
              pem     = null;
              display();
              
        }//clear
        
        
        btn.load    = async function(){
        
              await load.cert(true);
              display();
              
        }//load
        
        
        btn.paste   = async function(){
        
              pem     = await navigator.clipboard.readText();
              cert    = nodeforge.pki.certificateFromPem(pem);
              history.save();
              
        }//paste
        
        
        btn.copy    = async function(){
        
              await navigator.clipboard.writeText(pem);
                                                                                console.log('copied');
        }//copy
        
        
  //:
  
  
        function display(){
        
        
        
              //console.log(nodeforge.pki);
              //console.json(cert);
              
              var str   = '';
              if(file){
                    str   = file;
              }
              $('#filename').textContent    = str;
              
              
              subject.view.replaceChildren();
              
              if(cert){
                    props.subject.forEach(name=>{
                    
                          var attr    = cert.subject.attributes.find(attr=>attr.name===name);
                          if(!attr){
                                return;
                          }
                          var value     = attr.value;
                          var nfield    = dn.field.cloneNode(true);
                          $(nfield,'.dn-field-name').textContent       = name;
                          $(nfield,'.dn-field-value').textContent      = value;
                          subject.view.append(nfield);
                          
                    });
              }
              
              
              issuer.view.replaceChildren();
              
              if(cert){
                    props.issuer.forEach(name=>{
                    
                          var attr    = cert.issuer.attributes.find(attr=>attr.name===name);
                          if(!attr){
                                return;
                          }
                          var value     = attr.value;
                          var nfield    = dn.field.cloneNode(true);
                          $(nfield,'.dn-field-name').textContent       = name;
                          $(nfield,'.dn-field-value').textContent      = value;
                          issuer.view.append(nfield);
                          
                    });
              }
              
              
              thumbprint.view.replaceChildren();
              
              if(cert){
                    var asn1      = nodeforge.pki.certificateToAsn1(cert);
                    var der       = nodeforge.asn1.toDer(asn1).getBytes();
                    var format    = hex=>hex.match(/.{2}/g).join(':').toUpperCase();
                    
                    var sha1      = nodeforge.md.sha1.create().update(der).digest().toHex();
                    var nfield    = thumbprint.field.cloneNode(true);
                    $(nfield,'.thumbprint-field-name').textContent     = 'sha-1';
                    $(nfield,'.thumbprint-field-value').textContent    = format(sha1);
                    thumbprint.view.append(nfield);
                    
                    var sha256    = nodeforge.md.sha256.create().update(der).digest().toHex();
                    var nfield    = thumbprint.field.cloneNode(true);
                    $(nfield,'.thumbprint-field-name').textContent     = 'sha-256';
                    $(nfield,'.thumbprint-field-value').textContent    = format(sha256);
                    thumbprint.view.append(nfield);
              }
              
              
              dates.list.replaceChildren();
              
              if(cert){
                    var ndate   = dates.date.cloneNode(true);
                    $(ndate,'.date-label').textContent    = 'Not Before';
                    $(ndate,'.date-full').textContent     = cert.validity.notBefore;
                    dates.list.append(ndate);
                    
                    var ndate   = dates.date.cloneNode(true);
                    $(ndate,'.date-label').textContent   = 'Not After';
                    $(ndate,'.date-full').textContent    = cert.validity.notAfter;
                    dates.list.append(ndate);
                    
                    dates.valid.style.visibility    = '';
                    var today   = new Date();
                    var valid   = (cert.validity.notBefore<today) && (today<cert.validity.notAfter);
                    if(valid){
                          dates.valid.className   = 'dates-valid';
                    }else{
                          dates.valid.className   = 'dates-invalid';
                    }
              }else{
                    dates.valid.style.visibility    = 'hidden';
              }
              
              
              extensions.root.replaceChildren();
              
              if(cert){
                    ['keyUsage','extKeyUsage'].forEach(key=>{
                    
                          var nextension    = extensions.extension.cloneNode(true);
                          nextension.id     = key;
                          $(nextension,'.extension-title').textContent    = key;
                          var list      = $(nextension,'.extension-list');
                          var attr      = cert.extensions.find(attr=>attr.name===key);
                                                                                      console.log(attr);
                          if(attr){
                                var values    = props.ext[key].filter(name=>attr[name]);
                                values.forEach(value=>{
                                
                                      var nvalue   = extensions.value.cloneNode(true);
                                      nvalue.textContent    = value;
                                      list.append(nvalue);
                                      
                                });
                          }
                          extensions.root.append(nextension);
                          
                    });
              }
              
              
              san.root.replaceChildren();
              
              if(cert){
                    var attr    = cert.extensions.find(attr=>attr.name==='subjectAltName');
                    if(attr){
                          [{v:2,name:'dns'},{v:7,name:'ip'},{v:1,name:'email'},{v:6,name:'url'},{v:4,name:'dir'},{v:8,name:'oid'}].forEach(desc=>{
                          
                                var nsan    = san.san.cloneNode(true);
                                nsan.id     = desc.name;
                                $(nsan,'.san-title').textContent    = desc.name;
                                var list    = $(nsan,'.san-list');
                                var ct      = 0;
                                attr.altNames.forEach(attr=>{
                                
                                      if(attr.type!=desc.v)return;
                                      ct++;
                                      var nvalue    = san.value.cloneNode(true);
                                      var str;
                                      switch(attr.type){
                                      
                                        case 2    : str   = attr.value;       break;
                                        case 7    : str   = attr.ip;          break;
                                        
                                      }//switch
                                      
                                      nvalue.textContent    = str;
                                      list.append(nvalue);
                                      
                                });
                                
                                if(ct){
                                      san.root.append(nsan);
                                }
                                
                          });
                    }
              }
              
              
              constraints.list.replaceChildren();
              
              if(cert){
                    var ca    = cert.extensions.find(ext=>ext.name=='basicConstraints');
                    if(ca){
                          var nconstraint   = constraints.field.cloneNode(true);
                          $(nconstraint,'.category-field-name').textContent     = 'CA';
                          $(nconstraint,'.category-field-value').textContent    = ca.cA;
                          constraints.list.append(nconstraint);
                          
                          if(ca.cA){
                                var value   = 'no limit';
                                if('pathLenConstraint' in ca){
                                      value   = ca.pathLenConstraint;
                                }
                                var nconstraint   = constraints.field.cloneNode(true);
                                $(nconstraint,'.category-field-name').textContent     = 'pathlen';
                                $(nconstraint,'.category-field-value').textContent    = value
                                constraints.list.append(nconstraint);
                          }
                    }
              }
              
              
              
/*

              extensions.root.replaceChildren();
              
              ['keyUsage','extKeyUsage'].forEach(key=>{
              
                    var nextension    = extensions.extension.cloneNode(true);
                    nextension.id     = key;
                    $(nextension,'.extension-title').textContent    = key;
                    var list      = $(nextension,'.extension-list');
                    var attr      = cert.extensions.find(attr=>attr.name===key);
                    if(attr){
                          var values    = props.ext[key].filter(name=>attr[name]);
                          values.forEach(value=>{
                          
                                var nvalue   = extensions.value.cloneNode(true);
                                nvalue.textContent    = value;
                                list.append(nvalue);
                                
                          });
                    }
                    extensions.root.append(nextension);
                    
              });
              
              
*/



              nameconstraints.root.replaceChildren();
              
              if(cert){
                    var nc    = cert.extensions.find(ext=>ext.name==='nameConstraints');
                    console.log(nc)
                    if(nc){
                                                                                                    console.log('Name Constraints found:');
                                                                                                    //console.log(nc.permittedSubtrees);
                          var raw     = nc.value;
                          var buf     = nodeforge.util.createBuffer(raw, 'raw');
                          var asn1    = nodeforge.asn1.fromDer(buf);
                                                                                                    console.log(JSON.stringify(asn1,null,4));
                                                                                                    
                          var permitted   = asn1.value.find(o=>o.type===0);
                                                                                                    console.log('permitted');
                                                                                                    console.log(permitted);
                          var excluded    = asn1.value.find(o=>o.type===1);
                                                                                                    console.log('excluded');
                                                                                                    console.log(excluded);
                          var nn    = nameconstraints.node.cloneNode(true);
                          $(nn,'.name-constraint-title').textContent    = 'Permitted';
                          var list    = $(nn,'.name-constraint-list');
                          
                          permitted.value.forEach(sub=>{
                          
                                sub   = sub.value[0];
                                                                                                    console.log(sub);
                                var nvalue    = nameconstraints.value.cloneNode(true);
                                var type;
                                var value   = sub.value;
                                switch(sub.type){
                                
                                  case 2    : type    = 'dns';        break;
                                  case 7    :
                                              type    = 'ip';
                                              value   = decode_ip(value);
                                              break;
                                              
                                }//switch
                                nvalue.textContent    = type + ': ' + value;
                                list.append(nvalue);
                                                                                                    console.log(sub.type + ': ' + sub.value);
                          });
                          nameconstraints.root.append(nn);
                          
                          var nn    = nameconstraints.node.cloneNode(true);
                          $(nn,'.name-constraint-title').textContent    = 'Excluded';
                          var list    = $(nn,'.name-constraint-list');
                          
                          excluded.value.forEach(sub=>{
                          
                                sub   = sub.value[0];
                                                                                                    console.log(sub);
                                var nvalue    = nameconstraints.value.cloneNode(true);
                                var type;
                                var value   = sub.value;
                                switch(sub.type){
                                
                                  case 2    : type    = 'dns';        break;
                                  case 7    :
                                              type    = 'ip';
                                              value   = decode_ip(value);
                                              break;
                                              
                                }//switch
                                nvalue.textContent    = type + ': ' + value;
                                list.append(nvalue);
                                                                                                    console.log(sub.type + ': ' + sub.value);
                          });
                          nameconstraints.root.append(nn);
                          
                    }else{
                                                                                                    console.log('No Name Constraints present in this certificate.');
                    }
              }
              
              
              
              function decode_ip(bin){
              
                    var buf     = new Uint8Array(8);
                    [...bin].forEach((c,i)=>buf[i]    = c.charCodeAt(0));
                    var ip      = Array.from(buf.slice(0,4)).join('.');
                    var mask    = Array.from(buf.slice(4,8)).join('.');
                    return `${ip}/${mask}`;
                    
              }//decode_ip
              
              
              function general_name_type(type){
              
                    switch(type){
                    
                      case 0    : return 'otherName';
                      case 1    : return 'email';
                      case 2    : return 'dns';
                      case 3    : return 'x.400';
                      case 4    : return 'dir';   //directoryName dn
                      case 5    : return 'edi';   //edi party name
                      case 6    : return 'url';
                      case 7    : return 'ip';
                      case 8    : return 'oid';
                      
                    }//switch
                    
              }//general_name_type
              
              
              
              
              
              meta.list.replaceChildren();
              
              if(cert){
                    var nfield    = meta.field.cloneNode(true);
                    $(nfield,'.category-field-name').textContent    = 'Version';
                    $(nfield,'.category-field-value').textContent   = cert.version;
                    meta.list.append(nfield);
                    
                    var nfield    = meta.field.cloneNode(true);
                    $(nfield,'.category-field-name').textContent    = 'Serial Number';
                    $(nfield,'.category-field-value').textContent   = cert.serialNumber.toUpperCase();
                    meta.list.append(nfield);
              }
              
              
              publickey.list.replaceChildren();
              
              if(cert){
                    var nfield    = publickey.field.cloneNode(true);
                    if(cert.publicKey.n){
                          $(nfield,'.category-field-name').textContent    = 'Key Size';
                          $(nfield,'.category-field-value').textContent   = cert.publicKey.n.bitLength()+' bits';
                    }
                    if(cert.publicKey.curve){
                          $(nfield,'.category-field-name').textContent    = 'Curve';
                          $(nfield,'.category-field-value').textContent   = cert.publicKey.curve;
                    }
                    publickey.list.append(nfield);
                    
                    
                    var nfield    = publickey.field.cloneNode(true);
                    $(nfield,'.category-field-name').textContent    = 'Subject Key Identifier';
                    var ski   = cert.extensions.find(ext=>ext.name==='subjectKeyIdentifier');
                    var str   = 'not present';
                    if(ski){
                          str   = nodeforge.util.bytesToHex(ski.subjectKeyIdentifier);
                    }
                    $(nfield,'.category-field-value').textContent   =  str;
                    publickey.list.append(nfield);
              }
              
              
              authoritykey.list.replaceChildren();
              
              if(cert){
                    var oid   = cert.siginfo.algorithmOid;
                    var alg   = nodeforge.pki.oids[oid];
                    var nfield    = publickey.field.cloneNode(true);
                    $(nfield,'.category-field-name').textContent    = 'Key Algorithm';
                    $(nfield,'.category-field-value').textContent   = alg;
                    authoritykey.list.append(nfield);
                    
                    var nfield    = authoritykey.field.cloneNode(true);
                    $(nfield,'.category-field-name').textContent    = 'Key Identifier';
                    var value   = 'not present'
                    var aki   = cert.extensions.find(ext=>ext.name==='authorityKeyIdentifier');
                    if(aki){
                          value ||= aki.keyIdentifier;
                    }
                    $(nfield,'.category-field-value').textContent   = value;
                    authoritykey.list.append(nfield);
                    
                    var nfield    = authoritykey.field.cloneNode(true);
                    $(nfield,'.category-field-name').textContent    = 'Authority Issuer';
                    var value   = 'not present';
                    if(aki){
                          value   ||= aki.authorityCertIssuer;
                    }
                    $(nfield,'.category-field-value').textContent   = value;
                    authoritykey.list.append(nfield);
                    
                    var nfield    = authoritykey.field.cloneNode(true);
                    $(nfield,'.category-field-name').textContent    = 'Authority Issuer Serial';
                    var value   = 'not present';
                    if(aki){
                          value   ||= aki.authorityCertSerialNumber;
                    }
                    $(nfield,'.category-field-value').textContent   = value;
                    authoritykey.list.append(nfield);
              }
              
              
              signature.list.replaceChildren();
              
              if(cert){
                    var nfield    = signature.field.cloneNode(true);
                    $(nfield,'.category-field-name').textContent    = 'Signature';
                    
                    var bytes   = cert.signature;
                    var hex     = nodeforge.util.bytesToHex(bytes).toUpperCase();
                    
                    $(nfield,'.category-field-value').textContent   = hex;
                    signature.list.append(nfield);
              }
              
              
              $('#pem').style.display   = 'inline-block';
              var str   = '';
              if(pem){
                    str   = pem;
              }
              $('#pem').textContent     = str;
              
              
              
              return;
              
              
              
              
              
              
              view.replaceChildren();
              
              
              //var extensions    = cert.extensions;
              
              
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'version';
              $(nfield,'.field-value').textContent    = cert.version;
              view.append(nfield);
              
              
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'serialNumber';
              $(nfield,'.field-value').textContent    = cert.serialNumber;
              view.append(nfield);
              
              
              var ca    = extensions.find(ext=>('cA' in ext));
              var nfield    = field.cloneNode(true);
              nfield.style.cssText    = 'margin-top:20px';
              $(nfield,'.field-name').textContent   = 'CA';
              $(nfield,'.field-value').textContent    = ca.cA;
              view.append(nfield);
              
              
              
              
              
              
              
              
              var nfield    = field.cloneNode(true);
              nfield.style.cssText    = 'margin-top:20px';
              $(nfield,'.field-name').textContent   = 'subjectAltName';
              var attr    = extensions.find(attr=>attr.name==='subjectAltName');
              var str     = []
              attr.altNames.forEach(attr=>{
              
                    switch(attr.type){
                    
                      case 2    : str.push(attr.value);       break;
                      case 7    : str.push(attr.ip);          break;
                      
                    }//switch
                    
              });
              str   = str.join(', ');
              $(nfield,'.field-value').textContent    = str;
              view.append(nfield);
              
              var ext   = props.ext;
              for(var key in ext){
              
                    var attr    = extensions.find(attr=>attr.name===key);
                    
                    var nfield    = field.cloneNode(true);
                    nfield.style.cssText    = 'margin-top:20px';
                    $(nfield,'.field-name').textContent   = key;
                    
                    var str   = [];
                    var list    = ext[key];
                    list.forEach(name=>{
                    
                          if(attr[name]){
                                str.push(name);
                                
                          }
                          
                    });
                    
                    str   = str.join(', ');
                    $(nfield,'.field-value').textContent    = str;
                    
                    view.append(nfield);
                    
              }//for
              
              
              /*
              
              var b64   = window.btoa(cert.signature);
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'signature';
              $(nfield,'.field-value').textContent    = b64;
              $(nfield,'.field-value').style.flexWrap   = 'wrap';
              view.append(nfield);
              
              */
              
              
              
              
              
        }//display
        
        
        create.field    = function(name,value){
        }//field
        
        create.field.sub    = function(name,value){
        }//sub
        
        
        
        
        async function load(){
        
              await Promise.all([load.ext(),load.nodeforge()]);
              
        }//load
        
        
        load.ext    = async function(){
        
              var res   = await fetch('https://raw.githubusercontent.com/javascript-2020/ext-code/main/ext-loader.js')
              var txt   = await res.text();
              ext       = eval(txt);
              [$,datatype,menumod,keydown]   = await ext.load.libs(
                    'js/dom/$.js',
                    'js/core/datatype.js',
                    'js/dom/menumod/menumod.js',
                    'js/dom/keydown/keydown.js'
              );
              
        }//ext
        
        
        load.nodeforge    = async function(){
        
              var txt         = localStorage['node-forge'];
              if(!txt){
                    var url   = 'https://cdn.jsdelivr.net/npm/node-forge/+esm';
                                                                                //console.log(url);
                    var res   = await fetch(url);
                    txt       = await res.text();
                    localStorage['node-forge']    = txt;
              }
              
              var blob        = new Blob([txt],{type:'text/javascript'});
              var url         = window.URL.createObjectURL(blob);
              nodeforge       = await import(url);
              nodeforge       = nodeforge.default;
              //pki             = nodeforge.pki;
              
        }//nodeforge
        
        
        load.cert   = function(import_cert){
        
              var resolve,promise=new Promise(res=>resolve=res);
              
              var input         = document.createElement('input');
              input.type        = 'file';
              input.onchange    = onchange;
              input.click();
              
              return promise;
              
              
              async function onchange(){
              
                    file        = input.files[0].name;
                    var blob    = input.files[0];
                    
                    if(await is.pem(blob)){
                          pem   = await blob.text();
                    }else{
                          pem   = await der_pem(blob);
                          if(!pem){
                                return;
                          }
                    }
                    
                    
                    var err;
                    try{
                    
                          cert    = nodeforge.pki.certificateFromPem(pem);
                          
                    }//try
                    catch(err2){
                    
                          err   = err2;
                          
                    }
                    if(err){
                          var error   = err.toString();
                          log.red(error);
                          return;
                    }
                    
                    
                    history.save();
                    resolve();
                    
                    
              }//onchange
              
        }//cert
        
        
        
        var is={};
        
        is.pem    = async function(blob){
        
              var txt   = await blob.text();
              if(txt.startsWith('---')){
                    return true;
              }
              return false;
              
        }//pem
        
        
        async function der_pem(blob){
        
              var buf     = await blob.arrayBuffer();
              var uint8   = new Uint8Array(buf);
              var bin     = String.fromCharCode(...uint8);
              var bytes   = nodeforge.util.createBuffer(bin,'binary');
              
              var err;
              try{
              
                    var asn1    = nodeforge.asn1.fromDer(bytes);
                    var cert    = nodeforge.pki.certificateFromAsn1(asn1);
                    var pem     = nodeforge.pki.certificateToPem(cert);
                    
              }//try
              catch(err2){
              
                    err   = err2;
                    
              }//catch
              if(err){
                    var error   = err.toString();
                    log.red(error);
                    return;
              }
              
              return pem;
              
        }//der_pem
        
        
        function pem_der(pem){
        
              var cert        = forge.pki.certificateFromPem(pem);
              var asn1        = forge.pki.certificateToAsn1(cert);
              var bin         = forge.asn1.toDer(asn1).getBytes();
              var bytes       = [...bin].map(c=>c.charCodeAt(0));
              var buf         = new Uint8Array(bytes);
              var blob        = new Blob([buf],{type:'application/pkix-cert'});
              return blob;
              
              
//application/x-x509-ca-cert
//application/x-pem-file


        }//pem_def
        
        
  //:
  
  
        history.delete    = function(){
        
              delete localStorage[store];
              
        }//delete
        
        
        history.load    = function(){
        
              var txt   = localStorage[store];
              if(!txt){
                    return;
              }
              var json      = JSON.parse(txt);
              ({file,pem}   = json);
              cert          = nodeforge.pki.certificateFromPem(pem);
              return true;
              
        }//load
        
        
        history.save    = function(){
        
              var txt               = JSON.stringify({file,pem});
              localStorage[store]   = txt;
              
        }//save
        
        
        
        
        
      </script>
      
</html>


<!--



/*

const forge = require('node-forge');
const fs = require('fs');

const pem = fs.readFileSync('cert.pem', 'utf8');
const cert = forge.pki.certificateFromPem(pem);

const nameConstraintsExt = cert.extensions.find(ext => ext.name === 'nameConstraints');

if (!nameConstraintsExt) {
  console.log('No nameConstraints extension found.');
  return;
}


const asn1 = forge.asn1.fromDer(nameConstraintsExt.value);

// This is a SEQUENCE of permitted and excluded subtrees
const [permittedNode, excludedNode] = asn1.value;

// Helper to extract DNS names from subtree
function extractDNSNames(subtreeNode) {
  const names = [];
  const sequence = subtreeNode.value[0]; // SEQUENCE of GeneralSubtree
  for (const generalSubtree of sequence.value) {
    const generalName = generalSubtree.value[0]; // GeneralName
    if (generalName.type === 2) { // dNSName
      names.push(forge.util.decodeUtf8(generalName.value));
    }
  }
  return names;
}

const permitted = permittedNode ? extractDNSNames(permittedNode) : [];
const excluded = excludedNode ? extractDNSNames(excludedNode) : [];

console.log('Permitted DNS:', permitted);
console.log('Excluded DNS:', excluded);


*/



-->













