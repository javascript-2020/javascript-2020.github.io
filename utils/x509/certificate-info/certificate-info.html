

<!--


see bottom for name constraints


-->




<html>

      <head>

            <title>x509 certificate info</title>
            <meta name=description content='view x509 certificate information'>
            
            <base href='https://javascript-2020.github.io/utils/x509/certificate-info/certificate-info.html'>
            <link rel=canonical href='https://ext-code.com/utils/x509/certificate-info/certificate-info.html'>
            
            <meta name=viewport content='width=device-width, initial-scale=1'>
            <link rel='shortcut icon' type='image/x-icon' href='../images/x509-30.png'>


            <script type='application/ld+json'>
                  {
                        "@context"              : "https://schema.org",
                        "@type"                 : "SoftwareApplication",
                        "name"                  : "certificate info",
                        "url"                   : "https://ext-code.com/utils/x509/certificate-info/certificate-info.html",
                        "author"                : {"@type":"Person","name":"Matthew Richards"},
                        "description"           : "display information about x509 certificate and some utility functions",
                        "applicationCategory"   : "DeveloperApplication",
                        "operatingSystem"       : "All",
                        "browserRequirements"   : "Requires JavaScript-enabled browser",
                        "softwareVersion"       : "1.0.0",
                        "offers"                : {"@type":"Offer","price":"0","priceCurrency":"GBP"}
                  }
            </script>

    
    
            <script init>
                                                                                console.clear();
                                                                                console.log('certificate-info');
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
                                                                                
        var version       = 'v1.0';
            
        var df            = true;
        var debug_id      = 'certificate-info';
        
        var ext;
        var $;
        var datatype;
        var menumod;
        var keydown;


        var menu;
        
        
        var mod           = {};
        
        
        var log;
        var hdr;
            
        
        async function init(){
        
        
              menu                      = mod.menumod();
              log                       = mod.log();
              hdr                       = mod['x509-hdr']();

              
              menu.initmod({});
              log.initmod({ext,$});
              hdr.initmod({menu});


              await log.init();
              await hdr.init()



        
              //history.delete();
              
              
              await load();
              
              
              initdom(document.body);              
        
        
              
        }//init


        init.stack            = [];
        init.stack.ct         = 0;
        init.stack.total      = 1;
        init.stack.mode       = '';
        init.stack.complete   = false;
        Object.defineProperty(init.stack,'add',{get:()=>{
              init.stack.total++;
              console.log('add',init.stack.ct,init.stack.total);
              init.stack.mode && console[init.stack.mode]('add',init.stack.ct,init.stack.total);
        }});
        Object.defineProperty(init.stack,'complete',{get:()=>{
              init.stack.ct++;
              console.log('complete',init.stack.ct,init.stack.total);
              init.stack.mode && console[init.stack.mode]('complete',init.stack.ct,init.stack.total);
              init.stack.ct>=init.stack.total && init();
        }});
        
        //  (typeof init!='undefined' && init?.stack && init.stack.add)
        //  (typeof init!='undefined' && init?.stack && init.stack.complete)

        
        init.complete   = function(){
          
              init.complete.stack.forEach(fn=>fn());
              
        }//complete
        
        init.complete.stack   = [];
        init.complete.add     = fn=>init.complete.stack.push(fn);
                  

(async()=>{
  
        init.stack.add;
        

        var url;
        var headers;
        var token       = localStorage['github-token'];
        if(token){
              url       = 'https://api.github.com/repos/javascript-2020/ext-code/contents/ext-loader.js';
              headers   = {accept:'application/vnd.github.raw',authorization:`bearer ${token}`};
        }else{
              url       = 'https://raw.githubusercontent.com/javascript-2020/ext-code/main/ext-loader.js';
        }
        
        var res   = await fetch(url,{headers});
        var txt   = await res.text();

        if(res.headers.get('content-type').includes('json')){
                                                                                console.log('*** ext : json');
              var json    = JSON.parse(txt);
              var b64     = json.content;
              txt         = atob(b64);
        }else{
                                                                                console.log('*** ext : text');
        }
        
        ext   = eval(txt);
              
              
        var promise   = ext.load.libs(
              'js/dom/$.js.api',
              'js/core/datatype.js',
              'js/dom/menumod/menumod.js',
              'js/dom/keydown/keydown.js',
              'js/debug/debug.js.api',
        );
        [$,datatype,menumod,keydown,debug]   = await promise;


        init.stack.complete;

})();
        
            
            </script>
    
            <style>
        
  html
    {height:100%}
    
  body
    {height:calc(100% - 42px);margin:20px;display:flex;flex-direction:column;font-family:arial}

  html
    {--col1:200px}


  #center-hldr
    {position:relative}
  #center
    {width:1200px;position:absolute;margin:auto;left:0;right:0}

    
  .hdr                  
    {font-family:arial;position:relative;margin-top:0;margin-bottom:20px;background:white;
      padding-bottom:10px;border-bottom:3px solid lightblue
    }
    
  .hdr-icon             
    {display:inline-block;text-align:center;background:whitesmoke;border-radius:5px;
      border:1px solid lightgray;padding:5px 3px 0px;cursor:pointer;margin-right:10px;
      min-width:50px
    }
    
  .hdr-icon-img         
    {width:25px;height:25px}
    
  .hdr-icon-label       
    {margin:2px 0 0}
    
  .hdr-title            
    {position:absolute;left:0;right:0;z-index:0;margin:0 auto}
    
  .hdr-date
    {float:right}


    
  #btns
    {margin:20px 0}


  #info
    {display:flex;flex-direction:column;gap:20px}
    
  #filename-root
    {border:1px solid lightgray;padding:10px 10px;border-radius:5px;font-weight:bold;background:lightyellow}
  #filename
    {margin-left:20px}

  #dn-root
    {display:flex;gap:50px;align-items:start}
    
  #subject
    {border-color:lightblue}
  #subject .dn-title
    {background:blue}
  #subject .dn-field:nth-child(even)
    {background:hsl(200,100%,98%)}
    
  #issuer
    {border-color:lightgreen}
  #issuer .dn-title
    {background:green}
  #issuer .dn-field:nth-child(even)
    {background:hsl(120,100%,98%)}
    
  .dn
    {flex:1;border:1px solid;border-radius:5px;padding:10px}
    
  .dn-title
    {font-weight:bold;color:white;text-align:center;padding:5px 10px;margin-bottom:10px}
    
  .dn-view
    {}
    
  .dn-field
    {display:flex;gap:40px;padding:10px 10px}

  .dn-field:nth-child(even)
    {background:whitesmoke}


  .dn-field-name
    {width:200px;text-align:right}
    
  .dn-field-value
    {flex:1;font-weight:bold}


  #keyUsage
    {border-color:orange}
  #keyUsage .extension-title
    {background:orange}
  #keyUsage .extension-field-value:nth-child(even)
    {background:hsl(30,100%,98%)}
    
  #extKeyUsage
    {border-color:purple}
  #extKeyUsage .extension-title
    {background:purple}
  #extKeyUsage .extension-field-value:nth-child(even)
    {background:hsl(270,100%,98%)}

  #extensions-root
    {display:flex;gap:50px}
  .extension
    {flex:1;border:1px solid lightgray;border-radius:5px;padding:10px}
  .extension-title
    {font-weight:bold;color:white;text-align:center;padding:5px 10px;margin-bottom:10px}
  .extension-field-value
    {padding:10px 10px;text-align:center;font-weight:bold}



  
  #dns
    {border-color:hsl(340,100%,85%)}
  #dns .san-title
    {background:hsl(340,100%,85%)}
  #dns .san-value:nth-child(even)
    {background:hsl(340,100%,98%)}

  #ip
    {border-color:hsl(210,100%,85%)}
  #ip .san-title
    {background:hsl(210,100%,85%)}
  #ip .san-value:nth-child(even)
    {background:hsl(210,100%,98%)}

  #email
    {border-color:hsl(150,100%,85%)}
  #email .san-title
    {background:hsl(150,100%,85%)}
  #email .san-value:nth-child(even)
    {background:hsl(150,100%,98%)}

  #url
    {border-color:hsl(270,100%,90%)}
  #url .san-title
    {background:hsl(270,100%,90%)}
  #url .san-value:nth-child(even)
    {background:hsl(270,100%,98%)}

  #dir
    {border-color:hsl(30,100%,85%)}
  #dir .san-title
    {background:hsl(30,100%,85%)}
  #dir .san-value:nth-child(even)
    {background:hsl(30,100%,98%)}

  #oid
    {border-color:hsl(50,100%,85%)}
  #oid .san-title
    {background:hsl(50,100%,85%)}
  #oid .san-value:nth-child(even)
    {background:hsl(50,100%,98%)}
    
    
  #san-root
    {display:flex;justify-content:space-between;gap:20px;align-items:start}
  .san
    {flex:1;border:1px solid lightgray;border-radius:5px;padding:10px}
  .san-title
    {font-weight:bold;color:gray;text-align:center;padding:5px 10px;margin-bottom:10px}
  .san-value
    {padding:10px 10px;text-align:center;font-weight:bold}
    
    

  .category
    {margin-left:50px}
  .category-title
    /*{background:lightgray;text-align:center;margin-bottom:10px;padding:5px}*/
    {margin-bottom:10px;color:blue;font-weight:bold}
  .category-view
    {}
  .category-field
    {display:flex;gap:40px;padding:10px;padding-left:30px}
  .category-field-name
    {width:var(--col1)}
  .category-field-value
    {flex:1;font-weight:bold;word-break:break-all;font-family:monospace;font-size:20px}
    

  #thumbprint
    {}
  #thumbprint-title
    {}
  #thumbprint-view
    {}
  .thumbprint-field
    {}
  .thumbprint-field-name
    {}
  .thumbprint-field-value
    {}


  #dates
    {}
  #dates-title
    {}  
  #dates-view
    {display:flex;align-items:center}
  #dates-list
    {flex:1}
  .date-root
    {display:flex}
  .date-label
    {}
  .date-simple
    {}
  .date-full
    {flex:1}    
  #dates-valid
    {margin-right:20px}
  .dates-valid
    {content:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAAXVBMVEVHcEwa13Mb1XQc1XQpynsd03Uwv3oa13Mnynce03UlzHYd1HYg0XYc1XQh0XYd03Qe1HUg0XYc1HQf0HUd1XUd0XMfz3UZ13Pn5ucp2Hxo3Z+O4LXa5uC85M9H243zMKCpAAAAF3RSTlMA+NPWD40F/Bx9IJ5d716ho1/tW/BcW3mRwfMAAADcSURBVCjPjZNXFoQgDEVDsPcyM7Gy/2UOCBZQj74fyoUkJwVgVVRU/BOGOVZ1Aq6SGBkZMYztB0HByRIvgp16PiNHzPc2mtKFUsMDny7la/s1u8asXmLmdCOu4o/pVrHMBp6vh16vGEFx8tyP06g5y6A6066bhN6XgFd0MAeE3OyENmhRyiE0n+Zu7l1K4YrF3CluU4k344o7lJo9NMUdKkMr6chtSilkW1p6MTuUtVZShU1VUh9K8lTQg3enHbI3zfTQik+NLO1nTl3xG7wfomUE2xIbNYLlL9ou/yNmPb9gPGs5AAAAAElFTkSuQmCC')}
  .dates-invalid
    {content:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAANlBMVEVHcEzvU1v1SlH2SVDMsrbqXGPlaW/rWl/0TFPzTVPyTlXrV1/zTlT0S1LvVVvuU1nxU1r3SE+VlM7ZAAAAEXRSTlMAbPP6AiEML9TKrEG55lp7jd7fFusAAAC6SURBVCjPhZPbFoQgCEVBSss7//+zoyZdZprFeWnl9gAqAJyyLpdaS3YWfrViTMRNlCKuX9Dixjdt+IiweuKHyN8CuJ1/tLvT+0Ibn37r+VX+yI/0jglHaKnZzG1kpP4eHuUn4Fg3GMTQ7DZOb4Clc4MLhOmPFlySTEvnZnxmmuQgS2EHODZJcRnKWWnnTRdlLlD5xsc5L8pVw0pwpTTlYMq1KJeqPYnyoFo7KM2ktaLWyNoYaEP0bwQ/OJUj5UwLjAIAAAAASUVORK5CYII=')}









  #signature
    {}
  #signature-field
    {}
  #signature-field-name
    {}
  #signature-field-value
    {}
    
    
  #view
    {margin-bottom:20px}


  .view-category
    {margin-top:20px}
    
  .view-field
    {display:flex;margin-top:10px}
    
  .view-field-name
    {display:inline-block;width:200px}
    
  .view-field-value
    {flex:1}


  #pem-root
    {display:flex;justify-content:center}
  #pem
    {border:1px solid lightgray;padding:10px;display:none}
                          

  #ftr
    {height:100px}
    
    
  input
    {padding:5px 10px;font-size:16px}

                          
            </style>
        
      </head>
  
      <body>
   
            <div id=center-hldr>
            
                  <div id=center>

                  
                        <x509-hdr-grp api>
                              <script src='https://html-loader-1024713184986.us-central1.run.app/'></script>
                              <img class=title src='images/certificate-info.png' style='top:5px;height:55px'>
                              <span slot=date>28 Sep 2025</span>
                        </x509-hdr-grp>

      
                        <div id=btns>
                              <input value=load type=button>
                              <input value=paste type=button>
                              <input value=copy type=button>
                        </div>
      
                  
                        <div id=info>
            
            
            <!--            
                              <div id=category class=category>
                              
                                    <div class=category-title>
                                    </div>
                                    
                                    <div class=category-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                          
                              </div>
            -->                  
            
                        
                              <div id=filename-root>
                                    <span>
                                          file :
                                    </span>
                                    <span id=filename>
                                    </span>
                              </div>
                  
                          
                              <div id=dn-root>
                              
                                    <div id=subject class=dn>
                                    
                                          <div class=dn-title>
                                                Subject
                                          </div>
                                          
                                          <div class=dn-view>
                                                <div class=dn-field>
                                                      <div class=dn-field-name></div>
                                                      <div class=dn-field-value></div>
                                                </div>
                                          </div>
                                          
                                    </div>
                        
                        
                                    <div id=issuer class=dn>
                                    
                                          <div class=dn-title>
                                                Issuer
                                          </div>
                                          
                                          <div class=dn-view>
                                          </div>
                                          
                                    </div>
                                    
                              </div>
                          
                          
                              <div id=thumbprint class=category>
                              
                                    <div id=thumbprint-title class=category-title>
                                          Certificate Hash / ThumbPrint
                                    </div>
                                    <div id=thumbprint-view class=category-view>
                                          <div class='thumbprint-field category-field'>
                                                <div class='thumbprint-field-name category-field-name'></div>
                                                <div class='thumbprint-field-value category-field-value'></div>
                                          </div>
                                    </div>
                                    
                              </div>
                  
                  
                              <div id=dates class=category>
                              
                                    <div id=dates-title class=category-title>
                                          Dates
                                    </div>
                                    
                                    <div id=dates-view>
                                          <div id=dates-list>
                                                <div class='date-root category-field'>
                                                      <div class='date-label category-field-name'>
                                                            not before
                                                      </div>
                                                      <div class='date-full category-field-value'>
                                                      </div>
                                                </div>
                                          </div>
                                          
                                          <div>
                                                <img id=dates-valid>
                                          </div>
                                    </div>
                                    
                              </div>
                  
            
                              <div id=extensions-root>
                              
                                    <div class=extension>
                                    
                                          <div class=extension-title>
                                          </div>
                                          
                                          <div class=extension-list>
                                                <div class=extension-field-value></div>
                                          </div>
                                          
                                    </div>
                                    
                              </div>
            
            
                              <div id=san-root>
                              
                                    <div class=san>
                                    
                                          <div class=san-title>
                                          </div>
                                          
                                          <div class=san-list>
                                                <div class=san-value></div>
                                          </div>
                                          
                                    </div>
                                    
                              </div>
            
            
                              <div id=constraints class=category>
                              
                                    <div class=category-title>
                                          Basic Constraints
                                    </div>
                                    
                                    <div id=constraints-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                          
                              </div>
            
            
                              <div id=meta class=category>
                              
                                    <div class=category-title>
                                          Certificate Meta Data
                                    </div>
                                    
                                    <div id=meta-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                          
                              </div>
            
            
                              <div id=public-key class=category>
                              
                                    <div class=category-title>
                                          Public Key
                                    </div>
                                    
                                    <div id=public-key-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                          
                              </div>
            
            
                              <div id=authority-key class=category>
                              
                                    <div class=category-title>
                                          Authority Key Identifier
                                    </div>
                                    
                                    <div id=authority-key-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                          
                              </div>
                  
            
                              <div id=signature class=category>
                              
                                    <div class=category-title>
                                          Signature
                                    </div>
                                    
                                    <div id=signature-list>
                                    
                                          <div class=category-field>
                                                <div class=category-field-name>
                                                </div>
                                                <div class=category-field-value>
                                                </div>
                                          </div>
                                          
                                    </div>
                                          
                              </div>
            
            
            
                                    
                              
                              <div id=view>
                              
                                    <div class=view-category>
                                          <div class=view-label></div>
                                    </div category>
                                    
                                    <div class=view-field>
                                          <span class=view-field-name>commonName</span>
                                          <span class=view-field-value></span>
                                    </div>
                                    
                              </div view>
                              
                  
                  
                              <div id=pem-root>
                                    <pre id=pem></pre>
                              </div>
                              
                        </div>
            
                  </div center>

            </div center-hldr>            

            <log api>
                  <script src='https://html-loader-1024713184986.us-central1.run.app/'></script>
            </log>



            <div id=ftr>
            </div>
        
      </body>
    
      <script>

                                                                                
        
        
        var nodeforge;

        var store   = 'certificate-info';
        
        var file;
        var cert;
        var pem;

        var view;
        
        
        
        var props               = {};
        props.issuer            = [ 'commonName','OrganizationalUnit','Organization','Locality',
                                    'StateOrProvinceName','CountryName'
                                  ];
        props.subject           = [ 'commonName','OrganizationalUnit','Organization','Locality',
                                    'StateOrProvinceName','CountryName'
                                  ];
        
        props.ext               = {};                  
        props.ext.keyUsage      = ['keyCertSign','digitalSignature','nonRepudiation','keyEncipherment','dataEncipherment'];
        props.ext.extKeyUsage   = ['serverAuth','clientAuth','codeSigning','emailProtection','timeStamping'];
        
        props.ext.nsCertType    = ['client','server','email','objSign','sslCA','emailCA','objCA'];


        var history             = {};
        var btn                 = {};
        



  //:
  

        var category        = {};

  
        var subject         = {};
        var issuer          = {};
        var dn              = {};
        var thumbprint      = {};
        var dates           = {};
        dates.notbefore     = {};
        dates.notafter      = {};
        var extensions      = {};
        var san             = {};
        var constraints     = {};
        var meta            = {};
        var publickey       = {};
        var authoritykey    = {};
        var signature       = {};

        
        
        
        
        
        var view            = {};
        
        
        
        var create    = {};
        
        
        
        function initdom(rootnode){



          
          
              var btns                              = $('#btns');
              
              $('[value=load]').onclick             = btn.load;
              $('[value=paste]').onclick            = btn.paste;
              $('[value=copy]').onclick             = btn.copy;

        
              subject.root                          = $('#subject');
              subject.view                          = $(subject.root,'.dn-view');
              dn.field                              = $(subject.view,'.dn-field');
              issuer.root                           = $('#issuer');
              issuer.view                           = $(issuer.root,'.dn-view');

              
              thumbprint.root                       = $('#thumbprint');
              thumbprint.view                       = $(thumbprint.root,'#thumbprint-view');
              thumbprint.field                      = $(thumbprint.root,'.thumbprint-field');
              

              dates.root                            = $('#dates');
              dates.list                            = $(dates.root,'#dates-list');
              dates.date                            = $(dates.root,'.date-root');
              dates.valid                           = $(dates.root,'#dates-valid');
              
              
              extensions.root                       = $('#extensions-root');
              extensions.extension                  = $(extensions.root,'.extension');
              extensions.value                      = $(extensions.extension,'.extension-field-value');
              extensions.value.remove();
              
              
              san.root                              = $('#san-root');
              san.san                               = $(san.root,'.san');
              san.value                             = $(san.san,'.san-value');
              san.value.remove();
              

              constraints.root                      = $('#constraints');
              constraints.list                      = $(constraints.root,'#constraints-list');
              constraints.field                     = $(constraints.list,'.category-field');
              

              meta.root                             = $('#meta');
              meta.list                             = $(meta.root,'#meta-list');
              meta.field                            = $(meta.list,'.category-field');
              
              
              publickey.root                        = $('#public-key');
              publickey.list                        = $(publickey.root,'#public-key-list');
              publickey.field                       = $(publickey.root,'.category-field');
              
              
              authoritykey.root                     = $('#authority-key');
              authoritykey.list                     = $(authoritykey.root,'#authority-key-list');
              authoritykey.field                    = $(authoritykey.list,'.category-field');
              
              
              signature.root                        = $('#signature');
              signature.list                        = $(signature.root,'#signature-list');
              signature.field                       = $(signature.list,'.category-field');



              
              view.root                             = $('#view');
              
              view.category                         = $('.view-category');
              view.category.remove();
              
              view.field                            = $('.view-field');
              view.field.remove();
              


              
              if(history.load()){
                    display();
              }
                          




              log.initdom(rootnode);
              hdr.initdom(rootnode);


              
        }//initdom


  //:
  
  
        btn.load    = async function(){
          
              await load.cert(true);
              display();
              
        }//load
        
        
        btn.paste   = async function(){
          
              pem     = await navigator.clipboard.readText();
              cert    = nodeforge.pki.certificateFromPem(pem);
              history.save();
              
        }//paste
        
        
        btn.copy    = async function(){
          
              await navigator.clipboard.writeText(pem);
                                                                                console.log('copied');
        }//copy

        
  //:
  
  
        function display(){
          

              
              //console.log(nodeforge.pki);
              //console.json(cert);
              
              
              $('#filename').textContent    = file;



              subject.view.replaceChildren();
              
              props.subject.forEach(name=>{
                
                    var attr    = cert.subject.attributes.find(attr=>attr.name===name);
                    if(!attr){
                          return;
                    }
                    var value     = attr.value;
                    var nfield    = dn.field.cloneNode(true);
                    $(nfield,'.dn-field-name').textContent       = name;
                    $(nfield,'.dn-field-value').textContent      = value;
                    subject.view.append(nfield);
                    
              });


              issuer.view.replaceChildren();
              
              props.issuer.forEach(name=>{
                
                    var attr    = cert.issuer.attributes.find(attr=>attr.name===name);
                    if(!attr){
                          return;
                    }
                    var value     = attr.value;
                    var nfield    = dn.field.cloneNode(true);
                    $(nfield,'.dn-field-name').textContent       = name;
                    $(nfield,'.dn-field-value').textContent      = value;
                    issuer.view.append(nfield);
                    
              });
              
              
              thumbprint.view.replaceChildren();
              
              var asn1      = nodeforge.pki.certificateToAsn1(cert);
              var der       = nodeforge.asn1.toDer(asn1).getBytes();
              var format    = hex=>hex.match(/.{2}/g).join(':').toUpperCase();

              var sha1      = nodeforge.md.sha1.create().update(der).digest().toHex();
              var nfield    = thumbprint.field.cloneNode(true);
              $(nfield,'.thumbprint-field-name').textContent     = 'sha-1';
              $(nfield,'.thumbprint-field-value').textContent    = format(sha1);
              thumbprint.view.append(nfield);
              
              var sha256    = nodeforge.md.sha256.create().update(der).digest().toHex();
              var nfield    = thumbprint.field.cloneNode(true);
              $(nfield,'.thumbprint-field-name').textContent     = 'sha-256';
              $(nfield,'.thumbprint-field-value').textContent    = format(sha256);
              thumbprint.view.append(nfield);

              
              dates.list.replaceChildren();
              
              var ndate   = dates.date.cloneNode(true);
              $(ndate,'.date-label').textContent    = 'Not Before';
              $(ndate,'.date-full').textContent     = cert.validity.notBefore;
              dates.list.append(ndate);

              var ndate   = dates.date.cloneNode(true);
              $(ndate,'.date-label').textContent   = 'Not After';
              $(ndate,'.date-full').textContent    = cert.validity.notAfter;
              dates.list.append(ndate);

              var today   = new Date();
              var valid   = (cert.validity.notBefore<today) && (today<cert.validity.notAfter);
              if(valid){
                    dates.valid.className   = 'dates-valid';
              }else{
                    dates.valid.className   = 'dates-invalid';
              }

              
              extensions.root.replaceChildren();
              
              ['keyUsage','extKeyUsage'].forEach(key=>{
              
                    var nextension    = extensions.extension.cloneNode(true);
                    nextension.id     = key;
                    $(nextension,'.extension-title').textContent    = key;
                    var list      = $(nextension,'.extension-list');
                    var attr      = cert.extensions.find(attr=>attr.name===key);
                    var values    = props.ext[key].filter(name=>attr[name]);
                    values.forEach(value=>{
                    
                          var nvalue   = extensions.value.cloneNode(true);
                          nvalue.textContent    = value;
                          list.append(nvalue);
                          
                    });
                    extensions.root.append(nextension);
                    
              });
                                            
              
              san.root.replaceChildren();
              
              var attr    = cert.extensions.find(attr=>attr.name==='subjectAltName');
              [{v:2,name:'dns'},{v:7,name:'ip'},{v:1,name:'email'},{v:6,name:'url'},{v:4,name:'dir'},{v:8,name:'oid'}].forEach(desc=>{
              
                    var nsan    = san.san.cloneNode(true);
                    nsan.id     = desc.name;
                    $(nsan,'.san-title').textContent    = desc.name;                    
                    var list    = $(nsan,'.san-list');
                    var ct      = 0;
                    attr.altNames.forEach(attr=>{
                    
                          if(attr.type!=desc.v)return;
                          ct++;
                          var nvalue    = san.value.cloneNode(true);
                          var str;
                          switch(attr.type){
                          
                            case 2    : str   = attr.value;       break;
                            case 7    : str   = attr.ip;          break;
                              
                          }//switch
                          
                          nvalue.textContent    = str;
                          list.append(nvalue);
                          
                    });
                    
                    if(ct){
                          san.root.append(nsan);
                    }
                    
              });


              constraints.list.replaceChildren();
              
              var ca    = cert.extensions.find(ext=>ext.name=='basicConstraints');

              var nconstraint   = constraints.field.cloneNode(true);
              $(nconstraint,'.category-field-name').textContent     = 'CA';
              $(nconstraint,'.category-field-value').textContent    = ca.cA;
              constraints.list.append(nconstraint);

              if(ca.cA){              
                    var value   = 'no limit';
                    if('pathLenConstraint' in ca){
                          value   = ca.pathLenConstraint;
                    }
                    var nconstraint   = constraints.field.cloneNode(true);
                    $(nconstraint,'.category-field-name').textContent     = 'pathlen';
                    $(nconstraint,'.category-field-value').textContent    = value
                    constraints.list.append(nconstraint);
              }
              


              meta.list.replaceChildren();
              
              var nfield    = meta.field.cloneNode(true);
              $(nfield,'.category-field-name').textContent    = 'Version';
              $(nfield,'.category-field-value').textContent   = cert.version;
              meta.list.append(nfield);
              
              var nfield    = meta.field.cloneNode(true);
              $(nfield,'.category-field-name').textContent    = 'Serial Number';
              $(nfield,'.category-field-value').textContent   = cert.serialNumber;
              meta.list.append(nfield);
              

              publickey.list.replaceChildren();
              
              var nfield    = publickey.field.cloneNode(true);
              if(cert.publicKey.n){
                    $(nfield,'.category-field-name').textContent    = 'Key Size';
                    $(nfield,'.category-field-value').textContent   = cert.publicKey.n.bitLength()+' bits';
              }
              if(cert.publicKey.curve){
                    $(nfield,'.category-field-name').textContent    = 'Curve';
                    $(nfield,'.category-field-value').textContent   = cert.publicKey.curve;
              }
              publickey.list.append(nfield);


              var nfield    = publickey.field.cloneNode(true);
              $(nfield,'.category-field-name').textContent    = 'Subject Key Identifier';
              var ski   = cert.extensions.find(ext=>ext.name==='subjectKeyIdentifier');
              var str   = 'not present';
              if(ski){
                    str   = nodeforge.util.bytesToHex(ski.subjectKeyIdentifier);
              }
              $(nfield,'.category-field-value').textContent   =  str;
              publickey.list.append(nfield);


              authoritykey.list.replaceChildren();

              var oid   = cert.siginfo.algorithmOid;
              var alg   = nodeforge.pki.oids[oid];
              var nfield    = publickey.field.cloneNode(true);
              $(nfield,'.category-field-name').textContent    = 'Key Algorithm';
              $(nfield,'.category-field-value').textContent   = alg;
              authoritykey.list.append(nfield);
              
              var nfield    = authoritykey.field.cloneNode(true);
              $(nfield,'.category-field-name').textContent    = 'Key Identifier';
              var value   = 'not present'
              var aki   = cert.extensions.find(ext=>ext.name==='authorityKeyIdentifier');
              if(aki){
                    value ||= aki.keyIdentifier;
              }
              $(nfield,'.category-field-value').textContent   = value;
              authoritykey.list.append(nfield);
              
              var nfield    = authoritykey.field.cloneNode(true);
              $(nfield,'.category-field-name').textContent    = 'Authority Issuer';
              var value   = 'not present';
              if(aki){
                    value   ||= aki.authorityCertIssuer;
              }
              $(nfield,'.category-field-value').textContent   = value;
              authoritykey.list.append(nfield);
              
              var nfield    = authoritykey.field.cloneNode(true);
              $(nfield,'.category-field-name').textContent    = 'Authority Issuer Serial';
              var value   = 'not present';
              if(aki){
                    value   ||= aki.authorityCertSerialNumber;
              }
              $(nfield,'.category-field-value').textContent   = value;
              authoritykey.list.append(nfield);
              

              signature.list.replaceChildren();
              
              var nfield    = signature.field.cloneNode(true);
              $(nfield,'.category-field-name').textContent    = 'Signature';
              
              var bytes   = cert.signature;
              var hex     = nodeforge.util.bytesToHex(bytes).toUpperCase();
              
              $(nfield,'.category-field-value').textContent   = hex;
              signature.list.append(nfield);




              $('#pem').style.display   = 'inline-block';
              $('#pem').textContent     = pem;



              return;
              
              


              

              view.replaceChildren();
              
              
              //var extensions    = cert.extensions;

          
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'version';
              $(nfield,'.field-value').textContent    = cert.version;
              view.append(nfield);

              
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'serialNumber';
              $(nfield,'.field-value').textContent    = cert.serialNumber;
              view.append(nfield);

              
              var ca    = extensions.find(ext=>('cA' in ext));
              var nfield    = field.cloneNode(true);
              nfield.style.cssText    = 'margin-top:20px';
              $(nfield,'.field-name').textContent   = 'CA';
              $(nfield,'.field-value').textContent    = ca.cA;
              view.append(nfield);
              
              
              

              
              
              
              
              var nfield    = field.cloneNode(true);
              nfield.style.cssText    = 'margin-top:20px';
              $(nfield,'.field-name').textContent   = 'subjectAltName';
              var attr    = extensions.find(attr=>attr.name==='subjectAltName');
              var str     = []
              attr.altNames.forEach(attr=>{
                
                    switch(attr.type){
                      
                      case 2    : str.push(attr.value);       break;
                      case 7    : str.push(attr.ip);          break;
                        
                    }//switch
                    
              });
              str   = str.join(', ');
              $(nfield,'.field-value').textContent    = str;
              view.append(nfield);
              
              var ext   = props.ext;
              for(var key in ext){
                
                    var attr    = extensions.find(attr=>attr.name===key);
                    
                    var nfield    = field.cloneNode(true);
                    nfield.style.cssText    = 'margin-top:20px';
                    $(nfield,'.field-name').textContent   = key;
                    
                    var str   = [];
                    var list    = ext[key];
                    list.forEach(name=>{

                          if(attr[name]){                      
                                str.push(name);
                                
                          }
                          
                    });
                    
                    str   = str.join(', ');
                    $(nfield,'.field-value').textContent    = str;
                    
                    view.append(nfield);
                    
              }//for
                    

              /*
              
              var b64   = window.btoa(cert.signature);
              var nfield    = field.cloneNode(true);
              $(nfield,'.field-name').textContent   = 'signature';
              $(nfield,'.field-value').textContent    = b64;
              $(nfield,'.field-value').style.flexWrap   = 'wrap';
              view.append(nfield);              
              
              */


              

              
        }//display


        create.field    = function(name,value){
        }//field
        
        create.field.sub    = function(name,value){
        }//sub




        async function load(){

              await Promise.all([load.ext(),load.nodeforge()]);
              
        }//load
        
        
        load.ext    = async function(){
          
              var res   = await fetch('https://raw.githubusercontent.com/javascript-2020/ext-code/main/ext-loader.js')
              var txt   = await res.text();
              ext       = eval(txt);
              [$,datatype,menumod,keydown]   = await ext.load.libs(
                    'js/dom/$.js',
                    'js/core/datatype.js',
                    'js/dom/menumod/menumod.js',
                    'js/dom/keydown/keydown.js'
              );
              
        }//ext
        
        
        load.nodeforge    = async function(){
          
              var txt         = localStorage['node-forge'];
              if(!txt){
                    var url   = 'https://cdn.jsdelivr.net/npm/node-forge/+esm';
                                                                                //console.log(url);
                    var res   = await fetch(url);
                    txt       = await res.text();
                    localStorage['node-forge']    = txt;
              }
              
              var blob        = new Blob([txt],{type:'text/javascript'});
              var url         = window.URL.createObjectURL(blob);
              nodeforge       = await import(url);
              nodeforge       = nodeforge.default;
              //pki             = nodeforge.pki;
              
        }//nodeforge

                
        load.cert   = function(import_cert){
        
              var resolve,promise=new Promise(res=>resolve=res);
              
              var input         = document.createElement('input');
              input.type        = 'file';
              input.onchange    = onchange;
              input.click();
              
              return promise;
              
              
              async function onchange(){
              
                    file    = input.files[0].name;
                    pem     = await input.files[0].text();
                    
                    cert    = nodeforge.pki.certificateFromPem(pem);
                    
                    history.save();
                    resolve();
                    
              }//onchange
              
        }//cert
        

  //:
  
  
        history.delete    = function(){
          
              delete localStorage[store];
              
        }//delete
        
        
        history.load    = function(){
          
              var txt   = localStorage[store];
              if(!txt){
                    return;
              }
              var json      = JSON.parse(txt);
              ({file,pem}   = json);
              cert          = nodeforge.pki.certificateFromPem(pem);
              return true;
              
        }//load
        
        
        history.save    = function(){
          
              var txt               = JSON.stringify({file,pem});
              localStorage[store]   = txt;
              
        }//save
        



  //:
  console.log('done');
        init.stack.complete


      </script>

</html>


<!--



/*

const forge = require('node-forge');
const fs = require('fs');

const pem = fs.readFileSync('cert.pem', 'utf8');
const cert = forge.pki.certificateFromPem(pem);

const nameConstraintsExt = cert.extensions.find(ext => ext.name === 'nameConstraints');

if (!nameConstraintsExt) {
  console.log('No nameConstraints extension found.');
  return;
}


const asn1 = forge.asn1.fromDer(nameConstraintsExt.value);

// This is a SEQUENCE of permitted and excluded subtrees
const [permittedNode, excludedNode] = asn1.value;

// Helper to extract DNS names from subtree
function extractDNSNames(subtreeNode) {
  const names = [];
  const sequence = subtreeNode.value[0]; // SEQUENCE of GeneralSubtree
  for (const generalSubtree of sequence.value) {
    const generalName = generalSubtree.value[0]; // GeneralName
    if (generalName.type === 2) { // dNSName
      names.push(forge.util.decodeUtf8(generalName.value));
    }
  }
  return names;
}

const permitted = permittedNode ? extractDNSNames(permittedNode) : [];
const excluded = excludedNode ? extractDNSNames(excludedNode) : [];

console.log('Permitted DNS:', permitted);
console.log('Excluded DNS:', excluded);


*/



-->












        
    