

<!DOCTYPE html>


<html>

      <head>
            <meta charset=utf-8>
    
            <title>
                  Verify Certificate
            </title>
            
            <meta name=description content='verify x509 certificate'>
            
            <base href='https://ext-code.com/utils/x509/verify-certificate/'>
            <link rel=canonical href='https://ext-code.com/utils/x509/verify-certificate/verify-certificate.html'>
            
            <link rel=icon href='images/data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAASFBMVEVHcEwihb8ghsMkhb0hhcEog7gghsMjhL4hhcEghsQhhsIihcEghsMlhLwhhb8hhsIghsM1ga0jhb8hhsIihcEhhsIhhsIghsTjBA94AAAAF3RSTlMATPIXeAbnKIr6n1zZDjvF0QIwuGqyvwIDyU4AAAENSURBVCjPrZPZrsMgDESx2ZewU///n17SVFVF6H2qX1A4ymTGdhj7YXH+FR1c1pSq5MeOSheaIlItOLnBerLQWrCk9F0ZBiXPpeQ+0YBV31gaL1t8kDUrpnBJRtd1oBULEpeDjPB+eFfNGC/7J4mY6yct7rQLnoPN/BnClU/uESvr+HhQP7UQ/WptXvRXZr+x1g4mjTo7drTVGnNkRWFSzy8XYcktODqF5tkXblC5eGsrIGXTu8k0k2/mmQhpFlLaTfQADwJRzGO3EyI/ggAQIWVT7muUp7D1YOeh6g37635Oy6rbPJkcp63ZaUNDA6zqUYX53kykU9xtWuRRnYmKlts9Lkz0f/8BKdlv6w+Edg1IkaSBUwAAAABJRU5ErkJggg=='>
            <meta name=viewport content='width=device-width, initial-scale=1'>

            <script type='application/ld+json'>
                  {
                        "@context"              : "https://schema.org",
                        "@type"                 : "SoftwareApplication",
                        "name"                  : "Verify Certificate",
                        "url"                   : "https://ext-code.com/utils/x509/verify-certificate/verify-certificate.html",
                        "author"                : {"@type":"Person","name":"Matthew Richards"},
                        "description"           : "Generate rsa keypair",
                        "applicationCategory"   : "DeveloperApplication",
                        "operatingSystem"       : "All",
                        "browserRequirements"   : "Requires JavaScript-enabled browser",
                        "softwareVersion"       : "1.0.0",
                        "offers"                : {"@type":"Offer","price":"0","priceCurrency":"GBP"}
                  }
            </script>


            <script src='https://libs.ext-code.com/js/dom/component/component.js'></script>
            
            <script init>
                                                                                console.clear();
                                                                                console.log('verify-certificate.html');
                                                                                console.log();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
        var nodeforge;

            
        var df=true,did='html'
        ;
        
        var ext;
        var $;
        var datatype;
        var menumod;
        var keydown;
        var debug;


        var menu;
        
        
        var hdr;
        
  //:
  
            
        async function init(){


              await load();
        
        
              menu    = menumod();
              
              mod.base.add({ext,$,datatype,keydown,menu,menumod});
              
              
              hdr   = mod['x509-hdr'];
              
              hdr.initmod({ext,$,menu});
              
              await Promise.all([
                    hdr.init(),
              ]);
              
              
              
              initdom(document.body);


                                                                                console.log('ready');
        }//init
        
        
(async()=>{
  
        mod.stack.add;

        var {ext}   = await import('https://libs.ext-code.com/js/io/ext-loader/ext-loader.m.js');
        
        var promise   = ext.load.libs(
              'js/dom/$.js.api',
              'js/core/datatype.js',
              'js/dom/menumod/menumod.js',
              'js/dom/keydown/keydown.js',
              'js/debug/debug.js',
        );
        [$,datatype,menumod,keydown,debug]   = await promise;


        mod.stack.complete;

})();


        async function load(){
          
              await Promise.all([load.ext(),load.nodeforge()]);
              
        }//load


        load.ext    = async function(){
          
              var res   = await fetch('https://raw.githubusercontent.com/javascript-2020/ext-code/main/ext-loader.js')
              var txt   = await res.text();
              ext       = eval(txt);
              [$,datatype]    = await ext.load.libs('js/dom/$.js','js/core/datatype.js');
              
        }//ext


        load.nodeforge    = async function(){
          
              var txt         = localStorage['node-forge'];
              if(!txt){
                    var url   = 'https://cdn.jsdelivr.net/npm/node-forge/+esm';
                                                                                //console.log(url);
                    var res   = await fetch(url);
                    txt       = await res.text();
                    localStorage['node-forge']    = txt;
              }
              var blob        = new Blob([txt],{type:'text/javascript'});
              var url         = window.URL.createObjectURL(blob);
              nodeforge       = await import(url);
              nodeforge       = nodeforge.default;
              //console.log(nodeforge);
              
        }//nodeforge

            
            </script>
            
            
            <style>
        
  html
    {height:100%}
  body
    {height:calc(100% - 42px);margin:20px;display:flex;flex-direction:column;font-family:arial}
    
    
  x509-hdr
    {margin-bottom:20px}
    
  .hdr                  
    {font-family:arial;position:relative;margin-top:0;margin-bottom:20px;background:white;
      padding-bottom:10px;border-bottom:3px solid lightblue}
  .hdr-icon             
    {display:inline-block;text-align:center;background:whitesmoke;border-radius:5px;
      border:1px solid lightgray;padding:5px 3px 0px;cursor:pointer;margin-right:10px;
      min-width:50px}
  .hdr-icon-img         
    {width:25px;height:25px}
  .hdr-icon-label       
    {margin:2px 0 0}
  .hdr-title            
    {position:absolute;left:0;right:0;z-index:0;margin:0 auto}
  .hdr-date
    {float:right}

  input
    {padding:5px 10px;font-size:16px}
  input[type=button]
    {cursor:pointer}
                        
  #result
    {display:none;padding:5px 10px}
  .ok
    {color:green;border:1px solid green}
  .error
    {color:red;border:1px solid red}


  .visually-hidden
    {position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;
      clip:rect(0 0 0 0) !important;white-space:nowrap !important;border:0 !important}


        </style>
        
    </head>
    
    <body>


            <x509-hdr component=grp v2.0>
                  <h1 class=visually-hidden>
                        Verify Certificate
                  </h1>
                  <img class=title src='images/verify-certificate.png' style='top:5px;height:55px' alt='verify certificate'>
                  <time slot=date datetime=2025-11-15>
                        15 Nov 2025
                  </time>
            </x509-hdr>


<!--
        <div class=hdr>
            <a class=hdr-icon href='https://javascript-2020.github.io/'>
                <img class=hdr-icon-img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAAAqFBMVEVHcEwjmpckopg9f3YxpJM6r5kjq58Nmp0Nn6QRoKExrpshnpgtoJUdoZwYnZ02spwYpaEmrZ8djpINn6Qtrp4inpcjqZ8SoqM3s5w0sp01spwrr58vr50oqpwdnpo0sZwtrJwUpKMMoaUtq50op5ssqpopppseqaM1sJwgpJ0NoaUSoaI3kYobqaMSpKQrr58PoaMVpaIOoKMLpKcXpaEkqp8Rm58YrKUL0CR4AAAAOHRSTlMACBkBCyinK59CQhUOLyKjqbUGpZgSYn6rp5WsekcmgkyWmCkmNB7AYTiuVgKuuo91i2PLn2lJ7kISMf4AAAElSURBVCjPrdPXloIwEAbgBDFKCRo6SO8lYEHd93+zxV7Zm2WuSL6Tk/MPEwBGLFH8SzFCeFiDXNeJ+7GtGds1D+ghDzzPzXX6xlJbq75s5KVLiJsSB76xIhd22Mz0pkyRnqzW2htD/SeUjL0EQKY60nqRvTLXGl64PR/SfDVxVvETZ123w8vN9Ur5YKUF4R9cd/WxqiePgCs3IMF1QXcVt6vK59tSqyjN4hwQbhS8mUuvWTLbwYtTQGhEjLHVPprv+4ztQ8AeRVn50uipBcXg/IPgfPaFF+z1axyeMEkcJwwdYHHZINQ02gALS49lJcQMci/COGzdue8apRQwNz4tYvM207JSRVEUhvtW6KeBIFVVbds07xPncZfCfWSK+UtNJ/9+VL/nTBuX7xjDZwAAAABJRU5ErkJggg==' />
                <div class=icon-label>
                    home
                </div>
            </a>
            <a id=github class=hdr-icon href='https://github.com/javascript-2020/javascript-2020.github.io/tree/main/utils/x509/generate-certificate-chain/generate-certificate-chain.html'>
                <img class=hdr-icon-img src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAbFJREFUOE/l1E2IT2EUx/HPIFI2lJfGwmYsxFZKEUWjKWM3pZSpKcqeBcpLZsNeUeNlZWdBSVFmkAXbmRWbWRCRjYW8jv+pc/V4utff3q3bvfc5z/k+557zO2dA97UHy7ERx3LbZbzEZzxscx3o4L3GWizusP/AO6yv7TXwAo5g9V8iL03vcRWnm8USeBHH/xFUb7uEE7HYAOMZeVmGm7iN61jVccBHjOMQxvAl870QoIDMZ87CfxR3E7QDTyroTjzOtf24k++R0w0BHMY9LEpDCeyXgRL4EyMBjEKcSs+o3r4uSbTQQ1r3CzVMBnCh2PimTQp9wgyJDZZV/g+Bz7E1c/AdezHdr7xp34UHvcIuye8XUZSy9A1nDT5UBSvPCL9oz9BeeY2GYR3msBIHsi834WlPTt9yrXQKIUdEIfoVhSG6Z3PTejdwGG+xDc9SPud7UZ6popjEyZaURMuOl8NhKvtzpKf4yGvMwk95l/5xwNkKeA0T5XCI96EcRbsLh5mWAtXARznyXtXA5tD4/YNYmuBzVTQN8Ctu5V/93tI1sbdjS463KxXwaFZ/NnP9h/kXPcNYElddRc0AAAAASUVORK5CYII='>
                <div class=hdr-icon-label>
                      github
                </div>
            </a>
            
            <img class=hdr-title src='images/verify-certificate.png' style='height:40px;top:10px'>
            
            <div class=hdr-date>
                  24 Apr 2025
            </div>
        </div hdr>
-->

        
        <div id=btns>
              <input value=clear type=button>
              <input value=root type=button>
              <input value='add cert' type=button>
              <input value=verify type=button>
              <span id=result></span>
        </div>
        
        <pre id=view></pre>
        
      </body>
      
      
      <script>
      
      
        var $;
        var datatype;
        

        
        var root;
        var chain   = [];
        
        
        var btn   = {};
        

  //

  
        function initdom(){
          
              
              var btns                                = $('#btns');
              
              hdr.initdom();
              
              $(btns,'[value=clear]').onclick         = btn.clear;
              $(btns,'[value=root]').onclick          = btn.root;
              $(btns,'[value="add cert"]').onclick    = btn.add;
              $(btns,'[value=verify]').onclick        = btn.verify;


              $('#view').replaceChildren();

              
        }//initdom


  //:
  
  
        btn.clear   = function(){
          
              root    = null;
              chain   = [];
              $('#view').replaceChildren();
              $('#result').style.display    = '';
              
        }//clear
        

        btn.root    = async function(){
          
              root    = await load.cert('pem');
              display();
              
        }//root
        

        btn.add   = async function(){
          
              var cert    = await load.cert('import');
              chain.push(cert);
              display();
              
        }//add

        
        btn.verify    = function(){
          
              if(!root){
                    alert('root not set');
                    return;
              }
              if(chain.length==0){
                    alert('chain not set');
                    return;
              }
              verify();
              
        }//verify
        
        
        function display(){
          
              $('#view').replaceChildren();
              var str   = '';
              if(!root){
                    return;
              }
              str  += root;
              
              chain.forEach(cert=>{
                
                    cert    = nodeforge.pki.certificateToPem(cert);
                    str    += cert;
                    
              });
              $('#view').textContent    = str;
              
        }//display
  //:
  
  
        async function verify(){
      
              var store   = nodeforge.pki.createCaStore([root]);
              
              $('#result').style.display    = 'inline';

              try{
                
                    var result    = nodeforge.pki.verifyCertificateChain(store,chain);
                    console.json(result);
                    
                    $('#result').textContent    = 'verification ok';
                    $('#result').className      = 'ok';
                    
              }
              catch(err){
                    
                    console.log(err);
                    $('#result').textContent    = 'verification failed';
                    $('#result').className      = 'error';
                    
              }
              
        }//verify      
      



        load.cert   = function(mode){
        
              var resolve,promise=new Promise(res=>resolve=res);
              
              var input         = document.createElement('input');
              input.type        = 'file';
              input.onchange    = onchange;
              input.click();
              
              return promise;
              
              
              async function onchange(){
              
                    var cert    = await input.files[0].text();
                    if(mode==='import'){
                          cert    = nodeforge.pki.certificateFromPem(cert);
                    }
                    resolve(cert);
                    
              }//onchange
              
        }//cert



        
      </script>

</html>

