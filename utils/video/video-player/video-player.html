

<!doctype html>

<html lang=en>

      <head>
            <meta charset=utf-8>
            
            <title>
                  Video Player
            </title>
            
            <meta name=description content=''>
            
            <base href='https://ext-code.com/utils/video/video-player/'>
            <link rel=canonical href='https://ext-code.com/utils/video/video-player/video-player.html'>
            
            <meta name=viewport content='width=device-width, initial-scale=1'>
            <link rel=icon href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAABmFBMVEVHcEwJCQkKCgru7u5GRkgfHx8vLy9ISEgUFBRWV1kXFxdpaWtra2xNTU3h4eEeHh4zMzNLS01DQ0Q6OjoqKir09PQPDw8LCwsNDQ0LCwsREREjIyMxMTFMTE5RUVFlZmpTU1U4ODhzc3Tp6ekPDw8WFhaKi42Cg4USEhKEhYeJiowdHR14eXuMjI5iY2VmZ2kjIyNfYGKGh4mNjpA2NjYkJCR5eXlfX18MDAw0NDQSEhJnaGobGxs3NzhkZWhaW1wrKyxYWFpzdHSTlJWgoKAPDw8gISEWFha0tLSjo6P///8wMDBBQUFgYWQiIiInKChTVFV8fH0lJSVHR0m8vLyrq6xPTk9vcHKCgoQZGRk8PDzr6+sdHh2np6ewsLDU1NRQUVNLS0yMjI7y8vL/AwT6FBRdXl/z8/PPz8/+/v6Gh4mMIySfn5+Wlpjl5eX6+vrg4OB3d3c5Hx57GBj4BAXCDAw0JiaHVFa1trbGxsbLy8vNCgt0Pj++S0tdKCi7GhpwGhvzW1vLZ2heISH9XV2QSEjf399sbGwqFLIEAAAAOHRSTlMAVfgDERMoKMrL4ymxrqsezAfL4+OpmUnc9LPj4stR4eLspp+AYUrdfS7W440iycrMy2qZp9d+rjCB+jUAAAIeSURBVCjPddOHd5pAAAbwaytGE0c0zexKk+69G0BkGDECMg1BxW1Nok3MaJPUrnT/271DbErz+uPx8eB7wLs7AMBxDnJiCJy4/+TpQji8sDgZeRkORSYjIZSLL8YG7Y07jYZVxI2q0NvFi3lhs+FkauIyam/f7DQanTYjaj2hL4nJprBjovxZv4r6e5rWsTSOUqg+vJ0RK4KQcvNZDMRCawin8vyvUjMv8upOc6M4yOdR4HuQhEiypuvJjWqF0s131bw0yPN+4AvSbW2NZUVRype2NZwql0opnMqinBgBvks11uJqlK1z8Nm4Tm83qxLM9aqkoLvjRt00pUxa6QvruXSistnTYAowiVE/wMYpnKKYDGGs5LdkglrNl0U3M6Po3ayDhv4c3JP5MeB7SA4lvUjyCqwf51xcyrXlhJXLoTpI0yZLt2naqqw6yuUsYtXr83BgQVU9/HqoQrVa3TCkYpEacsZtmj++f/n4ATYU7oXquGF0X0GfP4m4ll0eymq4eHEEYHFJ6rZarTdvvzEiS55QGQbVcFq6sDw+UHRd5nke7YisoEnFxhll//3+gSJLnAeryxdg/ciW9/Zk3rbb2deuZbTvyjaqA4WEbScKcPtHoXAX1RlXgvGQM2hJsADhoo9W/nJkFdCCxuaGteydE4YgAhgA14m0a8kDXrgFP2Tf1NJ/zGHoP8CuzcyePWV2Zirq/mTR6TOnTPtR8xulKNDmeeSt2gAAAABJRU5ErkJggg=='>
            
            <script type='application/ld+json'>
                  {
                        "@context"              : "https://schema.org",
                        "@type"                 : "SoftwareApplication",
                        "name"                  : "Video Player",
                        "url"                   : "https://ext-code.com/utils/video/video-player/video-player.html",
                        "author"                : {"@type":"Person","name":"Matthew Richards"},
                        "description"           : "",
                        "applicationCategory"   : "DeveloperApplication",
                        "operatingSystem"       : "All",
                        "browserRequirements"   : "Requires JavaScript-enabled browser",
                        "softwareVersion"       : "1.0.0",
                        "offers"                : {"@type":"Offer","price":"0","priceCurrency":"GBP"}
                  }
            </script>
            
            
            <script src='https://libs.ext-code.com/js/dom/component/v3.0/component.js'></script>
            
            <script>
                                                                                console.clear();
                                                                                console.log('video-player');
                                                                                console.log();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
        var df=true,version='v1.0'
        ;
        
        var ext,$,datatype,menumod,keydown,debug,hs
        ;
        
        var menu;
        
        var hdr;
        var filemod;
        var log;
        
        
        var github    = false;
        if(window.location.toString().includes('github')){
              github    = true;
        }
        
        
        var time;
        var timestamp;
        var seek;
        
        var hldr;
        var bw;
        var bh;
        var video;
        
        var skip    = {};
        var btn   = {};
        
        
        
        
        
        
        async function init(){
        
              menu    = menumod();
              
              mod.base.add({ext,$,datatype,keydown,menu,menumod});
              
              
              hdr           = mod['video-hdr'];
              filemod       = mod['file-mod'];
              log           = mod['log-mod'];
              
              hdr.initmod({ext,$,menu});
              filemod.initmod({ext,$,menumod,menu,complete,source,focus,log});
              log.initmod({ext,$});
              
              await Promise.all([
                    hdr.init(),
                    filemod.init(),
                    log.init(),
              ]);
              
              
              initdom();
              setup();
              
        }//init
        
        
(async()=>{

        mod.stack.add;
        
        ({ext}    = await import('https://libs.ext-code.com/js/io/ext-loader/ext-loader.m.js'));
        
        var promise   = ext.load.libs(
              'js/dom/$.js',
              'js/core/datatype.js',
              'js/dom/menumod/menumod.js',
              'js/dom/keydown/keydown.js',
              'js/debug/debug.js',
              'js/string/hs.js',
        );
        [$,datatype,menumod,keydown,debug,hs]   = await promise;
        
        mod.stack.complete;
        
})();



      </script>
      
      
      
      
        <style>
        
  html
    {height:100%}
    
  body
    {display: flex; flex-direction: column; height: calc(100% - 30px); margin: 15px; font-family: arial;}
    
    
  [component]
    {display:none}
    
  .icon
    {border:1px solid gray;border-radius:3px;box-sizing:border-box;width:30px;height:30px;cursor:pointer}
    
    
  #upper
    {margin-top: 10px; display: flex; justify-content: space-between; gap: 10px; align-items: center;}
    
  #rotate-root
    {display: flex; align-items: center;}
    
  #rotate
    {width: 50px; margin-right: 10px; padding: 3px 5px; font-size: 16px; font-weight: bold; text-align: center;}
    
    
  #lower
    {display: flex; justify-content: center; align-items: center; gap: 10px;}
    
  #time-root
    {display: flex; align-items: center;}
    
  #zero
    {cursor: pointer; font-size: 16px; box-sizing: border-box; margin-right: 10px;}
    
  #time
    {width: 100px; padding: 3px 5px; font-size: 16px; font-weight: bold; text-align: center; margin-right: 5px;}
    
  #timestamp
    {width: 120px; padding: 3px 5px; font-size: 16px; font-weight: bold; text-align: center; margin-right: 20px;}
    
  #cur-time
    {font-weight: bold;}
    
  #cur-timestamp
    {margin-right: 10px; font-weight: bold;}
    
  #dur-time
    {font-weight: bold;}
    
  #dur-timestamp
    {margin-right: 10px; font-weight: bold;}
    
  #seek-root
    {align-items: center; display: flex; margin-right: 10px;}
    
  #back
    {cursor: pointer; font-size: 16px; box-sizing: border-box; margin-right: 10px;}
    
  #seek
    {width: 50px; padding: 3px 5px; font-size: 16px; font-weight: bold; text-align: center; margin-right: 10px;}
    
  #forward
    {cursor: pointer; font-size: 16px; box-sizing: border-box;}
    
  #hldr
    {flex: 1 1 0%; text-align: center; margin-top: 20px;}
    
  video
    {width: 100%; height: 100%;}
    
  .label
    {margin:0 20px}
    
  .visually-hidden
    {position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0 0 0 0);border:0}
    
            </style>
            
      </head>
      
      
      <body>
      
            <video-hdr component=grp>
                  <img class=title src='images/video-player.png' style='top:5px;height:60px' alt='video player'>
                  <h1 slot=seo-hdr class=visually-hidden>video player</h1>
                  <time slot=date datetime=2025-11-28>28 Nov 2025</time>
            </video-hdr>
            
            
            <div id=upper>
            
                  <div>
                        <span class=label>
                              load file
                        </span>
                        <file-mod component></file-mod>
                  </div>
                  
                  <div id=rotate-root>
                        <div style="margin-right: 10px;">
                              rotate
                        </div>
                        <input id=rotate value=0>
                        </input>
                        <div>
                              deg
                        </div>
                  </div>
            </div>
            
            <div id=lower>
                  <div id=time-root>
                        <input type="button" value="<<" id=zero>
                        </input>
                        <input id=time spellcheck="false" autocomplete="off" value="0">
                        </input>
                        <input id="timestamp"  spellcheck="false" autocomplete="off" value="00:00:00">
                        </input>
                        <div id="cur-time">
                              00000
                        </div>
                        <div style="margin-left: 10px; margin-right: 10px;">
                              --
                        </div>
                        <div id="cur-timestamp">
                              00:00:00
                        </div>
                        <div style="margin-left: 10px; margin-right: 10px;">
                              &#x2F;
                        </div>
                        <div id="dur-time">
                              00000
                        </div>
                        <div style="margin-left: 10px; margin-right: 10px;">
                              --
                        </div>
                        <div id="dur-timestamp">
                              00:00:00
                        </div>
                  </div>
                  <div id="seek-root">
                        <input type="button" value="back" id="back">
                        </input>
                        <input id="seek" spellcheck="false" autocomplete="off" value="1">
                        </input>
                        <input type="button" value="forward" id="forward">
                        </input>
                  </div>
            </div>
            
            <div id="hldr">
                  <video controls>
                  </video>
            </div>
            
            <log-mod component></log-mod>
            
      </body>
      
      
      <script>
      
      
      
        function initdom(){   //c
        
        
              hdr.initdom();
              filemod.initdom();
              log.initdom();
              
              
              
              //$('select').onchange      = select;
              //$('#file').onclick        = btn.file;
              
              time                      = $('#time');
              time.onfocus              = e=>time.select();
              time.onblur               = skip.time;
              time.onkeyup              = e=>e.key=='Enter' && skip.time();
              
              timestamp                 = $('#timestamp');
              timestamp.onfocus         = e=>timestamp.select();
              timestamp.onblur          = skip.timestamp;
              timestamp.onkeyup         = e=>e.key=='Enter' && skip.timestamp();
              
              $('#zero').onclick        = zero;
              $('#back').onclick        = back;
              seek                      = $('#seek');
              $('#forward').onclick     = forward;
              
              rotate.input              = $('#rotate');
              rotate.input.onkeyup      = e=>e.key=='Enter' && rotate();
              
              hldr                      = $('#hldr');
              bw                        = hldr.offsetWidth;
              bh                        = hldr.offsetHeight;
              
              video                     = $('video');
              video.ontimeupdate        = update;
              video.onloadedmetadata    = meta;
              
              
        }//initdom
        
  //:
  
  
        btn.file    = function(){
        
              var input         = document.createElement('input');
              input.type        = 'file';
              input.onchange    = onchange;
              input.click();
              
              function onchange(){
              
                    var file    = input.files[0];
                    var url     = window.URL.createObjectURL(file);
                    set(file.name,url);
                    
              }//onchange
              
        }//file
        
        
  //:
  
  
        function setup(){
        
              var s   = window.location.toString();
              var i   = s.indexOf('?');
                                                                                console.log(s);
              if(i!=-1){
              
                    s                   = s.slice(i+1);
                    var parts           = s.split('=');
                    var file            = parts[0];
                    var vtime           = parts[1];
                    time.value          = vtime;
                    timestamp.value     = millitostr(vtime*1000,'ts1');
                    video.src           = '/video-'+file;
                    video.currentTime   = vtime;
                    
                    
              }
              
        }//setup
        
  //:
  
        function set(file,blob){
        
              var url   = window.URL.createObjectURL(blob);
              
              video.src           = url;
              video.currentTime   = 0;
              
        }//set
        
        
  //:
  
  
        function focus(){}
        
        
        function source(){}
        
        
        var complete    = {};
        
        complete.load   = function(file,blob){
        
              set(file,blob);
              
        }//load
        
        
        complete.save   = function(file){
        }//save
        
        
        
        
        
        
        
  //:
  
/*
        function select(e){
        
              var file            = e.target.value;
              set(file);
              
        }//select
        
        select.add=function(file){
        
              var opt   = document.createElement('option');
              opt.textContent   = file;
              $('select').append(opt);
              
        }//add
        
        async function getfiles(){
        
              var res     = await fetch('/read');
              var files   = await res.json();
              files.forEach((file,i)=>{
              
                    if(i==0){
                          video.src   = '/video-'+file;
                    }
                    select.add(file);
                    
              });
              
        }//getfiles
*/



  //:
  
        function meta(){
        
              var t                                 = 0;
              $('#cur-time').textContent            = t.toFixed(1);
              $('#cur-timestamp').textContent       = millitostr(0,'ts1');
              
              var duration                          = video.duration;
              $('#dur-time').textContent            = duration.toFixed(1);
              $('#dur-timestamp').textContent       = millitostr(duration*1000,'ts1');
              
              var width                             = video.videoWidth;
              var height                            = video.videoHeight;
              var ar                                = width/height;
                                                                                console.log(ar,bw,bh,width,height);
              if(width>bw || height>bh){
                    if(width>bw){
                          width                     = bw;
                          height                    = 1/ar*width;
                          if(height>bh){
                                height              = bh;
                                width               = ar*bh;
                          }
                    }else{
                          height                    = bh;
                          width                     = ar*height;
                          if(width>bw){
                                width               = bw;
                                height              = 1/ar*width;
                          }
                    }
                    video.style.width               = width+'px';
                    video.style.height              = height+'px';
              }
              
              rotate();
              
        }//meta
        
        function update(){
        
              var time                              = video.currentTime;
              $('#cur-time').textContent            = time.toFixed(1);
              $('#cur-timestamp').textContent       = millitostr(time*1000,'ts1');
              
        }//update
        
  //:
  
        skip.time=function(){
                                                                                console.log('skip.time');
              var v   = parseFloat(time.value);
                                                                                console.log(v);
              if(isNaN(v)){
                                                                                console.log('nan');
                    return;
              }
                                                                                console.log(v);
              video.currentTime   = v;
              
        }//time
        
        
        skip.timestamp=function(){
                                                                                console.log('skip.timestamp');
              var milli   = strtomilli(timestamp.value,'ts1');
                                                                                console.log(milli);
              var t       = milli/1000;
              var v       = parseFloat(t);
              if(isNaN(v)){
                                                                                console.log('nan');
                    return;
              }
                                                                                console.log(v);
              video.currentTime   = v;
              
        }//timestamp
        
        
        function zero(){
        
              video.currentTime   = 0;
              
        }//zero
        
        
        function back(){
        
              var v   = parseFloat(seek.value);
              if(isNaN(v)){
                    return;
              }
              var time            = video.currentTime;
              video.currentTime   = time-v;
              
        }//back
        
        
        function forward(){
        
              var v   = parseFloat(seek.value);
              if(isNaN(v)){
                    return;
              }
              var time            = video.currentTime;
              video.currentTime   = time+v;
              
        }//forward
        
        
        function rotate(){
        
              var v   = parseFloat(rotate.input.value);
              if(isNaN(v)){
                    return;
              }
              video.style.transform   = `rotate(${v}deg)`;
              
        }//rotate
        
        
  //:
  
  
        function millitostr(milli,type){
        
              var seconds   = Math.round(milli/1000);
              var years     = Math.floor(seconds / 31536000);
              var days      = Math.floor((seconds % 31536000) / 86400);
              var hours     = Math.floor(((seconds % 31536000) % 86400) / 3600);
              var minutes   = Math.floor((((seconds % 31536000) % 86400) % 3600) / 60);
              var seconds   = (((seconds % 31536000) % 86400) % 3600) % 60;
              var msecs     = milli%1000;
              
              var timestr;
              
              switch(type){
              
                case 'ts'       : timestr   = ts();         break;
                case 'ts1'      : timestr   = ts1();        break;
                
              }//switch
              
              return timestr;
              
              
              function ts(){
              
                    var s   = '';
                    
                    s      += (hours+'').padStart(2,'0');
                    s      += ':';
                    
                    s      += (minutes+'').padStart(2,'0');
                    s      += ':';
                    
                    s      += (seconds+'').padStart(2,'0');
                    s      += '.';
                    
                    s      += (msecs+'').padStart(3,'0');
                    
                    return s;
                    
              }//ts
              
              function ts1(){
              
                    var s   = '';
                    
                    s      += (hours+'').padStart(2,'0');
                    s      += ':';
                    
                    s      += (minutes+'').padStart(2,'0');
                    s      += ':';
                    
                    s      += (seconds+'').padStart(2,'0');
                    
                    return s;
                    
              }//ts1
              
        }//millitostr
        
        
        function strtomilli(str,type){
        
              var years     = 0;
              var days      = 0;
              var hours     = 0;
              var minutes   = 0;
              var seconds   = 0;
              var msecs     = 0;
              
              switch(type){
              
                case 'ts'     : ts();         break;
                case 'ts1'    : ts1();        break;
                default       : def();
                
              }//switch
              
              var milli   = years*365*24*60*60*1000   +
                            hours*60*60*1000          +
                            minutes*60*1000           +
                            seconds*1000              +
                            msecs
              ;
              return milli;
              
              function ts(){
              
                    [hours,minutes,seconds,msecs]   = str.split(':');
                    
              }//ts
              
              function ts1(){
              
                    [hours,minutes,seconds]   = str.split(':');
                    
              }//ts1
              
              function def(){
              }//def
              
        }//strtomilli
        
        
        
        </script>
        
        
</html>