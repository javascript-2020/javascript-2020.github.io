


<html>

      <head>
      
            <title>hash text</title>

            <base href='https://javascript-2020.github.io/utils/misc/hash-file/hash-file.html'>
            
            <link rel=icon type='image/png' href='image/hash-text-30.png'>
            <link rel=stylesheet href='/utils/css/utils.css'>

            <script src="https://cdn.jsdelivr.net/npm/hash-wasm@4"></script>            
            
            <script init>
                                                                                console.clear();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
        var version       = 'v1.0';
            
        var df            = true;
        var debug_id      = 'hash-text.html';
        
        var ext;
        var $;
        var datatype;
        var menumod;
        var keydown;
        var debug;
        
        var mod           = {};
        mod.menu          = {};
        mod.hdr           = {};

        
        var filemod;   
        var filename;
        var log;
        
        
        var desc;
        
        
  //:

              
        async function init(){
                                                                                debug('init',version);

              menu                      = mod.menumod();
              //mod.hdr.base64            = mod.hdr.base64();
              filemod                   = mod.filemod();
              filename                  = mod['filename-ui']();
              log                       = mod.log();
              
              //mod.hdr.base64.initmod({ext,$,menu,menumod:menu});
              filemod.initmod({ext,$,menumod:menu,complete:preview.complete,source:preview.source});
              filename.initmod({ext,$});
              log.initmod({ext,$});
              
              //mod.hdr.base64.init();
              filemod.init();
              filename.init();
              log.init();

  //:
          
              menu.on.close          = null;

              
              await initdom(document.body);


              init.complete();

              
        }//init


        init.stack            = [];
        init.stack.ct         = 0;
        init.stack.total      = 1;
        init.stack.mode       = '';
        init.stack.complete   = false;
        Object.defineProperty(init.stack,'add',{get:()=>{
              init.stack.total++;
              init.stack.mode && console[init.stack.mode]('add',init.stack.ct,init.stack.total);
        }});
        Object.defineProperty(init.stack,'complete',{get:()=>{
              init.stack.ct++;
              init.stack.mode && console[init.stack.mode]('complete',init.stack.ct,init.stack.total);
              init.stack.ct>=init.stack.total && init();
        }});
        
        //  (typeof init!='undefined' && init?.stack && init.stack.add)
        //  (typeof init!='undefined' && init?.stack && init.stack.complete)

        
        init.complete   = function(){
          
              init.complete.stack.forEach(fn=>fn());
              
        }//complete
        
        init.complete.stack   = [];
        init.complete.add     = fn=>init.complete.stack.push(fn);

                  

(async()=>{
  
        init.stack.add;
        
        var token   = localStorage['github-token'];
        var url;
        var headers;
        if(token){
              url       = 'https://api.github.com/repos/javascript-2020/ext-code/contents/ext-loader.js';
              headers   = {accept:'application/vnd.github.raw',authorization:`bearer ${token}`};
        }else{
              url       = 'https://raw.githubusercontent.com/javascript-2020/ext-code/main/ext-loader.js';
        }
        
        await fetch(url,{headers}).then(res=>res.text()).then(complete);

            
        async function complete(txt){

              ext           = eval(txt);
              var promise   = ext.load.libs(
                    'js/dom/$.js.api',
                    'js/core/datatype.js',
                    'js/dom/menumod/menumod.js',
                    'js/dom/keydown/keydown.js',
                    'js/debug/debug.js.api'
              );
              [$,datatype,menumod,keydown,debug]   = await promise;

              init.stack.complete;

        }//ext_fn




        var hash    = await import('https://cdn.jsdelivr.net/npm/hash-wasm/+esm');
        console.log(hash);


/*

adler32 : ƒ(A)

argon2d : ƒ (A)
argon2i : ƒ (A)
argon2id : ƒ (A)

bcrypt : ƒ (A)

blake2b : ƒ (A,I=512,B=null)
blake2s : ƒ (A,I=256,B=null)
blake3 : ƒ (A,I=256,B=null)

crc32 : ƒ (A,I=3988292384)
crc64 : ƒ (A,I="c96c5795d7870f42")

keccak : ƒ (A,I=512)

md4 : ƒ (A)
md5 : ƒ (A)

pbkdf2 : ƒ gI(A)

ripemd160 : ƒ (A)

scrypt : ƒ (A)

sha1 : ƒ (A)
sha3 : ƒ (A,I=512)
sha224 : ƒ (A)
sha256 : ƒ (A)
sha384 : ƒ (A)
sha512 : ƒ (A)

sm3 : ƒ (A)

whirlpool : ƒ (A)

xxhash3 : ƒ (A,I=0,B=0)
xxhash32 : ƒ (A,I=0)
xxhash64 : ƒ (A,I=0,B=0)
xxhash128 : ƒ (A,I=0,B=0)


*/

        desc    = {

              adler32         : {grp:1,alg:'hashwasm'},
                        
              argon2d         : {grp:2,alg:'hashwasm'},
              argon2i         : {grp:2,alg:'hashwasm'},
              argon2id        : {grp:2,alg:'hashwasm'},
              
              bcrypt          : {grp:3,alg:'hashwasm'},
              
              blake2b         : 'ƒ (A,I=512,B=null)',
              blake2s         : 'ƒ (A,I=256,B=null)',
              blake3          : 'ƒ (A,I=256,B=null)',
              
              crc32           : 'ƒ (A,I=3988292384)',
              crc64           : 'ƒ (A,I="c96c5795d7870f42")',
              
              keccak          : 'ƒ (A,I=512)',
              
              md4             : {grp:7,alg:'hashwasm'},
              md5             : {grp:7,alg:'hashwasm'},
              
              pbkdf2          : 'ƒ gI(A)',
              
              ripemd160       : {grp:9,alg:'hashwasm'},
              
              scrypt          : {grp:10,alg:'hashwasm'},
              
              sha1            : {grp:11,alg:'hashwasm'},
              sha3            : {grp:11,alg:'hashwasm',bits:{values:[512]}},
              sha224          : {grp:11,alg:'hashwasm'},
              sha256          : {grp:11,alg:'hashwasm'},
              sha384          : {grp:11,alg:'hashwasm'},
              sha512          : {grp:11,alg:'hashwasm'},
              
              sm3             : {grp:12,alg:'hashwasm'},
              
              whirlpool       : {grp:13,alg:'hashwasm'},
              
              xxhash3         : 'ƒ (A,I=0,B=0)',
              xxhash32        : 'ƒ (A,I=0)',
              xxhash64        : 'ƒ (A,I=0,B=0)',
              xxhash128       : 'ƒ (A,I=0,B=0)',

              
        };



        
})();


            </script init>
        
      
      
            <style id=page-inline>
            
  html
    {height:100%}
  body
    {height:calc(100% - 40px);display:flex;flex-direction:column;gap:10px}


  .icon
    {border:1px solid gray;border-radius:3px;box-sizing:border-box;width:30px;height:30px;cursor:pointer}
  .spc
    {flex:1}
  

  #file
    {display:flex;flex-direction:column;gap:10px;border:1px solid lightgray;padding:10px}
    


    
  #blob
    {display:flex;flex-direction:column;gap:10px;}    
  #blob section
    {display:flex;align-items:center}    
  #blob label
    {width:100px;text-align:right;margin-right:20px}


  #btns
    {display:flex;flex-direction:column;gap:10px}
  
  
  #output-root
    {display:flex;flex-direction:column;gap:10px;border:1px solid lightgray;padding:10px}
  #output-hdr
    {display:flex;align-items:center}
  #output
    {font-family:monospace;font-size:16px;padding:5px 10px;border:1px solid lightblue;overflow:auto}


  #hash-type
    {color:blue;font-weight:bold}



  input
    {font-size:16px;padding:5px 10px}
  input[type=button]
    {cursor:pointer}


  
            </style>


            
      </head>
      
      
      <body>



            
            <div id=hdr>

<!--                        
                  <main-menu-page>
                        <script src='https://html-loader-1024713184986.us-central1.run.app/'></script>
                  </main-menu-page>
-->                  

            </div>





            <div id=file>

                  <div>
                        file
                  </div>
                  
                  <filemod api>
                        <script html-loader src='https://html-loader-1024713184986.us-central1.run.app/'></script>
                  </filemod>
      
                  <div id=blob>
                  
                        <filename-ui api>
                              <script html-loader src='https://html-loader-1024713184986.us-central1.run.app/'></script>
                        </filename-ui>
      
                        <section>                  
                              <label>
                                    size
                              </label>
                              
                              <div id=size>
                              </div>
                        </div>
                              
                  </div>
                  
            </div>



            <div id=params style='display:none'>
            
                  <div id=bits-value-root>
                  
                        <div>
                              bits
                        </div>
                        
                        <div>
                        </div>
                        
                  </div>
                  
            </div params>
            

            


            
            <div id=btns>
            </div>


            <div id=output-root>
            
                  <div>
                  
                        <label>
                              hash
                        </label>
                        
                  </div>
                  
                  <div id=output-hdr>
                        <input value=copy type=button>
                  </div>
                  
                  <div id=hash-type>
                  </div>
                  
                  <div id=output>
                  </div>
                  
            </div>

            
            <log api>
                  <script src='https://html-loader-1024713184986.us-central1.run.app/'></script>
            </log>

            
      </body>
      
      
      <script>
      
      
        var cur           = {};
        cur.blob          = new Blob(['helloworld']);
        
        var preview       = {};
        var blob          = {};
        

        var root;
        


        var btn           = {};
        btn.output        = {};



  //:
  
  
        async function initdom(rootnode){

              
              root                                    = rootnode;


              filemod.initdom(root);
              filename.initdom(root);




              blob.root                                       = $(root,'#blob');



              var btns                                        = $(root,'#btns');
              
              var cur     = {};
              cur.g       = null;
              cur.root    = null;
              
              for(let key in desc){
                
                    var d   = desc[key];
                    if(typeof d=='object'){
                      
                          var list    = Object.keys(d);
                          if(list.length==2){
                            
                                if(cur.g!=d.g){
                                      cur.g       = d.g;
                                      cur.root    = document.createElement('div');
                                      btns.append(cur.root);
                                }
                                
                                var input       = document.createElement('input');
                                input.value     = key;
                                input.type      = 'button';
                                input.onclick   = e=>hash(key);
                                cur.root.append(input);
                                
                          }//list
                                
                    }//object
                    
              }//for


              output.root                                     = $(root,'#output-root');
              
              $(output.root,'[value=copy]').onclick           = btn.output.copy;
              
              output.text                                     = $(output.root,'#output');
              
              
              

              log.initdom(root);


              blob.display();


          
        }//initdom


  //:

        function chk(){
          
              if(!cur.blob){
                    log.red('no file');
                    return true;
              }
              
        }//chk
        
        
        btn.test    = async function(){
          
              //await load('argon2');
              console.log(hashwasm);
              var alg   = 'blake2s';
              hash(alg);
              
        }//test
        
        

        btn.md2   = function(){
        }//md2
        
        btn.md4;

        
        btn.md5   = function(){
          
              if(chk())return;
              hash('blake2s');
              
        }//md5

        
        btn.md6;

        
        btn.sha1    = function(){
          
              if(chk())return;
              hash('sha1');
              
        }//sha1

        
        btn.sha256    = function(){
          
              if(chk())return;
              hash('sha256');
              
        }//sha256
        
        btn.sha512;
        btn.sha3;
        
        btn.blake2;
        
        btn.crc8;
        btn.crc16;
        btn.crc32;
        btn.crc32c;
        btn.crc64;






        btn.output.copy   = async function(){
          
              var txt   = output.textContent;
                                                                                console.log(txt);
              await navigator.clipboard.writeText(txt);
              
        }//copy



  //:
  
  
  
        blob.display   = function(){
          
              var str   = '---';
              if(cur.blob){
                    str   = cur.blob.size;
              }
              
              $(blob.root,'#size').textContent                 = str;
              
        }//display




  //:
  
  
        preview.source    = function(){
          
              return cur.blob;
              
        }//source
        
        
        preview.complete    = {};
        
        preview.complete.load   = function(file,srcblob){
          
              menu.close();
              
              cur.file            = file;
              cur.blob            = srcblob;
        
              preview.filename.show(file);
              blob.display();
              
        }//load
        
        
        preview.complete.save   = function(file){
          
              cur.preview.file    = file;
              
              log.green(file.filename+' saved');
              
              preview.filename.show(file);
              
        }//save
        
        
  //:
  
  
        function load(alg){
          
              if(hash[alg])return;
              
              var resolve,promise     = new Promise(res=>resolve=res);
              
              var src                 = `https://cdn.jsdelivr.net/npm/hash-wasm@4/dist/${alg}.umd.min.js`;
              
              var script              = document.createElement('script');
              script.onload           = onload;
              script.src              = src;
              document.head.append(script);
              
              return promise;
              
              
              function onload(){
                
                    resolve();
                    
              }//onload
              
        }//load
        
  
        async function hash(alg){
          
              //await load(alg);
              var fn    = hashwasm[alg];
              
              var txt   = await cur.blob.text();
              
              var hex   = await fn(txt);
              
                                                                                console.log(alg,hex);
              $(root,'#hash-type').textContent    = alg;
              output.text.textContent             = hex;
              
        }//hash


/*
  
        hash.sha256   = async function(txt){
          
            const msg   = new TextEncoder().encode(txt);
            const buf   = await crypto.subtle.digest('SHA-256',msg);
        
            var uint8   = new Uint8Array(buf);
            var hex     = uint8.reduce((a,byte)=>a   += byte.toString(16).padStart(2,'0'),'')
            
            return hex;
            
        }//sha256
        
*/

  

        
  //:
  
  
  init.stack.complete;


      
      </script>
      
      
</html>



