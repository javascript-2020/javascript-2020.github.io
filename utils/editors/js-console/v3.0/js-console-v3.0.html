

<!-- headers
      cross-origin-isolate
-->


<!DOCTYPE html>

<html lang=en>

      <head>
            <meta charset=utf-8>
            
            <title>
                  JS Console
            </title>
            
            <meta name=description content='Run, test, and debug JavaScript instantly in your browser. A fast, lightweight online JS console built for developers who value speed and simplicity.'>
            
            <base href='https://ext-code.com/utils/editors/js-console/'>
            <link rel=canonical href='https://ext-code.com/utils/editors/js-console/js-console.html'>
            
            <meta name=viewport content='width=device-width, initial-scale=1'>
            <link rel=icon type='image/png' href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAB4FBMVEX/3wD/3gD/4QD+4AD31wDy0wD32AD+3wDt0AB2ZwBfUwBeUgCKeQD62gD73QDDqgBwYgBDOwA3MABvYQDBqQD/4ADjxgAiHQAAAABCOgD21wD42gCIdwASDwARDwCHdgAiHgClkQAKCQAIBwCciAD01QBEOwAGBQBXTABbTwAmIQCrlQDewgAdGgDx1AD/4wCDcgBkVwDZvgDavwAaFgBMQgD42wD32gDrzQAvKQAMCwCGdQDpzAD+3gByZAADAwAzLACLeQDcwAD93wDcwQA2LwABAQAhHQB+bgDjxwDUugBORADGrgDw0wCjjgD/4gDy1AC3oABWSwALCQB9bQCVggAJCAD11wDu0QDJsAD63ADfxAAeGwBFPADRtwDpzwAqJQAxKwDu0AD62wBKQAAaFwC1nwC0ngBZTQD93QCahgArJQBBOQDTuAC8pQAUEQA9NQDz1QC/pwAXFAAdGQBtXwB0ZgAnIgCNfAA6MwBmWQCDcwBqXQAfGwBzZADoywAoIwDbwAC6owAeGgAkIADXvQBJQAAEAwAkHwCznQA9NgAEBAAwKgChjQBaTwA7MwCBcADWuwDszgCnkgBlWABAOAA0LgBYTQCWgwD83QDx0wD52QD+4QDw0gD83AD///80U23rAAAAAWJLR0Sf6LWTnQAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB+gMGw8AOrl7kF8AAAGXSURBVDjL7ZJVUwMxFIWTFCgOLaRcurhLobi7FV/cW9y1uLu7O/xWwhaYUtodXpnhPGzmzP12k3M2CP3rX39D2OgpihGJlbWNlFhCbe3sHRyd2NTZxVUml7m5O5snqcIDwFOJEOflDe/y8eXMklThJ4DEPwAMCgyiyDJIg0MAQsMcwwMgIhKJgEQVBSCLVnMxsXFUbGsSnwCQmERRMkcshTFsnZIKkJaeQSy28xkmM4vlyM7JzcunWBSkBYXvkYs0xSVEtB5MSstChXrk5VQMZGRFpafQZWq8OfILZOKrqmtqGVln0ji7BgjTkg+QSqQY8Vx9A7ONJlhTcwuirW0AWhtEVL46nr3X3gHQ2fXtg93uPb19RN3PzjUwqBwahpFRKU/GxgEm9MYcmZwCmJ6ZnWOHmlenLLBFs7i0vMLW1e8p1rQf1wXWNyjd3Pp0sK0jxqkx2dndEwb7ByylZPLwSHBFx5umoYntyemZvOf8QoIwi3Z5dX1ze3Z3r/jxZzDlH/SPT8+GAXP5yhf9K0/xz7qxiPut3gACakyeVGPirgAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyNC0xMi0yN1QxNTowMDo1MiswMDowMDd07d8AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjQtMTItMjdUMTU6MDA6NTIrMDA6MDBGKVVjAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg=='>
            
            <script type='application/ld+json'>
                  {
                        "@context"              : "https://schema.org",
                        "@type"                 : "SoftwareApplication",
                        "name"                  : "JS Console",
                        "url"                   : "https://ext-code.com/utils/editors/js-console/js-console.html",
                        "author"                : {"@type":"Person","name":"Matthew Richards"},
                        "description"           : "Run, test, and debug JavaScript instantly in your browser. A fast, lightweight online JS console built for developers who value speed and simplicity.",
                        "applicationCategory"   : "DeveloperApplication",
                        "operatingSystem"       : "All",
                        "browserRequirements"   : "Requires JavaScript-enabled browser",
                        "softwareVersion"       : "1.0.0",
                        "offers"                : {"@type":"Offer","price":"0","priceCurrency":"GBP"}
                  }
            </script>
            
            
            <script src='https://cdn.jsdelivr.net/npm/ace-builds@1.37.0/src-min-noconflict/ace.js'></script>
            <script src="https://cdn.jsdelivr.net/npm/prettier@2.8.8/standalone.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/prettier@2.8.8/parser-babel.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/terser/dist/bundle.min.js"></script>
            
            
            <script src='https://libs.ext-code.com/js/dom/component/v2.0/component.js'></script>
            
            <script init>
                                                                                console.clear();
                                                                                console.log('js-console-v2.0.html');
                                                                                console.log();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
        var version='v2.0';
        var df=true,did='js-console';
        
        var ace;
        var obfuscator;
        var espree;
        
        var ext;
        var $;
        var datatype;
        var menumod;
        var keydown;
        var debug;
        var ls;
        
        var menu;
        
        var hdr;
        var mainmenu;
        var filemod;
        var autosave;
        var publish;
        var editor;
        var output;
        var log;
        
        
  //:
  
  
        async function init(){
                                                                                debug('init',version);
              //keydown                   = keydown();
              menu                      = menumod();
              
              
              mod.base.add({ext,$,datatype,keydown,menu,menumod,ace,ls});
              
              
              hdr                       = mod['editors-hdr'];
              mainmenu                  = mod['main-menu'];
              filemod                   = mod['file-mod'];
              autosave                  = mod['auto-save'];
              publish                   = mod['publish-ui'];
              editor                    = mod['web-editor'];
              output                    = mod['output-console']
              log                       = mod['log-mod'];
              
              
              menu.initmod({keydown});
              
              hdr.initmod({ext,$,menu});
              mainmenu.initmod({ext,$,menu,editor,filemod});
              filemod.initmod({ext,$,menu,menumod,complete,source,focus,log});
              autosave.initmod({$,menu,keydown,log,save:btn.save});
              publish.initmod({ext,$,ui,menu,source,complete,log});
              editor.initmod({ext,$,menu,ace,on});
              output.initmod({ext,$});
              log.initmod({ext,$});
              
              
              await Promise.all([
                    mainmenu.init(),
                    hdr.init(),
                    filemod.init(),
                    autosave.init(),
                    publish.init(),
                    editor.init(),
                    output.init(),
                    log.init(),
              ]);
              
              
  //:
  
  
              icon.def    = $('[rel*=icon]').href;
              
              window.onfocus              = ()=>editor && editor.focus();
              keydown.add(kd);
              menu.on.close               = ()=>editor.focus();
              
              
              initdom(document.body);
              
              
              publish.query();
              
              
        }//init
        
        
  //:
  
  
(async()=>{

        mod.stack.add;
        
        ({ext}    = await import('https://libs.ext-code.com/js/io/ext-loader/ext-loader.m.js'));
        
        var lsmod;
        
        var promise   = ext.load.libs(
              'js/dom/$.js',
              'js/core/datatype.js',
              'js/dom/menumod/menumod.js',
              'js/dom/keydown/keydown.js',
              'js/debug/debug.js',
              'js/core/ls-mod/ls-mod.js',
        );
        [$,datatype,menumod,keydown,debug,lsmod]   = await promise;
        
        ls    = lsmod();
        
        mod.stack.complete;
        
})();


            </script init>
            
            
            <link rel=stylesheet href='/utils/css/utils.css' crossorigin=anonymous>
            
            <style id=page-inline>
            
  #help
    {padding:2px}
    
  #hdr
    {padding:5px 5px;height:30px;display:flex;align-items:center;gap:10px}
  .icon
    {border:1px solid gray;border-radius:3px;box-sizing:border-box;width:30px;height:30px;cursor:pointer}
  .spc
    {flex:1}
    
    
  #save-root
    {margin-left:5px;display:flex}
    
  #save-menu
    {position:absolute;left:0;top:30px}
    
    
  #syntax-chk
    {padding:2px;
      content:url('data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeBAMAAADJHrORAAAAFVBMVEUAAAD7+/v///////8AAADo6OgRERE8gmv3AAAAA3RSTlMA9T5S3MyNAAAAdElEQVQY07WQwQ2AQAgESa4FC7AEDFgBW4r916BgEHLRp/ObYzdcICnIUSTG5cHtlvEvz/o8/6EvXPnL5eDeFwX3vMC62wLJff64+7i5+rj3wd0VtrpH3NdHnCRcn3uNLMOoGIh4oREv4q+9kPVEJ5eN3jgB8k5GOJR+D40AAAAASUVORK5CYII=');
    }
  #prettier
    {padding:2px;
      content:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAfCAMAAADHso01AAABO1BMVEVHcExctLXl5+nk5unk6Orm5+nm5+nm5+nl5una29T5u0Tg5efk6Om/kptusbXm5+jk5ehatLXvvF1jsbPhbmn3wFD2u0X6vEq9h75bs7W8h77l6Onk5uriZGHl5+lxra/0tVTbbW7l5ujpY2Hm5+nl5+jo387n6uv2vUtctbbm6Ork5ujl6Ozk5edZtLeqiKvpY2C+hoDyvFrtvFr3vEvsYmNdtbX6vEb3u0Tn6uq/ib/m5+lbtLT4vk5sqsO/ib7j5efm5+n5yjhWs7TmXV3lZWPnY2H5vUitkrK+h77aama6h7rAicBas7S5jLq8g733vEj3vEZasbO6i7voYmJbtrfkZWa7i7ztul/mY2K1ir5cs7TAhrxhsbPCir3zvVToZWL4vUfyvVXgamy8hr9itLO8irr2vE3jY2ERfpgJAAAAaXRSTlMAnTsSF2NfbCsC3gUPDiZQFNohFi1L2TWGQ6caCz1KIB0hW8IhQggNMZVwNx0+pAe0AxIlPnKLi60lvFK4QwmVVmgGgoE33TAbeBFjtTYhcsDScTXfUmI9LNgoxdBpRnRVcW9UnWttnJ1jjy+pAAACDUlEQVQoz6XQaW+iUBSAYQVaQbyWou2ooCxlsYqDoGNrKbi01H2p2n32/f//grn3qp1OMt/6xJzc5IT45kQir5NqRP/RSGl7mFdI/HdtFQp4j9dOOgxDJcK/eaHGJARBoFi4Vo5WV6vf4Ff8hVO3UCqVOhT+GlIcvljs9XpFpNfjGZOCXzP4v99uLIKfOej7Mhk9ljTPK5BofXG88cMetaDMo9TAfTpK6xbrddmZTAArWJZlOuk8Eg5ZQUBp/Dwe/yo97WetGMwhhtXVFfTwjeqs0/j7e9dOJgOWoyhKdJQ0BhiOQ2n9Vg5bUl673abdk1OsTnoeSgODDPZI6nqlYhlfTrCiqOsmXNthfujWfd/nnUl2axKImmatr/aQr18fHsY/pc73t56SdGxzNUUBoAa5tpTckliD40h8teg5FE19riK3oDUejzMBoapqG19tcQEtgvASydsjmDmyaV3XCRGl3X0Ern/wzO+azabG4gHX07P3dyhta16jY7EdDg2c1p8CwNd4WeZ5NGTDIEmShSOBr5Y7Q8ZLSt1VLTieqfhqo9lsMBjMpmaZKJNiuVIh4A8po7Qge3Mjdf0D12jSkBURaI7R0LNpwLUEb/VBnl/7VicG7RmFUkVU0ROnMX1JAkCWu0wCJpEmK5osi584TakeYXlhdwfb1aj1S+Xgenj7DlMSZWJdBPv+pr3GH71mYxE304wpAAAAAElFTkSuQmCC');
    }
  #terser
    {content:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAABL1BMVEVHcEyyrqPktXj7yEntx18CsuD6x0kFKhkksNXfXFb8yEb8x0buw14Pst33SkAEsuLqWlBPqMAZr9j+Ox4BLi0UsNr8RTrwT0b1S0L5Rz0Lsd79RDkJst8Osd34x00FsuH6RjztT0f7RTv3QzgGsuH+QzgHmXcIst8wstD9QBcCOhUGmGv6yEkBO0EKst8UsdoMsd4XMDH1SUD2SD7aSkPyTEP4kTz0SkD5Rz0FmL6tNh7JPzj6RTvpVk0Hd14FZXo8KQ78pjeQLhDrNA8DXyklJg1xlzrXdCjCuUJQnT0VkT77x0gHWWcQst4wrM4Dco0Qpc59OTR2OzcXn8VcNzNWODb4SD/4aCD9XiCYt2Kct2cBs+P/yEL/QzgBJAv+Qzj+ykP5xEEAtOUBhzj/Mw15TFg9AAAAW3RSTlMAAQSxDv2p/Q0KyNAVaG/xEgQs/f5I5jBOpJ32u3iK57897v7g/vzJGf79/qr+sD2P/oKz3mHYlMX9+v3VIfr9/f39/v39+/v9/f60/FYK/t7+/t78/H79/dvUH0WokgAAAZdJREFUKM+Nk+dWwkAQRhMlEtSEQCD0pvTeVHpXEBV7DSGhvP8zuJvdEBQ8x/v3ntmd+XaWIHQMGGI3/kMV/95OS6anKjd/6AOk93/ryWRbm0xr7cvmLD81GSoVSWytAdGct27q5sWJLISQtbhFQNgX1zTHNmRJkl3oeLtZVIl9zYFU5ueViATxOKGlvSImej1Spt33hCwhKhzQDIUtFV2Or4aJFY+tJLOgRyawrl4Okpe9vqZlgQXNk1a3evmCaiVngE7tFF3tcqDRLHYvtRCrbdtMxfhSl6RI0KmHRzMP9xmbEWtb4bHMchupms7KTwVdZ9rPDK2/RajkkeT6q6Zvq6ARr92CrAMkCHs5rXWgTbZAIwCz2wpLzwQcQ4Tv9y6Ng2VKGzTMgNZZLaQIv0oMr8bLlJaT6APlXFCLgf/oTpXR9VrH4vBupwcVN87nCnySzxgO+Q5N5YJWeGumFfSgcV8Y6uwEty7ABAlCXweYcyCnDV5UE9xcJpBznlyHxm2vIk3/d5H/9w38Ryp/fCLCcKyy+QW/AbN1jCZHRao5AAAAAElFTkSuQmCC');
    }
  #obfuscator
    {padding:2px;
      content:url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAABblBMVEVHcEwIBAUFAwMIBQYEAwMGBAUGBAQHBAUGBAUHBwgHBAQCAQEIBQYGBgcGBgcDAgIEAwMMEhcCAgIGBQYEAgMDAgICAgICAQEHBQUGBAUFBQYGBAUCAQEFBAQDAgICAQEDAgICAQEIBQUutt8DAwMEAwQCAQEHBQYCBAUDAgIDAgI6t90HBQYBAQEFBAQCAgIOJC0BAQEwuuQCAgIEBQYVP0xr2+UBAQEztdwaTFwvvOUgaYADAgIxueIZU2UCAgItpMciepZH6P9EpcQBAQIxt+ABAQErhaEcV2oUMz4CAgIRLTYxkbA4rM4dWGsaYXgJExkwu+Ume5YxueIMIScun8IbWWwmfJgMGiEsg6EcV2sVQlEkf5wWTWMAAAAfUGBAwegVTF4cV2ozu+Ikf5oZPUk1ttoNJi4LHyYnjq0LGB4xrdQUQU8vtd4uu+YvvegAAAAUN0Qrk7QgdI4WTF8nncIwwOwtq9Ewqs8uocRkvQg8AAAAbnRSTlMAGgcXKicOHSMgAZY0UQkESSmIMUOAZ1RHTW0SkDdeYlibOv56Powtw6uCFzvTP6lRyNixdc4Dz5TZ7PaOn+WizG0NBu7Q5mpFvaXnPSzx//Dj+LWrvZaTi4VyY7Vu+Zw++DxPs90fudbUp4+l516+9w0AAAH6SURBVCjPvdJnc9pAEAbgE6dTQdJJqCBUAYuO6B3ce4/t9N57Arik/fvYMs44kyGfMtmvz97N3u0LwP+rsIip8BQjJFPTbFs2JYT/PKhzBVPgY5Ke0mblKPpdcdQW0gzyeQP62YiRWtCvK6XZfsQCwEIshCSiFTcvXeO4rEAEFTmjApJEFsRMNJ/+peVZlWBJvlSqJSxnuxCFELJCkriamYsxDAHjqw0tYeRynZSCRSuSiU84qrEwQoDqLVMQzFLFbRqYxdjgyEBDdsxiQmx4c/H2XUXlMtG0QbF0NtYsTO5WWBKKYbyxFLHQgztL96sixdB8LB8wkhWeojHl6Ak1QT18tPgYY1j2EdMAhAgAbZdpGkJsWVTWSevVXSxKvuM72SSoJBN8rCGEaETSBEGwIZFUSVGcUVgaOUlAu1xlO8OZrioplx2EiDHBR7IEFBaCwUPtjaOjwcHO/Hxr656KSKEpzPAMieTLh690+6Ovp8ffh0Pv28mg1+oN9g92eq13r/cCbncPR1+OT0bD8xqNPM877/3heTf2nwW7dJubH89OA73wYdDbP3z+dPmCmfVxx95aq9+cm6uvdV+9/+ydDfr1ly9yzOWfyk/GHbZYXAHt4rKzvvr204fdvTeAiYuTpOiccbVaujYe59jpYSWTNfevYZ4a5X9cPwESOUtRPPmbdAAAAABJRU5ErkJggg==');
    }
    
  #run
    {color:blue;font-weight:bold}
  #iframe-root
    {border:1px solid lightgray;padding:5px 10px;display:flex;align-items:center;border-radius:5px}
  #iframe-root input
    {margin-left:10px}
  #async-root
    {border:1px solid lightgray;padding:5px 10px;display:flex;align-items:center;border-radius:5px}
  #async-root input
    {margin-left:10px}
    
  #horiz
    {margin-left:50px;border:none}
  #vert
    {border:none}
    
  #view
    {display:flex;flex:1;overflow:hidden}
    
  web-editor
    {width:75%}
    
  output-console
    {flex:1;overflow:auto}
    
  button
    {padding:5px 10px;cursor:pointer;height:30px;font-size:16px}
    
  input[type=checkbox]
    {width:20px;height:20px;margin:0;cursor:pointer}
    
  .visually-hidden
    {position:absolute;width:1px;height:1px;margin:-1px;padding:0;overflow:hidden;clip:rect(0 0 0 0);border:0}
    
            </style>
            
      </head>
      
      
      <body>
      
            <editors-hdr component=grp>
                  <img class=title src='images/js-console.png' style='top:5px;height:35px'>
                  <time slot=date datetime=2025-10-30>30 Oct 2025</time>
            </editors-hdr>
            
            
            <div id=hdr>
            
                  <main-menu component=page></main-menu>
                  
                  <file-mod component></file-mod>
                  
                  <div id=save-root>
                        <button id=save>save</button>
                        <auto-save v2.0 component=grp></auto-save>
                  </div>
                  
                  <publish-ui component></publish-ui>
                  
                  <button id=run>run</button>
                  
                  <div id=iframe-root>
                        <span>
                              iframe
                        </span>
                        <input id=iframe type=checkbox checked>
                  </div>
                  
                  <div id=async-root>
                        <span>
                              async
                        </span>
                        <input id=async type=checkbox checked>
                  </div>
                  
                  <img id=syntax-chk class=icon title=syntax>
                  <img id=prettier class=icon title=prettier>
                  <img id=terser class=icon title=minify>
                  <img id=obfuscator class=icon title=obfuscator>
                  
                  <span class=spc></span>
                  
                  <img id=horiz class=icon src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAPhJREFUSEtjZICChoaGKE5OzvIfP35o/f//nwUmTg2akZHxDwcHx7Xv3793NjQ0LAOZyQgimpubJ/Hz88fZ2dnxKyoqMrCwUNVehj9//jDcv3+f4dChQx8/fvy4qLa2No8R5FMhIaFp8fHx/NS2ED20QA5YuHDhx3fv3mUxdnZ2XnR3d9dTVVWlRqgSNOP27dsMO3fuvMTY2Nj4u6CggIXWvoW5COTrCRMm/AEF9f/S0lKCLqWmgu7uboZRi6kZojjNGg1qugQzyJLRoKZ/UNPNRiSLRksuuoT6aHaiSzCPllx0C2Z4UA9YY2/AmrcD1qAfsC7MQHXaANO37pOxy/mWAAAAAElFTkSuQmCC'>
                  <img id=vert class=icon src='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAAAQxJREFUSEtjZICChoaGKE5OzvIfP35o/f//nwUmTg2akZHxDwcHx7Xv3793NjQ0LAOZyQgimpubJ/Hz88fZ2dnxKyoqMrCwEGdvd3c3Q2lpKUG3/fnzh+H+/fsMhw4d+vjx48dFtbW1eYwgnwoJCU2Lj4/nJ9ZCmE3EWgxTD3LAwoULP7579y6LsbOz86K7u7ueqqoqQZejKyDVYpD+27dvM+zcufMSY2Nj4++CggIWUn0LMoQci0G+njBhwh9QUP8nJp6wBQc5FsMcPGoxSQlsNKiJDS5QSI0mLmJDC6xuNHERG1yjiYvYkIKrG01cxAbZaOIiNqSGeOIasMbegDVvB6xBP2BdmIHqtAEA6MBFop3TQsgAAAAASUVORK5CYII='>
                  
            </div>
            
            <div id=view>
            
                  <web-editor component></web-editor>
                  
                  <div id=page-slider style='width:10px;cursor:ew-resize'></div>
                  
                  <output-console v3.0 component=page></output-console>
                  
            </div>
            
            
            <log-mod component></log-mod>
            
            
            
      </body>
      
      
      <script>
      
      
        var root;
        
        //var autosave;
        
        var iframe;
        
        
        
        var slider      = {};
        
        var ui          = {};
        ui.mode         = 'vert';
        
        var icon        = {};
        
        var btn         = {};
        var mode        = {};
        var on          = {};
        var set         = {};
        
        
        
        async function initdom(rootnode){   //c
                                                                                console.log('initdom');
              root                                  = rootnode;
              
              keydown.initdom();
              menu.add.style();
              
              
              $(root,'#save').onclick               = btn.save;
              
              //var card                              = $(root,'#save-root .menu');
              //$(root,'.menu-icon').onclick          = menu.click(card,false,false);
              
              
              //autosave                              = $(root,'#autosave');
              //autosave.checked                      = false;
              
              
              
              $(root,'#run').onclick                = run;
              mode.iframe                           = $(root,'#iframe');
              mode.async                            = $(root,'#async');
              
              $(root,'#syntax-chk').onclick         = btn.syntax;
              $(root,'#prettier').onclick           = btn.prettier;
              $(root,'#terser').onclick             = btn.terser;
              $(root,'#obfuscator').onclick         = btn.obfuscator;
              
              
              $(root,'#horiz').onclick              = horiz;
              $(root,'#vert').onclick               = vert;
              
              
              var view                              = $('#view');
              ui.root                               = view;
              
              
              slider.node                           = $.slider('web-editor','#page-slider','output-console',slider,ui);
              
              
              await Promise.all([
                    hdr.initdom(),
                    mainmenu.initdom(root),
                    filemod.initdom(root),
                    autosave.initdom(),
                    publish.initdom(root),
                    editor.initdom(view,{mode:'javascript'}),
                    output.initdom(root),
                    log.initdom(),
              ]);
              
              
              
              //ui.setup(view);
              
              
              
              editor.focus();
              
              query();
              
              
        }//initdom
        
        
  //:
  
  
        function focus(){
        
              editor.focus();
              
        }//focus
        
        
        function query(){
        
              var url       = new URL(window.location);
              var params    = url.searchParams;
              
              mode.iframe.checked   = params.has('iframe');
              mode.async.checked    = params.has('async');
              
        }//query
        
        
  //:
  
  
        function kd(e){
        
              if(e.key=='Enter' && e.ctrlKey){
                    e.preventDefault();
                    run();
              }
              
              if(e.key==' ' && e.ctrlKey){
                    e.preventDefault();
                    menu.open();
              }
              
              if(e.key=='s' && e.ctrlKey){
                    e.preventDefault();
                    filemod.save();
              }
              
              if(e.key=='Delete' && e.ctrlKey){
                    e.preventDefault();
                    jsonblob.util.delete()
              }
              
        }//keydown
        
        
  //:
  
  
        btn.save    = function(e){
        
              filemod.save();
              
        }//save
        
        
        btn.syntax    = function(){
        
              var js        = editor.getValue();
              var result    = syntax(js);
              var str       = JSON.stringify(result,null,4);
              if(result.error){
                    log.red(str);
              }else{
                    log.green(str);
              }
              
        }//syntax
        
        
        btn.prettier    = function(){
        
              var js    = editor.getvalue();
              
              var options   = {
                    semi              : true,
                    singleQuote       : true,
                    tabWidth          : 6,
                    useTabs           : false,
                    trailingComma     : 'none',
                    
                    parser            : 'babel',
                    plugins           : prettierPlugins,
              };
              
              var err;
              try{
              
                    js   = prettier.format(js,options);
                    
              }//catch
              catch(err2){
              
                    err   = err2;
                    
              }//catch
              if(err){
                    var error   = err.toString();
                    log.red(error);
                    return;
              }
              
              editor.setvalue(js);
              
        }//prettier
        
        
        btn.terser    = async function(){
        
              var js    = editor.getvalue();
              
              var options   = {
                    compress: {
                          dead_code       : true,
                          drop_console    : true,
                          passes          : 2,
                    },
                    format: {
                          beautify        : false,
                          comments        : false,
                          semicolons      : true
                    }
              };
              
              var err;
              try{
              
                    var result    = await Terser.minify(js,options);
                    
              }
              catch(err2){
              
                    err   = err2;
                    
              }//catch
              if(err){
                    var error   = err.toString();
                    log.red(error);
                    return;
              }
              
              js    = result.code;
              editor.setvalue(js);
              
        }//terser
        
        
        btn.obfuscator    = function(){
        
              var js    = editor.getvalue();
              
              var err;
              try{
              
                    var obfuscated    = obfuscator.obfuscate(js,{
                          compact                 : true,
                          controlFlowFlattening   : true,
                          deadCodeInjection       : true,
                          stringArrayEncoding     : ['base64'],
                          renameGlobals           : true
                    });
                    
              }//try
              catch(err2){
              
                    err   = err2;
                    
              }//catch
              if(err){
                    var error   = err.toString();
                    log.red(error);
                    return;
              }
              
              js    = obfuscated.getObfuscatedCode();
              editor.setvalue(js);
              
        }//obfuscator
        
        
  //:
  
  
        on.change   = function(){
        
              set.favicon(icon.save);
              
        }//change
        
        
        set.title   = function(title){
        
              document.title    = title;
              
        }//title
        
  //:
  
  
        window.addEventListener('message',e=>{console.log(e);
        
              var json    = e.data;
              if(json.sandbox){
                    output.on.message(json);
              }
              
        });
        
        
  //:
  
  
        function source(){
        
              var txt     = editor.getValue();
              
              if(autosave.trim.checked){
                    txt   = autosave.txt.trim(txt);
              }
              
              var blob    = new Blob([txt]);
              return blob;
              
        }//source
        
        
        function complete(file){
                                                                                //console.log('complete',file);
              if(file){
                    editor.filename(file);
                    editor.filename.save.hide();
                    filemod.cur   = file;
                    var title     = file.name||file.filename;
                    set.title(title);
                    set.favicon(icon.def);
              }
              menu.close();
              editor.focus();
              
        }//complete
        
        
        complete.load   = async function(file,blob){
        
              var txt;
              if(typeof blob=='string'){
                    txt   = blob;
              }else{
                    txt   = await blob.text();
              }
              
              editor.clear();
              output.kill();
              editor.setValue(txt,-1);
              complete(file);
              
        }//complete.load
        
        
        complete.save   = function(file,confirm=true){
        
              complete(file);
              
              if(confirm){
                    log.green(file.filename,'saved');
              }
              
        }//save
        
        
  //:
  
  
/*
        window.onmessage    = function(e){
        
              var err;
              try{
              
                    var json    = JSON.parse(e.data);
                    
              }//try
              catch(err2){
              
                    err   = err2;
                    
              }//catch
              if(err){
                    return;
              }
              
              if(!json){
                    return;
              }
              
              var txt   = json.code||json.text||json.txt;
              if(txt){
                    editor.setValue(txt,-1);
              }
              
        }//onmessage
*/


  //:
  
  
        ui.read   = function(){
        
              var txt     = editor.getValue();
              var json    = {v:1,txt};
              return json;
              
        }//read
        
        
        ui.setup    = function(view){
        
              var o   = localStorage.getItem('orientation');
              if(o==='horiz'){
                    horiz();
              }
              view.style.display    = 'flex';
              
        }//setup
        
        
  //:
  
  
        function horiz(){
        
              //localStorage.setItem('orientation','horiz');
              
              ui.mode                     = 'horiz';
              slider.node.style.cursor    = 'ns-resize';
              slider.node.style.width     = '100%';
              slider.node.style.height    = '10px';
              
              view.style.flexDirection    = 'column';
              
              editor.horiz();
              output.horiz();
              editor.focus();
              
        }//horiz
        
        
        function vert(){
        
              //localStorage.setItem('orientation','vert');
              
              ui.mode                     = 'vert';
              slider.node.style.cursor    = 'ew-resize';
              slider.node.style.width     = '10px';
              slider.node.style.height    = '100%';
              
              view.style.flexDirection    = 'row';
              
              editor.vert();
              output.vert();
              editor.focus();
              
        }//vert
        
        
  //:
  
  
        function run(){
                                                                                debug('run');
              if(autosave.checked){
                                                                                debug('autosave');
                    filemod.save();
              }
              
              
              var js    = editor.getValue();
              
              output.run.iframe2(js,{async:mode.async.checked});
              
              
        }//run
        
        
        function syntax(js){
                                                                              console.log('validate');
              var err;
              try{
              
                    var params    = {
                          tolerant      : true,
                          loc           : true,
                          range         : true,
                          
                          ecmaVersion   : 'latest',
                    };
                    
                    var syntax    = espree.parse(js,params);
                                                                              console.log(syntax);
                                                                              
              }//try
              catch(err2){
                                                                              console.log('catch');
                    err   = err2;
                    
              }//catch
              if(err){
                    var index   = err.index-16;
                    var line    = err.lineNumber-1;
                    var col     = err.column;
                    var msg     = err.message;
                    var i       = msg.indexOf(':');
                    msg         = msg.slice(i+1);
                    msg         = [msg];
                    
                    var json    = {
                          error   : true,
                          index   : index,
                          line    : line,
                          col     : col,
                          msg     : msg
                    };
                    return json;
              }//err
              
              var msg     = ['syntax ok'];
              var json    = {
                    error   : false,
                    msg     : msg
              };
              return json;
              
        }//syntax
        
        
  //:
  
  
        icon.save   = 'data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoBAMAAAB+0KVeAAAAKlBMVEX/pQD/////qhH/pAD/rhr/zHH/yGT/wlP//vz/8dn/tjD/+u//6MD/2ZUL9bZAAAAA30lEQVQoz2OQvuWihARUMgUFBRlamRkYlqXBQLoy10Sg4CUGBisgDQLSu3dLXGBeAxRczMBg3ggR3LZqaeMhBquDggzOCMFdxuZAQWYfQQYHuKDELgOQINA0JEFBqCDzSiwqGdiwqGRgYlDAVIksSIpKYyyC28E+ggoi/L5D8AJMkGFZKAyEKcAFjRGAAS6IBsCCzMbGKGpBgkwqLshAASzoOxMFHDEACjJXCKKANmyCYkNI0IEGgs7YBBdjCpowXGBejSq43YCVYSszV1ooEkgrMMhmkL6lhAIUlJZuBAAfSYTf2T2EkwAAAABJRU5ErkJggg==';
        
        
        set.favicon   = function(dataUrl){
        
              $.all('link[rel*="icon"]').forEach(node=>node.remove());
              var link    = document.createElement('link');
              link.rel    = 'icon';
              link.href   = dataUrl;
              document.head.appendChild(link);
              
        }//favicon
        
        
  //:
  
  
        function debug(...args){
        
              if(!df && !obj.df)return;
              args.unshift(`[ ${did} ]`);
              var fmt     = Array.from({length:args.length}).fill('%O').join(' ');
              var args2   = [fmt].concat(args);
              console.groupCollapsed.apply(console,args2);
              console.trace();
              console.groupEnd();
              
        }//debug
        
        
        
      </script>
      
</html>



