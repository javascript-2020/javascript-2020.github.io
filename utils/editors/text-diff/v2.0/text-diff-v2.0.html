


<html>

      <head>
      
            <title>text diff</title>
            <meta name=description content='Compare and highlight differences between two text files instantly with this free online text-diff tool. Fast, secure, and easy to useâ€”no downloads required'>
            
            <base href='https://ext-code.com/utils/editors/text-diff/'>
            <base href='https://javascript-2020.github.io/utils/editors/text-diff/'>
            <link rel=canonical href='https://ext-code.com/utils/editors/text-diff/text-diff.html'>
            
            <meta name=viewport content='width=device-width, initial-scale=1'>
            <link rel=icon type='image/png' href='images/text-diff-favicon.png'>
        

            <script src='https://libs.ext-code.com/js/dom/component/component.js'></script>

            <script init>
                                                                                console.clear();
                                                                                console.log('text-diff-v2.0.html');
                                                                                console.log();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
        var ext;
        var $;
        var datatype;
        var menumod;
        var keydown;
        
        var menu;
        
        var hdr;
        var primary     = {};
        var secondary   = {};
        
        var output;                  
        var log;



  //:


        mod.stack.add   = init;
        
        async function init(){
                                                                                  console.log('init');
                                                                      
          
              //keydown                   = keydown();
              menu                      = menumod();
              
              hdr                       = mod.hdr;
              //mod.menu.main             = mod.menu.main();
              
              primary.filemod           = mod.filemod;
              primary.editor            = mod.editor;
              
              secondary.filemod         = mod.filemod;
              secondary.editor          = mod.editor;
              
              output                    = mod.output;
              log                       = mod.log;
  
          
              hdr.initmod({ext,$,menu,menumod});
              //mod.menu.main.initmod({menumod,editor});
              
              primary.filemod.initmod({ext,$,menu,menumod,complete,log});
              primary.editor.initmod({ext,$,menu});
              
              secondary.filemod.initmod({ext,$,menu,menumod,complete,log});
              secondary.editor.initmod({ext,$,menu});
              
              output.initmod({});
              log.initmod({ext,$});
  
  
              await hdr.init();
              //await mod.menu.main.init();
              await primary.filemod.init();
              await primary.editor.init();
              
              await secondary.filemod.init();
              await secondary.editor.init();
              
              //publish.init();
              
              await output.init();
              await log.init();
  
          //:
          
              window.onfocus            = ()=>primary.editor && primary.editor.focus();
              keydown.add(kd);
              //menu.on.close             = ()=>editor.focus();
  
              
              initdom(document.body);
  
  
        }//init


(async()=>{

        mod.stack.add;
        
        ({ext}    = await import('https://libs.ext-code.com/js/io/ext-loader/ext-loader.m.js'));
          
        var promise   = ext.load.libs(
              'js/dom/$.js',
              'js/core/datatype.js',
              'js/dom/menumod/menumod.js',
              'js/dom/keydown/keydown.js'
        );
        [$,datatype,menumod,keydown]   = await promise;
  
        mod.stack.complete;
              
})();


            </script init>


            <link rel=stylesheet href='/utils/css/utils.css'>
            
            <style>
            
  :root
    {--red:rgba(209,153,153,0.5);--green:rgba(153,204,153,0.5)}
  
  html
    {height:100%;font-family:arial}
  body
    {display:flex;flex-direction:column;height:calc(100% - 40px);margin:20px}

    
  input
    {font-size:16px;padding:5px;cursor:pointer}
  
  #hdr
    {padding:5px 5px;height:30px;display:flex;align-items:center;gap:10px}
    
  .icon
    {border:1px solid gray;border-radius:3px;box-sizing:border-box;width:30px;height:30px;cursor:pointer}
  .spc
    {flex:1}

  
  #run
    {color:blue;font-weight:bold}
  #horiz
    {margin-left:50px;border:none}
  #vert
    {border:none}
  
  
  
  #main
    {display:flex;flex:1;margin:5px 0}
    
  #view1
    {flex:1;display:flex;flex-direction:column;border:1px solid var(--green)}
    
  #view2
    {flex:1;display:flex;flex-direction:column;border:1px solid var(--red)}
    
    
  #hdr
    {display:flex;align-items:center;padding:5px}
    
  #label
    {flex:1;text-align-center}
    
  editor-root
    {flex:1;border-top:1px solid lightgray}
    
  output-root
    {flex:1;border:1px solid lightgray;overflow:auto;margin:0}

  
  .red
    {position:absolute;background:var(--red);z-index:20}
  .green
    {position:absolute;background:var(--green);z-index:20}

    
            </style>
            
      </head>

      
      <body>

            <hdr component=grp v2.0>
                  <img class=title src='images/text-diff.png' style='top:5px;height:35px'>
                  <span slot=date>24 Aug 2025</span>
            </hdr>

            
            <input type=button value=check>
            
            <div id=main>
                  <div id=view1>
                        <div id=hdr>
                              <filemod component v2.0></filemod>
                              <div id=label>primary</div>
                        </div>
                        <editor component v2.0></editor>
                  </div>
                  <div id=view2>
                        <div id=hdr>
                              <filemod component v2.0></filemod>
                              <div id=label>secondary</div>
                        </div>
                        <editor component v2.0></editor>
                  </div>
            </div>
            
            
            <output component=page v2.0></output>

            
            <log  component v2.0></log>



            <checkbox-one-template>
                  <script src='https://html-loader-1024713184986.us-central1.run.app/'></script>
            </checkbox-one-template>


      </body>        
            
            
      <script>


        var slider      = {};
        
        var ui          = {};
        ui.mode         = 'vert';


  //:
  
  
        function initdom(rootnode){
                                                                                console.log('initdom');
              var root                      = rootnode;
              
              keydown.initdom();
        
        
              hdr.initdom();
        
              
              //mod.menu.main.initdom();
        
              
              var view1                     = $('#view1');
              primary.filemod.initdom(view1);
              primary.editor.initdom(view1);
              
              var view2                     = $('#view2');
              secondary.filemod.initdom(view2);
              secondary.editor.initdom(view2);
              
  
  
              
        }//initdom


  //:

  
        function kd(e){

              if(e.key=='Enter' && e.ctrlKey){
                    e.preventDefault();
                    run();
              }

              if(e.key==' ' && e.ctrlKey){
                    e.preventDefault();
                    menu.open();
              }

              if(e.key=='s' && e.ctrlKey){
                    e.preventDefault();
                    filemod.save();
              }

              if(e.key=='Delete' && e.ctrlKey){
                    e.preventDefault();
                    jsonblob.util.delete()
              }
              
        }//keydown

  
  //:


        function complete(file){
        
              editor.filename(file);
              editor.filename.save.hide();
              filemod.cur   = file;
              menu.close();
              editor.focus();
              
        }//complete

        
        complete.load   = function(file,txt){
        
              editor.clear();
              output.kill();
              editor.setValue(txt,-1);
              complete(file);
              
        }//complete.load

        
        complete.save   = function(file,confirm=true){

              complete(file);
              
              if(confirm){
                    log.green(file.filename,'saved');
              }
              
        }//save

  
  //:


        function check(){
        
              var txt1        = editor['1'].getValue();
              var txt2        = editor['2'].getValue();
              var d           = diff.diffChars(txt2,txt1);
              console.log(d);
              
              var list    = [];
              var txt     = '';
              d.forEach(part=>{
              
                    var start   = txt.length;
                    txt        += part.value;
                    var end     = txt.length;
                    var color   = part.added ? 'green' : part.removed ? 'red' : 'grey';
                    if(color!='grey'){
                          list.push({start,end,color});
                    }
                    
              });
              editor.output.setValue(txt,-1);
              list.forEach(part=>{
              
                    var start   = editor.output.getSession().doc.indexToPosition(part.start);
                    var end     = editor.output.getSession().doc.indexToPosition(part.end);
                    var range   = new ace.Range(start.row,start.column,end.row,end.column);
                    editor.output.getSession().addMarker(range,part.color,'text');
                    
              });
        
        }//check




      
      </script>


</html>






