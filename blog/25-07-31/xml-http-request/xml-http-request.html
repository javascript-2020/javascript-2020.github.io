

<!-- headers
      cross-origin-isolate
-->


<!DOCTYPE html>


<html>

      <head>
            <meta charset=utf-8>
      
            <title>
                  Using XMLHttpRequest in Modern JavaScript
            </title>

            <meta name=description content='Learn how to use XMLHttpRequest to send and receive HTTP requests in JavaScript. This guide covers setup, request methods, response handling, and practical examples for AJAX-style communication.'>
            
            <base href='https://ext-code.com/blog/25-07-31/xml-http-request/'>
            <link rel=canonical href='https://ext-code.com/blog/25-07-31/xml-http-request/xml-http-request.html'>
            
            <link rel=icon type='image/png' href='/blog/image/blog-30.png'>
            <meta name=viewport content='width=device-width, initial-scale=1'>
            
            <script type='application/ld+json'>
                  {
                        "@context"            : "https://schema.org",
                        "@type"               : "TechArticle",
                        "headline"            : "Using XMLHttpRequest in Modern JavaScript",
                        "description"         : "Learn how to use XMLHttpRequest to send and receive HTTP requests in JavaScript. This guide covers setup, request methods, response handling, and practical examples for AJAX-style communication.",
                        "author"              : {"@type":"Person","name":"Matthew Richards"},
                        "datePublished"       : "2025-07-31",
                        "dateModified"        : "2025-10-22",
                        "mainEntityOfPage"    : {"@type":"WebPage","@id":"https://ext-code.com/blog/25-07-31/xml-http-request/xml-http-request.html"},
                        "publisher"           : {"@type":"Organization","name":"Your Blog or Company Name","logo":{"@type":"ImageObject","url":"https://ext-code.com/favicon.ico"}},
                  }
            </script>


            <script src='https://ajaxorg.github.io/ace-builds/src-noconflict/ace.js'></script>


            <script src='https://libs.ext-code.com/js/dom/component/component.js'></script>

            <script init>
                                                                                console.clear();
                                                                                console.log('xml-http-request.html');
                                                                                console.log();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
        var df=true,version='v2.0'
        ;


        var ace;
        var jszip;


        var ext;
        var $;
        var datatype;
        var menumod;
        var keydown;
        var debug;
        var sandbox;

        var menu;
            
        var ex        = {};

        var terminal;
        var webconsole;
        var log;

        

    //:

              
        async function init(){
                                                                                //debug('init',version);
              

              menu    = menumod();


              ex['xhr-upload']          = mod['xhr-upload'];
              ex['upload-server']       = mod['upload-server'];
              ex['xhr-download']        = mod['xhr-download'];
              ex['download-server']     = mod['download-server'];
              terminal                  = mod['web-terminal']
              webconsole                = mod['web-console'];
              log                       = mod['log-mod'];
              
              ex['xhr-upload'].initmod({ext,$,menu,ace});
              ex['upload-server'].initmod({ext,$,menu,ace});
              ex['xhr-download'].initmod({ext,$,menu,ace});
              ex['download-server'].initmod({ext,$,menu,ace});
              terminal.initmod({ext,$,menu});
              webconsole.initmod({ext,$,menu,ace});
              log.initmod({ext,$});

              await Promise.all([
                    ex['xhr-upload'].init(),
                    ex['upload-server'].init(),
                    ex['xhr-download'].init(),
                    ex['download-server'].init(),
                    terminal.init(),
                    webconsole.init(),
                    log.init(),
              ]);
                


              initdom(document.body);

              
        }//init


  //:
  
  
(async()=>{

        mod.stack.add;
        
        ({ext}    = await import('https://libs.ext-code.com/js/io/ext-loader/ext-loader.m.js'));
          
        var promise   = ext.load.libs(
              'js/dom/$.js.api',
              'js/core/datatype.js',
              'js/dom/menumod/menumod.js',
              'js/dom/keydown/keydown.js',
              'js/debug/debug.js',
        );
        [$,datatype,menumod,keydown,debug]   = await promise;
  
        await Promise.all([
              import('https://cdn.jsdelivr.net/npm/jszip/+esm').then(mod=>jszip=mod.default),
              ext.load.libs('js/sandbox/sandbox.js.api').then(result=>[sandbox]=result),
              /*
              ext.text.libs('nodejs/server-cert/server-cert.js').then(result=>{
                
                    files['node_modules'].directory['server-cert.js']   = {file:{contents:result[0]}};
                    
              })
              */
              
        ]);

        mod.stack.complete;
              
})();

            
            </script init>


            <link rel=stylesheet href='/blog/css/blog.css'>

            <style>
            
  html
    {height:100%;font-family:arial}
  body
    {min-height:calc(100% - 40px);display:flex;flex-direction:column;gap:20px;margin:20px;align-items:center;
      padding-bottom:200px;
    }
  body>*
    {max-width:1400px;width:100%}
    
  [component]
    {display:none}
    
  .description 
    {max-width:1000px;text-align:justify;border-left:4px solid #4a90e2;padding:1rem 2rem;
      background-color:#f9f9f9;font-family:system-ui,sans-serif;font-size:1rem;line-height:1.6;color:#333}
  .description>p
    {margin:0}
  .description > p+p
    {margin:10px 0}

  code
    {font-family:monospace;background:whitesmoke}
  code.inline
    {display:inline;padding:5px 10px}

  a
    {color:#4a90e2;text-decoration:none;font-weight:500}
  a:hover 
    {text-decoration:underline}
  .link-domain
    {font-size:0.85rem;color:#777;margin-left:0.25rem}
  .link-domain::before 
    {content:'['}
  .link-domain::after
    {content:']'}
  .link-txt
    {}

  input
    {font-size:16px;padding:5px 7px;box-sizing:border-box;}
  input[type=button]
    {cursor:pointer}

      
  .flex-col
    {display:flex;flex-direction:column;gap:20px}
  
  #demo
    {border:2px solid green;padding:20px;margin-bottom:50px}
  #demo>div:first-of-type
    {display:flex;justify-content:space-between}
    
  #view
    {display:flex;flex-direction:column;gap:20px}
  #view>div
    {display:flex;border:1px solid lightgray;border-radius:10px;padding:10px}
  #view>div>div:first-of-type
    {width:200px}
  #view>div>div:nth-of-type(2)
    {width:200px}
  #view>div>div:last-of-type
    {flex:1}

  iframe
    {width:100%;height:250px;border:1px solid gray}


  .file
    {border:2px solid #4a90e2;padding:10px}

  .filename
    {background:whitesmoke;padding:5px 10px;margin-bottom:10px;display:flex;justify-content:space-between}
    
            </style>
            
      </head>
      
      
      <body>

            <blog-hdr component=grp1>
                  <h1 class=title>
                        Using XMLHttpRequest in Modern JavaScript
                  </h1>
                  <time slot=date datetime=2025-10-23>
                        23 Oct 2025
                  </time>
            </blog-hdr>

            <div class=description>
                  <p>
                        Learn how to use XMLHttpRequest to send and receive HTTP requests in JavaScript. This guide covers setup, request methods, response handling,
                        and practical examples for AJAX-style communication.
                  </p>
            </div>
            <div class=description>
                  <p>
                        In the Browser (Dev Tools)<br>
                        Most modern browsers let you throttle network speed:<br>
                        Chrome / Edge / Firefox<br>
                        1. 	Open DevTools (F12 or right-click → Inspect).<br>
                        2. 	Go to the Network tab.<br>
                        3. 	Find the Throttling dropdown (usually top-left).<br>
                        4. 	Choose a preset like:<br>
                        • 	Slow 3G<br>
                        • 	Fast 3G<br>
                        • 	Or create a custom profile<br>
                        This affects all network requests, including XMLHttpRequest, fetch and image loads.<br>
                  </p>
            </div>
            <div class=description>
                  <p>
                        At the time of writing these examples are not working well in web containers, the onprogress events are not firing.
                        The code can be downloaded and run locally to see them working, the files are editable and runnable.
                  </p>
            </div>

            <div id=demo class=flex-col>
                  <div>
                        demo
                        <input value=download type=button>
                  </div>
                  
                  <div id=view>
                  
                        <div upload-server-root>
                              <div>
                                    upload-server.js
                              </div>
                              <div>
                                    <input value=run type=button>
                              </div>
                              <div></div>
                        </div>
      
                        <div xhr-upload-root>
                              <div>
                                    xhr-upload.html
                              </div>
                              <div>
                                    <input value=run type=button>
                              </div>
                              <div>
                                    <iframe></iframe>
                              </div>
                        </div>
      
                        <div download-server-root>
                              <div>
                                    download-server.js
                              </div>
                              <div>
                                    <input value=run type=button>
                              </div>
                              <div></div>
                        </div>
                        
                        <div xhr-download-root>
                              <div>
                                    xhr-download.html
                              </div>
                              <div>
                                    <input value=run type=button>
                              </div>
                              <div>
                                    <iframe></iframe>
                              </div>
                        </div>
                        
                  </div view>
      
                  <web-terminal component></web-terminal>
                  <web-console component></web-console>
            </div demo>


            
            <div>
                  files
            </div>
            
            <div xhr-upload class=file>
                  <div class=filename>
                        <span>
                              xhr-upload.html
                        </span>
                        <span id=hash>
                        </span>
                  </div>
                  <web-editor id=xhr-upload fullsize mode=html src='ex/xhr-upload.html' component></web-editor>
            </div>
      
            
            <section class=file>
                  <div class=filename>
                        upload-server.js
                  </div>
                  <web-editor id=upload-server fullsize src='ex/upload-server.js' component></web-editor>
            </section>


            <section class=file>
                  <div class=filename>
                        xhr-download.html
                  </div>
                  <web-editor id=xhr-download fullsize mode=html src='ex/xhr-download.html' component></web-editor>
            </section>


            <section class=file>
                  <div class=filename>
                        download-server.js
                  </div>
                  <web-editor id=download-server fullsize src='ex/download-server.js' component></web-editor>            
            </section>
            
            
            
            <log-mod component></log-mod>

      </body>


      <script>
      
        var wc        = {};
        var process   = {};
        var urls      = {};
        var iframe    = {};

        
        var files   = {};
        files['node_modules']   = {directory: {}};
        /*
        files['.jshrc']         = {file:{contents:`
                                        export NODE_PATH=./node_modules
                                  `}};
        */                                  

        var download    = {};
        var dir         = {};
        download['xml-http-request']    = {directory:dir};
        dir['xhr-upload.html']          = {file:{github:{repo:'javascript-2020.github.io',path:'/blog/25-07-31/xml-http-request/ex/xhr-upload.html'}}};
        dir['upload-server.js']         = {file:{github:{repo:'javascript-2020.github.io',path:'/blog/25-07-31/xml-http-request/ex/upload-server.js'}}};
        dir['xhr-download.html']        = {file:{github:{repo:'javascript-2020.github.io',path:'/blog/25-07-31/xml-http-request/ex/xhr-download.html'}}};
        dir['download-server.js']       = {file:{github:{repo:'javascript-2020.github.io',path:'/blog/25-07-31/xml-http-request/ex/download-server.js'}}};

        
        var btn                     = {};
        

  //:
  
  
        function initdom(rootnode){


              ex['upload-server'].initdom();
              ex['xhr-upload'].initdom();
              ex['download-server'].initdom();
              ex['xhr-download'].initdom();
              

              $('#demo>div:first-of-type [value=download]').onclick   = btn.demo_download;

              
              $('[xhr-upload-root] [value=run]').onclick            = btn['xhr-upload'];
              iframe['xhr-upload']                                  = $('[xhr-upload-root] iframe');
              var txt                                               = ex['xhr-upload'].getvalue();
              sha256(txt).then(hex=>$('[xhr-upload].file #hash').textContent=`sha256 : ${hex}`);
              
              $('[upload-server-root] [value=run]').onclick         = btn['upload-server'];
              
              $('[xhr-download-root] [value=run]').onclick          = btn['xhr-download'];
              iframe['xhr-download']                                = $('[xhr-download-root] iframe');
              
              $('[download-server-root] [value=run]').onclick       = btn['download-server'];

              
              
              
              terminal.initdom();
              terminal.height   = 200;
              
              webconsole.initdom();
              log.initdom();
          
          
        }//initdom
        
        
        window.addEventListener('message',e=>{
          
              var key   = Object.keys(iframe).find(k=>iframe[k].contentWindow===e.source);
              if(!key)return;

              var {type,args}   = e.data;
              args.unshift(`[ ${key} ]`);
              webconsole[type].apply(null,args);

        })//onmessage

        
  //:
  
  
        btn.demo_download    = async function(){
          
              create_archive(download,{df:true});
              
        }//demo_download
        
  
        btn['upload-server']    = async function(){
          
              if(process['upload-server']){
                                                                                webconsole.log('kill existing upload-server ...');
                    await process['upload-server'].kill();
                    process['upload-server']    = null;
                                                                                webconsole.log('ok');
              }

              
              var on    = {};
              
              on.init   = async function({webcontainer}){
                
                    wc['upload-server']   = webcontainer;
                                                                                webconsole.log('mount file system ...');
                    await webcontainer.mount(files);
                                                                                webconsole.log('ok');
              }//init
              
              on['server-ready']    = function({port,url}){
                                                                                webconsole.log('upload-server ready',url);
                    urls['upload-server']   = url;
                    
              }//server-ready
              
              on.run    = function({process:p}){
                
                    process['upload-server']    = p;
                    
              }//run
              
              on.complete   - function({code}){
              }//complete

              
              var js    = ex['upload-server'].getvalue();
              sandbox.nodejs(js,{console:webconsole,ctx:{terminal},on});
              
        }//upload-server
        

        btn['xhr-upload']   = async function(){
          
              if(!process['upload-server']){
                    var msg   = 'upload-server not started';
                                                                                webconsole.log(msg);
                    log.red(msg);
                    return;
              }
              
              iframe['xhr-upload'].src    = 'about:blank';              
              
              var html    = ex['xhr-upload'].getvalue();
              html        = inject+html;
              
              await wc['upload-server'].fs.writeFile('xhr-upload.html',html);
              
              iframe['xhr-upload'].src    = `${urls['upload-server']}/xhr-upload.html`;
              
        }//run
        
  
        btn['download-server']    = async function(){
          
              if(process['download-server']){
                                                                                webconsole.log('kill existing download-server ...');
                    await process['download-server'].kill();
                    process['download-server']    = null;
                                                                                webconsole.log('ok');
              }

              
              var on    = {};
              
              on.init   = async function({webcontainer}){
                
                    wc['download-server']   = webcontainer;
                                                                                webconsole.log('mount file system ...');
                    await webcontainer.mount(files);
                                                                                webconsole.log('ok');
              }//init
              
              on['server-ready']    = function({port,url}){
                                                                                webconsole.log('download-server ready',url);
                    urls['download-server']   = url;
                    
              }//server-ready
              
              on.run    = function({process:p}){
                
                    process['download-server']    = p;
                    
              }//run
              
              on.complete   - function({code}){
              }//complete

              
              var js    = ex['download-server'].getvalue();
              sandbox.nodejs(js,{console:webconsole,ctx:{terminal},on});
              
        }//download-server
        
        
        btn['xhr-download']   = async function(){
          
              if(!process['download-server']){
                    var msg   = 'download-server not started';
                                                                                webconsole.log(msg);
                    log.red(msg);
                    return;
              }
              
              iframe['xhr-download'].src    = 'about:blank';              
              
              var html    = ex['xhr-download'].getvalue();
              html        = inject+html;
              
              await wc['download-server'].fs.writeFile('xhr-download.html',html);
              
              iframe['xhr-download'].src    = `${urls['download-server']}/xhr-download.html`;
              
        }//xhr-download
        
        
  //:
  
  
        var inject    = `
        
              <script>
                    
                    var con   = window.console;
                    window.console    = {
                          log     : (...args)=>window.parent.postMessage({type:'log',args},'*'),
                          warn    : (...args)=>window.parent.postMessage({type:'warn',args},'*'),
                          error   : (...args)=>window.parent.postMessage({tyoe:'error',args},'*'),
                    };
                    
              </scr`+`ipt>
              
        `;
        
        async function sha256(txt) {
          
              var msg   = new TextEncoder().encode(txt);
              var buf   = await crypto.subtle.digest('SHA-256',msg);
              var arr   = Array.from(new Uint8Array(buf));
              var hex   = arr.map(b=>b.toString(16).padStart(2,'0').toUpperCase()).join('');
              return hex;
              
        }//sha256


  //:

  
        async function create_archive(dir,{download=true,test,df=false}={}){
                                                                                df && console.log('download',!!download);
                                                                                df && console.log('test',!!test);
                                                                                df && console.json(dir);
                                                                                df && console.log();
              var zip;
              if(!test){
                    zip   = new jszip();
              }
              
              var resolve,promise=new Promise(res=>resolve=res);
              var ct=0,total=0;
              add(dir);
              await promise;
              
              var blob;
              if(zip){
                    blob      = await zip.generateAsync({type:'blob'});
                    
                    if(download){
                          var url       = window.URL.createObjectURL(blob);
                          var a         = document.createElement('a');
                          a.download    = 'https-file-server';
                          a.href        = url;
                          a.click();
                    }
              }
              return blob;
              
        
              async function add(dir,abs=''){
                
                    for(let key in dir){
                      
                          ct++;
                          var o   = dir[key];
                          
                          if(o.directory){
                                                                                df && console.log('dir :',abs+key);
                                if(zip){
                                      zip.folder(abs+key);
                                }
                                add(o.directory,abs+key+'/');
                                complete();
                          }

                          if(o.file?.contents){
                                                                                df && console.log('file create :',abs+key);
                                if(zip){
                                      zip.file(abs+key,o.file.contents);
                                }
                                complete();
                          }
                          
                          if(o.file?.github){
                                var owner,repo,branch,path;
                                if(typeof o.file.github=='string'){
                                      path    = o.file.github;
                                }else{
                                      ({owner,repo,branch,path}    = o.file.github);
                                }
                                owner     ||= 'javascript-2020';
                                repo      ||= 'libs';
                                branch    ||= 'main';
                                if(path.startsWith('/')){
                                      path    = path.slice(1);
                                }
                                                                                df && console.log('file github :',abs+key);
                                                                                df && console.log(owner,repo,branch,path);
                                if(zip){
                                      fetch(`https://raw.githubusercontent.com/${owner}/${repo}/${branch}/${path}`)
                                        .then(res=>res.text().then(txt=>{
                                          
                                              zip.file(abs+key,txt);
                                              complete();
                                              
                                        }));
                                }
                          }
                          
                          
                    }//for

                    
                    function complete(){
                      
                          total++;
                          if(ct==total){
                                resolve();
                          }
                          
                    }//complete
                    
              }//add

        }//create
  
        
      </script>
      
</html>




