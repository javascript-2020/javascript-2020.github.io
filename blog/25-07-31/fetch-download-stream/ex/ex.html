
      <style>
      </style>
      
      <div id=root>
      
            <div>
                  encoding
                  <span id=encoding></span>
            </div>
            <div>
                  content-length
                  <span id=content-length></span>
            </div>
            <div id=progress>
                  <div id=bar></div>
            </div>
            
      </div>


      <script>

(async()=>{
console.clear();

  
        var url       = 'https://raw.githubusercontent.com/javascript-2020/external/main/ffmpeg/ffmpeg-wasm/ffmpeg-wasm.zip'
        
        
        //var url   = 'https://cdn.jsdelivr.net/gh/javascript-2020/libs/js/io/tiny-unzip/tiny-unzip.m.js';
        
        var headers   = {};
        var method    = 'get';
        var body      = undefined;
        
        var res       = await fetch(url,{headers,method,body});
        
        var encoding    = res.headers.get('content-encoding')?.toLowerCase();
        if(encoding && encoding!=='identity'){
              console.log('unable to reliably computer content-length');
        }
        var len       = res.headers.get('content-length');
        console.log(len);
        var total     = 0;
        var reader    = res.body.getReader();
        var chunks    = [];
        while(true){
        
              const {value,done}    = await reader.read();
              if(done)break;
                                                                                total  += value.length;
                                                                                console.log('chunk',datatype(value),value.byteLength,total,(total/len*100).toFixed(1)+' %');
              chunks.push(value);
                                                                          
        }//while
        var total     = chunks.reduce((acc,chunk)=>acc+chunk.length,0);
        var buf       = new Uint8Array(total);
        var offset    = 0;
        for(var chunk of chunks){
                                            
              buf.set(chunk,offset);
              offset   += chunk.length;
              
        }//for
        var blob    = new Blob([buf],{type:'application/octet-stream'});
        console.log(blob);
        
        
        
        function datatype(v){return Object.prototype.toString.call(v).slice(8,-1).toLowerCase()}
        
})();


      </script>