

<!DOCTYPE html>

<html lang=en>

      <head>
            <meta charset=utf-8>
            
            <title>
                  Bypassing Content-Security-Policy for Websites
            </title>
            
            <meta name=description content='Discover how to overcome the content-security-policy for a website.'>
            
            <base href='https://ext-code.com/blog/25-12-04/bypass-csp/'>
            <link rel=canonical href='https://ext-code.com/blog/25-12-04/bypass-csp/bypass-csp.html'>
            
            <link rel=icon type='image/png' href='data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAMAAAAM7l6QAAABLFBMVEVHcEwopnMfpm8epm4epm4hpm81pHgfpm8ipnAhpm8ipnAfpm8gpm8jpnAsquAqpXQhpnAjpnEspXQhpnDr3Mgtqt8epm8fpm8kpnEgpm8rpXPr6OkqquAqquEjpnF/xagnqHTr6OlUtY7m5ubm5ub/9//m5uYbpWyXzLZ1s4UPnmRbqrkdpm7m5ubp5+gbpm0bpWwsq3fC29GXzbaMyrEwrOFHtIYnquHb4+Cz1uUkp3LT4ebi5ejwhhL3jhj7mSO72eXkhB12w+T4pDd8xafF3NKfijLWsrDc3diHlIzyr07et4jq07fqmkfhqFfyv3dauuJnveE2rn1AnFltkULIx8dQomPMfxXvjbNuo4xylYXu0KZqr7fOwrFaueL9yoTI1MatqHQwqtqDrqPS97zrAAAALHRSTlMAHtX5958F0l+Pfe2lXa4QgGAPjf6b8fBbzw9Y0L1h6t3NR9HhDPzLh/QusFA6UqkAAAGESURBVCjPdZNnW8IwEIDTtKVQKHsj7u21RUVREBFQ2SjuPf//fzBt0gFPfT+0z9M3vVwudwhZcLEQzvB8Bof8HJqFi2IeGLwkTy/w+TFMgRWfYyMBAfSShW54IZG3bFwEqJ6XLRYWzQBinEUOAOi7F5rF0rJErA4JGl8RDL2nqYyVte2Nau+lKmTNnI2s3Hq1UNjc6jz1ABv5yzCj1XU12R93nnWQyc+SrdneZMFVo35ZBZA4pPCWrh1Tatpr+/Tx1qhPFonAtNo6oLSS/Ubzjh4OSZY+ua5QJkbokvk5h4IuPZcqhsPF3/Zp88EsHQQRb+sPosOp8M64UR8c0r8FR9O9Kz/fjfqoa2s7uFY7I0zeSOjhEdNBJzV67trX52igWTrnHIxV7X2YVG0tuspC9X2XPJgmZXEV1cR8MU2K6nEltpadC3XagUC1eaHIT9qBNNO+i/INqZqg2M3kBWsmFBG9rJh3GpmflUIi7hqD2OwY+H3/DxGOekzZfAinAdI4FHPkH67FfQ17kRvyAAAAAElFTkSuQmCC'>
            <meta name=viewport content='width=device-width, initial-scale=1'>
            
            <script type='application/ld+json'>
                  {
                        "@context"            : "https://schema.org",
                        "@type"               : "TechArticle",
                        "headline"            : "Bypassing Content-Security-Policy for Websites",
                        "description"         : "Discover how to overcome the content-security-policy for a website.",
                        "author"              : {"@type":"Person","name":"Matthew Richards"},
                        "datePublished"       : "2025-11-15",
                        "dateModified"        : "2025-11-15",
                        "mainEntityOfPage"    : {"@type":"WebPage","@id":"https://ext-code.com/blog/25-12-04/bypass-csp/bypass-csp.html"},
                        "publisher"           : {"@type":"Organization","name":"ext-code.com","logo":{"@type":"ImageObject","url":"https://ext-code.com/favicon.ico"}},
                  }
            </script>
            
            <script src='https://ajaxorg.github.io/ace-builds/src-noconflict/ace.js'></script>
            
            
            <script src='https://libs.ext-code.com/js/dom/component/v3.0/component.js'></script>
            
            <script init>
                                                                                console.clear();
                                                                                console.log('bypass-csp.html');
                                                                                console.log();
                                                                                console.json=v=>console.log(JSON.stringify(v,null,4));
        var df=true,version='v2.0'
        ;
        
        var ace;
        
        var ext;
        var $;
        var datatype;
        var menumod;
        var keydown;
        var debug;
        
        var menu;
        
        var hdr;
        var log;
        var ex    = {};
        
        
  //:
  
  
        async function init(){
        
              menu                            = menumod();
              
              mod.base.add({ext,$,datatype,keydown,menu,menumod,ace});
              
              
              hdr                             = mod['blog-hdr'];
              log                             = mod['log-mod'];
              
              hdr.initmod({ext,$});
              log.initmod({ext,$});
              
              ex['firefox-manifest']          = mod['firefox-manifest'];
              ex['firefox-manifest'].initmod({ext,$,menu,menumod,ace});
              ex['firefox-extension']         = mod['firefox-extension'];
              ex['firefox-extension'].initmod({ext,$,menu,menumod,ace});
              
              ex['chrome-manifest']           = mod['chrome-manifest'];
              ex['chrome-manifest'].initmod({ext,$,menu,menumod,ace});
              ex['chrome-extension']          = mod['chrome-extension'];
              ex['chrome-extension'].initmod({ext,$,menu,menumod,ace});
              
              ex['ws-server']                 = mod['ws-server'];
              ex['ws-server'].initmod({ext,$,menu,menumod,ace});
              ex['ws-client']                 = mod['ws-client'];
              ex['ws-client'].initmod({ext,$,menu,menumod,ace});
              
              ex['proxy']                     = mod['proxy'];
              ex['proxy'].initmod({ext,$,menu,menumod,ace});
              ex['test']                      = mod['test'];
              ex['test'].initmod({ext,$,menu,menumod,ace});
              
              ex['ext-js-manifest']           = mod['ext-js-manifest'];
              ex['ext-js-manifest'].initmod({ext,$,menu,menumod,ace});
              ex['ext-js-extension']          = mod['ext-js-extension'];
              ex['ext-js-extension'].initmod({ext,$,menu,menumod,ace});
              ex['ext-js-cs']                 = mod['ext-js-cs'];
              ex['ext-js-cs'].initmod({ext,$,menu,menumod,ace});
              ex['ext-js-popup-html']         = mod['ext-js-popup-html'];
              ex['ext-js-popup-html'].initmod({ext,$,menu,menumod,ace});
              ex['ext-js-popup-js']           = mod['ext-js-popup-js'];
              ex['ext-js-popup-js'].initmod({ext,$,menu,menumod,ace});
              
              
              
              await Promise.all([
                    hdr.init(),
                    log.init(),
                    
                    ex['firefox-manifest'].init(),
                    ex['firefox-extension'].init(),
                    ex['chrome-manifest'].init(),
                    ex['chrome-extension'].init(),
                    ex['ws-server'].init(),
                    ex['ws-client'].init(),
                    ex['proxy'].init(),
                    ex['test'].init(),
                    ex['ext-js-manifest'].init(),
                    ex['ext-js-extension'].init(),
                    ex['ext-js-cs'].init(),
                    ex['ext-js-popup-html'].init(),
                    ex['ext-js-popup-js'].init(),
                    
              ]);
              
              
              initdom(document.body);
              
              
        }//init
        
        
(async()=>{

        mod.stack.add;
        
        ({ext}   = await import('https://libs.ext-code.com/js/io/ext-loader/ext-loader.m.js'));
        
        var promise   = ext.load.libs(
              'js/dom/$.js',
              'js/core/datatype.js',
              'js/dom/menumod/menumod.js',
              'js/dom/keydown/keydown.js',
              'js/debug/debug.js',
        );
        
        [$,datatype,menumod,keydown,debug]    = await promise;
        
        mod.stack.complete;
        
})();

            </script init>
            
            
            <link rel=stylesheet href='https://fonts.googleapis.com/css2?family=Pacifico&display=swap' crossorigin=anonymous>
            <link rel=stylesheet href='/blog/css/blog.css'>
            
            <style>
            
            
            
  html
    {height:100%;font-family:arial}
  body
    {min-height:calc(100% - 40px);display:flex;flex-direction:column;gap:20px;margin:20px;align-items:center;
      padding-bottom:200px;
    }
  body>*
    {max-width:1400px;width:100%}
    
  [component]
    {display:none}
    
  .description
    {max-width:1200px;text-align:justify;border-left:4px solid #4a90e2;padding:1rem 2rem;
      background-color:#f9f9f9;font-family:system-ui,sans-serif;font-size:1rem;line-height:1.6;color:#333}
  .description>p
    {margin:0}
  .description > p+p
    {margin:10px 0}
    
    
  .blog-hdr
    {color:blue}
    
  .blog-text
    {margin:1.5rem auto;padding:1.25rem 1.75rem;background-color:#fcfcfc;/*#f9f9f9*/font-family:system-ui, sans-serif;font-size:1rem;line-height:2;
      color:#333;text-align:justify;border-radius:4px}
  .blog-text h2,.blog-text h3
    {margin-top:1.5rem;margin-bottom:0.75rem;font-weight:600;color:#222;display:flex}
  .blog-text p
    {margin:0 0 1rem 0;}
    
    
    
  .spc
    {flex:1}
    
    
    
    
  code
    {font-family:monospace;background:whitesmoke}
  code.inline
    {display:inline;padding:5px 10px}
    
    
    
  a
    {color:#4a90e2;text-decoration:none;font-weight:500}
  a:hover
    {text-decoration:underline}
  .link-domain
    {font-size:0.85rem;color:#777;margin-left:0.25rem}
  .link-domain::before
    {content:'['}
  .link-domain::after
    {content:']'}
  .link-txt
    {}
    
  input
    {font-size:16px;padding:5px 7px;box-sizing:border-box;}
  input[type=button]
    {cursor:pointer}
    
    
  snippet-editor,web-editor
    {margin:30px 0;display:block}
    
    
  .icon
    {border:1px solid gray;border-radius:3px;box-sizing:border-box;width:30px;height:30px;cursor:pointer}
    
  blog-hdr h1
    {font-family:pacifico}
    
  .br
    {margin-top:0.8em}
    
            </style>
            
      </head>
      
      
      <body>
      
      
            <blog-hdr component=grp1>
                  <h1 class=title style='position:absolute;left:0;right:0;margin:auto;top:-10px'>
                       Bypassing Content-Security-Policy for Websites
                  </h1>
                  <time slot=date datetime=2025-12-03>
                        04 Dec 2025
                  </time>
            </blog-hdr>
            
            
            <div class=description>
                  <p>
                        I was in the process of answering this question
                        <br>
                        <div class=br></div>
                        <a href='https://stackoverflow.com/questions/79833235/is-it-possible-to-connect-to-a-local-python-server-using-secure-web-sockets-from'>
                              Is it possible to connect to a local Python server using secure web sockets from a browser console on an HTTPS webpage?
                              <span class=link-domain>
                                    stackoverflow.com
                              </span>
                        </a><br>
                        <div class=br></div>
                        so i thought i'd write a blog post about it anyway
                        <br>
                        <div class=br></div>
                        Discover how to overcome the content-security-policy for a website.
                  </p>
            </div>
            
            
            <h3 class=blog-hdr style='margin-bottom:0'>
                  Browser Extensions Manifest v2
            </h3>
            
            <section class=blog-text>
                  so right off the bat, manifest v2 is capable of removing the contest-security-policy on a web request
                  <br>
                  firefox still ( currently, at the time of writing ) supports manifest v2, it has the bindings for manifest v3 but
                  they are just stubs that do nothing
                  <br>
                  <div class=br></div>
                  chromium and hence google chrome, edge, brave, opera and any of the myriad of browsers that are based on chromium do
                  not support manifest v2
                  <br>
                  <div class=br></div>
                  google's official stance on manifest v3 changes
                  <br>
                  <div class=br></div>
                  "To prevent extensions from weakening site security. Allowing CSP removal would undermine protections against XSS and remote code injection."
                  <br>
                  <div class=br></div>
                  <a href='https://developer.chrome.com/docs/extensions/migrating/improve-security/'>
                        Improve extension security
                        <span class=link-domain>
                              developer.chrome.com
                        </span>
                  </a>
                  <div class=br></div>
                  for those who wish to develop using the old manifest v2, previous versions of chromium can be downloaded from
                  <br>
                  <a href='https://www.chromium.org/getting-involved/download-chromium/#downloading-old-builds-of-chrome-chromium'>
                        Downloading old builds of Chrome / Chromium
                        <span class=link-domain>
                              chromium.org
                        </span>
                  </a>
                  <div class=br></div>
                  manifest V3 is supported generally in Chrome 88 ( January 19th, 2021 ) or later.
                  <br>
            </section>
            
            
            <section class=blog-text>
                  <h3 class=blog-hdr>
                        Firefox Manifest V2 Extension Remove CSP
                        <div class=spc></div>
                        <input value='download firefox extension' type=button>
                  </h3>
                  <p>
                        to load an unpacked extension goto
                        <code>
about:debugging#/runtime/this-firefox
                        </code>
                  </p>
                  <img src='ext/firefox/cubes.png'>
                  
                  <snippet-editor id=firefox-manifest src='ext/firefox/manifest.json' mode=json fullsize component></snippet-editor>
                  
                  <snippet-editor id=firefox-extension src='ext/firefox/extension.js' mode=js fullsize component></snippet-editor>
            </section>
            
            
            <section class=blog-text>
                  <h3 class=bog-hdr>
                        Google Chrome Manifest V3 Extension Remove CSP ( doesn't work )
                        <div class=spc></div>
                        <input value='download chrome extension' type=button>
                  </h3>
                  
                  <img src='ext/chrome/cubes.png'>
                  
                  <snippet-editor id=chrome-manifest src='ext/chrome/manifest.json' mode=json fullsize component></snippet-editor>
                  
                  <snippet-editor id=chrome-extension src='ext/chrome/extension.js' mode=js fullsize component></snippet-editor>
            </section>
            
            
            <section class=blog-text>
                  <h3>
                        How to Tell if it Worked?  Were the Headers Actually Removed.
                        <div class=spc></div>
                        <input value='download websocket server' type=button>
                  </h3>
                  <p>
                        Well the test in question was on a webpage protected with a content-security-policy, create a websocket
                        to a local server ( or other )
                        <br>
                        <div class=br></div>
                        So i thought this would make for some interesting code
                        <br>
                        <div class=br></div>
                        Its worth noting here that when a server uses a certificate not in the trsuted root store, self-signed or otherwise,
                        it requires top-level navigation to get the browser to accept that certificate, any other form of navigation will
                        fail silently
                        <br>
                        Its also worth noting that often when extensions modify the headers, dev tools reports the original headers, if you
                        look at the test-server, it provides a simepl webpage that 1. allows top level navigation to accept the self-signed
                        ( unrecognised ) certificate, 2. it also displays the page headers as received after the extension has modified them.
                        <div class=br></div>
                        Here is a minimal websocket server, supports text only, upto 125 bytes
                  </p>
                  
                  <snippet-editor id=ws-server src='ws/websocket-server.js' mode=js fullsize component></snippet-editor>
                  
                  <p>
                        And the code to connect onto it
                  </p>
                  
                  <snippet-editor id=ws-client src='ws/websocket-client.js' mode=js fullsize component></snippet-editor>
            </section>
            
            
            <section class=blog-text>
                  <h3>
                        bypassing content-security policy with a mitm proxy
                        <div class=spc></div>
                        <input value='download mitm proxy' type=button>
                  </h3>
                  <p>
                        so, we can bypass the content-security-protocol header with a mitm proxy and remove the header before sending it to the
                        browser<br>
                        <div class=br></div>
                        for chrome, i believe chrome can be started with flags
                        <code>
chrome --proxy-server="http://127.0.0.1:8080"
                        </code>
                        <div class=br></div>
                        for firefox, you set a proxy by going to Settings → General → Network Settings → Settings…, then choosing Manual proxy configuration and entering your proxy details
                        <div class=br></div>
                        this mitm proxy requires a x.509 key and certificate, they can be generated
                        <br>
                        <a href='utils/x509/generate-https-certificate/generate-https-certificate.html'>
                              Generate HTTPS Certificate
                              <span class=link-domain>
                                    ext-code.com
                              </span>
                        </a>
                        <br>
                  </p>
                  
                  <snippet-editor id=proxy src='proxy/mitm-proxy.js' mode=js fullsize component></snippet-editor>
            </section>
            
            
            <section class=blog-text>
                  <h3>
                        test-server.js, checking the input / output of the mitm proxy
                        <div class=spc></div>
                        <input value='download test-server' type=button>
                  </h3>
                  <p>
                        by connecting onto the server below we can check the actual input and output of the mitm proxy, should you wish to adapt
                        the code, its always good to be able to check exactly what is happening
                  </p>
                  
                  <snippet-editor id=test src='server/test-server.js' mode=js fullsize component></snippet-editor>
            </section>
            
            
            <section class=blog-text>
                  <h3>
                        Running Code in the Webpage
                        <div class=spc></div>
                        <input value="download js extension" type=button>
                  </h3>
                  <p>
                        The original question identified that they opened dev tools and then pasted in the websocket client code, to be able to run the code<br>
                        <div class=br></div>
                        so i thought i'd create a little extension that allows code to be easily run in a webpage<br>
                  </p>
                  
                  <img src='ext-js/js.png'>
                  
                  <snippet-editor id=ext-js-manifest src='ext-js/manifest.json' mode=json fullsize component></snippet-editor>
                  
                  <snippet-editor id=ext-js-extension src='ext-js/extension.js' mode=js fullsize component></snippet-editor>
                  
                  <snippet-editor id=ext-js-cs src='ext-js/content-script.js' mode=js fullsize component></snippet-editor>
                  
                  <snippet-editor id=ext-js-popup-html src='ext-js/popup/popup.html' mode=html fullsize component></snippet-editor>
                  
                  <snippet-editor id=ext-js-popup-js src='ext-js/popup/popup.js' mode=js fullsize component></snippet-editor>
            </section>
            
            
            
            <log-mod component></log-mod>
            
      </body>
      
      
      <script>
      
      
        var jszip;
        
        
        var btn         = {};
        btn.download    = {};
        
        
        function initdom(){
        
              hdr.initdom();
              log.initdom();
              
              
              ex['firefox-manifest'].initdom();
              ex['firefox-extension'].initdom();
              ex['chrome-manifest'].initdom();
              ex['chrome-extension'].initdom();
              ex['ws-server'].initdom();
              ex['ws-client'].initdom();
              ex['proxy'].initdom();
              ex['test'].initdom();
              ex['ext-js-manifest'].initdom();
              ex['ext-js-extension'].initdom();
              ex['ext-js-cs'].initdom();
              ex['ext-js-popup-html'].initdom();
              ex['ext-js-popup-js'].initdom();
              
              
              $('[value="download firefox extension"]').onclick     = btn.download['firefox-extension'];
              $('[value="download chrome extension"]').onclick      = btn.download['chrome-extension'];
              $('[value="download websocket server"]').onclick      = btn.download['websocket-server'];
              $('[value="download mitm proxy"]').onclick            = btn.download['mitm-proxy'];
              $('[value="download test-server"]').onclick           = btn.download['test-server'];
              $('[value="download js extension"]').onclick          = btn.download['js-extension'];
              
              
              
        }//initdom
        
        
  //:
  
  
        btn.download['firefox-extension']   = function(){
        
              download.zip('firefox','ext/firefox/manifest.json','ext/firefox/extension.js','ext/firefox/cubes.png');
              
        }//firefox-extension
        
        
        btn.download['chrome-extension']    = function(){
        
              download.zip('chrome','ext/chrome/manifest.json','ext/chrome/extension.js','ext/chrome/cubes.png');
              
        }//chrome-extension
        
        
        btn.download['websocket-server']    = function(){
        
            download.file('ws/websocket-server.js');
            
        }//websocket-server
        
        
        btn.download['mitm-proxy']    = function(){
        
            download.file('proxy/mitm-proxy.js');
            
        }//mitm-proxy
        
        
        btn.download['test-server']   = function(){
        
              download.file('server/test-server.js');
              
        }//test-server
        
        
        btn.download['js-extension']    = function(){
        
              download.zip('ext-js','ext-js/manifest.json','ext-js/extension.js','ext-js/content-script.js','ext-js/popup/popup.html','ext-js/popup/popup.js');
              
        }//js-extension
  //:
  
  
        async function load_jszip(){
        
              if(!jszip){
                    var err;
                    try{
                    
                          jszip   = await import('https://cdn.jsdelivr.net/npm/jszip/+esm');
                          
                    }//try
                    catch(err2){
                    
                          err   = err2;
                          
                    }//catcg
                    if(err){
                          var error   = err.toString();
                          log.red(`failed to load zip module : ${error}`);
                          return {error};
                    }
                    
                    jszip       = jszip.default;
              }
              
              return {jszip};
              
        }//load_jszip
        
        
        function download(blob,name){
        
              name        ||= blob.name;
              var url       = window.URL.createObjectURL(blob);
              var a         = document.createElement('a');
              a.download    = name;
              a.href        = url;
              a.click();
              
        }//blob
        
        
        download.file   = async function(path){
        
              var fn              = path.split('/').at(-1);
              var {blob,error}    = await get(path);
              if(error)return;
              download(blob,fn);
              
        }//file
        
        
        download.zip    = async function(root,...files){
        
              if(!jszip){
                    var {error}   = await load_jszip();
                    if(error)return;
              }
              
              var zip       = new jszip();
              zip.folder(root);
              
              var err;
              await Promise.all(
                    files.map(async file=>{
                    
                          var fn              = file.split('/').at(-1);
                          var {blob,error}    = await get(file);
                          if(error){
                          
                                throw error;
                          }
                          zip.file(`${root}/${fn}`,blob);
                          
                    })
              ).catch(err2=>err=err2);
              
              if(err){
                    return;
              }
              
              var blob      = await zip.generateAsync({type:'blob'});
              download(blob,`${root}.zip`);
              
        }//download
        
        
        async function get(url){
        
              var err;
              try{
              
                    var res       = await fetch(url);
                    
              }//try
              catch(err2){
              
                    err   = err2;
                    
              }//catcg
              if(err){
                    var error   = err.toString();
                    log.red(error);
                    return {error};
              }
              if(!res.ok){
                    var txt     = await res.text();
                    var error   = res.status+' '+res.statusText;
                    log.red(error);
                    return {error};
              }
              
              var blob      = await res.blob();
              return {blob};
              
        }//get
        
        
        get.raw   = function(repo,path){
        
              var url       = `https://raw.githubusercontent.com/javascript-2020/${repo}/main/${path}`;
              var result    = get(url);
              return result;
              
        }//raw
        
        
      </script>
      
</html>



