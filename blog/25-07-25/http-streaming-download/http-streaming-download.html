


<html>


      <head>

      
            <title></title>

            <base href='https://javascript-2020.github.io/blob/23-07-25/'>
            
            <link rel=icon type='image/png' href='/blog/image/blog-30.png'>
            
            <link rel=stylesheet href='/blog/css/blog.css'>

            
      </head>
      
      
      <body>


      
            <h3>
                  http streaming download
            </h3>


            <div id=desc>

http streaming download
            
            </div>


            <code>
            
            
        require('http').createServer(request).listen(3000);
        console.log('http://localhost:3000');
        
        
        function request(req,res){
        
              var c   = 0;
              fn();
              
              
              function fn(){
              
                    res.write('hello '+c);
                    c++;
                    if(c<5){
                          setTimeout(fn,500);
                          return;
                    }
                    res.end();
                    
              }//fn
              
        }//request
        
            
            </code>
            
            
            <code>
            
        <script>
        
(async()=>{

        var res       = await fetch('/');
        
        var stream    = new TextDecoderStream();
        var reader    = res.body.pipeThrough(stream).getReader();
                                                                          console.log('response stream aquired');
        while(true){
        
              const {value,done}    = await reader.read();
              if(done)break;
                                                                          console.log('fetch',value);                                                                          
        }//while
        
        console.log('done');
        
})();

            </code>
            
      
      </body>
      
      
</html>




