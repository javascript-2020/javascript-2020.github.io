


<html>


      <head>

      
            <title></title>

            <base href='https://javascript-2020.github.io/blob/26-07-25/'>
            
            <link rel=icon type='image/png' href='/blog/image/blog-30.png'>
            
            <link rel=stylesheet href='/blog/css/blog.css'>

            
      </head>
      
      
      <body>


      
            <h3>
                  very simple proxy
            </h3>


            <div id=desc>

a very simple http proxy
            
            </div>


            <code>
            
//  very-simple-proxy.js

        var https   = require(&#x27;https&#x27;);
        
        https.createServer({key,cert},request).listen(8005);
        console.log(&#x27;listening 8005&#x27;);
        
        function request(req,res){
        
              if(req.url==&#x27;/&#x27;){
                    res.writeHead(200,{&#x27;content-type&#x27;:&#x27;text/html&#x27;});
                    res.end(html);
                    return;
              }
              
              var req2   = https.request(&#x27;https://localhost:8006&#x27;+req.url,{ca:cert,method:req.method},res2=&#x3E;{
                    res2.on(&#x27;data&#x27;,data=&#x3E;res.write(data));
                    res2.on(&#x27;end&#x27;,()=&#x3E;res.end());
              });
              
              req.on(&#x27;data&#x27;,data=&#x3E;req2.write(data));
              req.on(&#x27;end&#x27;,()=&#x3E;req2.end());
              
        }//request
        
        
        https.createServer({key,cert},request2).listen(8006);
        console.log(&#x27;listening 8006&#x27;);
        
        function request2(req,res){
        
              var body    = &#x27;&#x27;;
              req.on(&#x27;data&#x27;,data=&#x3E;body+=data);
              req.on(&#x27;end&#x27;,()=&#x3E;{
              
                    if(req.method==&#x27;POST&#x27;){
                          var json    = JSON.parse(body);
                          console.log(&#x27;post&#x27;,json);
                    }
                    res.end(&#x27;it works!&#x27;);
                    
              });
              
        }//request2

        
        var html    = &#x60;
        
              &#x3C;script type=module&#x3E;
              
                    var body    = JSON.stringify([1,2,3]);
                    var res   = await fetch(&#x27;test&#x27;,{method:&#x27;post&#x27;,body});
                    var txt   = await res.text();
                    document.body.append(txt);
                    
              &#x3C;/script&#x3E;
              
        &#x60;;
        
        
            </code>
            
            
      
      </body>
      
      
</html>




