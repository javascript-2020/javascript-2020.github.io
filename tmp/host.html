<!-- headers
      cross-origin-isolate
-->

<html>
  <body>
  <!--
    <iframe src="iframe.html"></iframe>
  -->
  
  </body>
  <script>
  
        var iframe;
  
        function onload2(){

              var win       = iframe.contentWindow;
              var doc       = iframe.contentDocument;
              
              console.log(win);
              console.log(doc);
              
              var script    = doc.createElement('script');
              script.textContent    = `
              
      window.test   = async function() {
      
        try {
          const { WebContainer } = await import('https://cdn.jsdelivr.net/npm/@webcontainer/api/+esm');
          const wc = await WebContainer.boot();
          console.log('WebContainer booted:', wc);
        } catch (err) {
          console.error('WebContainer failed:', err);
        }
        
      }//test

              `;
              doc.head.append(script);
              win.test();


        }//onload2
        
        window.onload   = ()=>{
        
              iframe    = document.createElement('iframe');
              //iframe.setAttribute('sandbox', 'allow-scripts allow-same-origin');
              iframe.src='iframe.html';


              //iframe.onload   = onload2;
              document.body.append(iframe);
              
              

        }//onload
        
  </script>
</html>

